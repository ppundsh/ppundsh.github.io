<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Flymia 凡事用心之事</title>
  
  <subtitle>科技、藝術、工藝</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ppundsh.github.io/"/>
  <updated>2018-04-15T20:55:29.939Z</updated>
  <id>https://ppundsh.github.io/</id>
  
  <author>
    <name>Flymia</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Windows Subsystem Linux 筆記</title>
    <link href="https://ppundsh.github.io/2018-04-16/Windows-Subsystem-Linux-%E7%AD%86%E8%A8%98/"/>
    <id>https://ppundsh.github.io/2018-04-16/Windows-Subsystem-Linux-筆記/</id>
    <published>2018-04-15T19:02:36.000Z</published>
    <updated>2018-04-15T20:55:29.939Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>先記錄安裝後要裝的<br><a id="more"></a></p><p>WLS 安裝部份參考<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>PowerShell 先以系統管理員執行：<br>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</p><p>##安裝 zsh</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-get update</span><br><span class="line">$ sudo apt-get install zsh</span><br><span class="line">$ <span class="built_in">which</span> zsh</span><br><span class="line">/usr/bin/zsh</span><br><span class="line">$ chsh -s /usr/bin/zsh</span><br></pre></td></tr></table></figure><p>另外，也推薦一併安裝 Oh My Zsh 以及幾個方便的套件 (zsh-completions、zsh-autosuggestions、zsh-syntax-highlighting) 來達到類似 fish shell 的命令列功能。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-completions ~/.oh-my-zsh/custom/plugins/zsh-completions</span><br><span class="line">$ git <span class="built_in">clone</span> git://github.com/zsh-users/zsh-autosuggestions <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions</span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure><p>使用 vim 編輯 .zshrc 以啟用 plugin。同時，也建議更換 zsh 佈景主題，因為某些主題疑似因為 Powerline <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>字體所以會讓 Console Emulator 沒辦法正常顯示游標位置，至於有哪些主題是沒有問題的可以自行嘗試，這邊將以 bira 為例。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ZSH_THEME=<span class="string">"bira"</span></span><br><span class="line">......</span><br><span class="line">plugins=(… zsh-completions zsh-autosuggestions zsh-syntax-highlighting)</span><br></pre></td></tr></table></figure><p>重新開啟 shell 後，此時我們可以透過 lsb_release -a 或是 screenfetch（安裝指令如下，可參考這篇<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>文章）驗明正身，確認這真的是一個 Ubuntu Linux 環境。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:djcj/screenfetch; \</span><br><span class="line">sudo apt-get update; \</span><br><span class="line">sudo apt-get install screenfetch</span><br></pre></td></tr></table></figure><p>WSL 環境下還可以直接執行 Windows 程式，甚至可以透過 pipe 做溝通。例如以下的指令會將 Linux Kernel 的版本資訊複製到 Windows 環境的剪貼簿（即 clip.exe）：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ uname -a | clip.exe</span><br></pre></td></tr></table></figure><p></p><h2 id="Cmder-設定"><a href="#Cmder-設定" class="headerlink" title="Cmder 設定"></a>Cmder 設定</h2><p>字形選用打過 Powerline patch 的字型，<a href="https://github.com/powerline/fonts/tree/master/Meslo%20Slashed" target="_blank" rel="noopener">Meslo LG M Regular for Powerline</a> 字型或 <a href="https://github.com/tonsky/FiraCode" target="_blank" rel="noopener">Fira Code</a> <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> 都可以</p><p>[Startup] &gt; [Tasks] 頁面，新增一個 kali 的 Task。其中，-cur_console:p 參數是為了讓方向鍵能正常運作。<br>kali.exe -cur_console:p</p><h2 id="設定-distro"><a href="#設定-distro" class="headerlink" title="設定 distro"></a>設定 distro</h2><p>在最新版本的 Windows 10 中，由於 WSL 支援多種 distro，並且這些 distro 是可以同時執行的，所以也多提供了一個工具 wslconfig.exe 可以查詢目前可用的 distro 以及設定預設的 distro。以下示範使用 wslconfig.exe /list 指令列出目前系統上所有安裝的 Linux distro。若需要修改預設設定，可以使用 /setdefault 參數。</p><p>為了支援多種 distro，有別於過去的版本只有一個 bash.exe 存在系統中，最新版本的 WSL 又做了一些改變。首先，透過 where 指令（類似 Linux 中的 which）可以看到以下這些執行檔的存放位置。其中，因為目前 Linux distro 是以 Windows App 的型式透過市集發佈的，所以 Ubuntu 與 openSUSE 會各自有一個執行檔存放在 WindowsApps資料夾底下，也是它們各自的進入點。</p><p>而這幾個執行檔又有以下的差別：</p><pre><code>bash.exe: 進入預設 Linux distro 的 bash shellwsl.exe: 進入預設 Linux distro 的 default shellubuntu.exe: 進入 Ubuntu 的 default shellopensuse-42.exe: 進入 openSUSE 的 default shell</code></pre><p>在 Ubuntu 執行的同時，於新的命令列介面執行 opensuse-42.exe 便可同時運行一個 openSUSE 環境。</p><h2 id="Powerline-安裝"><a href="#Powerline-安裝" class="headerlink" title="Powerline 安裝"></a>Powerline 安裝</h2><h3 id="Python-amp-pip"><a href="#Python-amp-pip" class="headerlink" title="Python &amp; pip"></a>Python &amp; pip</h3><p>待</p><p>參考資料：<br>-</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none;padding-left:0"><li id="fn:1"><span style="display:inline-block;vertical-align:top;padding-right:10px">1.</span><span style="display:inline-block;vertical-align:top"><a href="https://medium.com/hungys-blog/windows-subsystem-for-linux-configuration-caf2f47d0dfb" target="_blank" rel="noopener">Windows Subsystem for Linux 環境配置 (最新 1709 版)</a><br>-</span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display:inline-block;vertical-align:top;padding-right:10px">2.</span><span style="display:inline-block;vertical-align:top"><a href="http://note.drx.tw/2016/01/screenfetch-cli.html" target="_blank" rel="noopener">screenfetch - 命令列 (cli) 裡的檢視系統工具</a><br>-</span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display:inline-block;vertical-align:top;padding-right:10px">3.</span><span style="display:inline-block;vertical-align:top"><a href="https://mogeko.github.io/2017/09/16/Fira-Code-%E4%B8%BA%E5%86%99%E7%A8%8B%E5%BA%8F%E8%80%8C%E7%94%9F%E7%9A%84%E5%AD%97%E4%BD%93/" target="_blank" rel="noopener">Fira Code | 為寫程序而生的字體</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div><p></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;先記錄安裝後要裝的&lt;br&gt;
    
    </summary>
    
    
      <category term="CMD" scheme="https://ppundsh.github.io/tags/CMD/"/>
    
      <category term="Kali" scheme="https://ppundsh.github.io/tags/Kali/"/>
    
  </entry>
  
  <entry>
    <title>VPN 記錄</title>
    <link href="https://ppundsh.github.io/2018-04-15/VPN%20%E8%A8%98%E9%8C%84/"/>
    <id>https://ppundsh.github.io/2018-04-15/VPN 記錄/</id>
    <published>2018-04-15T10:52:53.000Z</published>
    <updated>2018-04-15T22:49:48.928Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>預定要寫<br><a id="more"></a><br>CentOS 6 安裝 v2ray</p><p>查看時間<br>date -R</p><p>更改時區<br>cp /usr/share/zoneinfo/Asia/Taipei /etc/localtime</p><p>查看 CentOS 版本<br>cat /etc/redhat-release</p><p>查看源<br>cat /etc/apt/sources.list</p><h3 id="CentOS-7-安裝"><a href="#CentOS-7-安裝" class="headerlink" title="CentOS 7 安裝"></a>CentOS 7 安裝</h3><p>一行結束<br>bash &lt;(curl -L -s <a href="https://install.direct/go.sh" target="_blank" rel="noopener">https://install.direct/go.sh</a>)</p><p>此脚本会自动安装以下文件：</p><pre><code>/usr/bin/v2ray/v2ray：V2Ray 程序；/usr/bin/v2ray/v2ctl：V2Ray 工具；/etc/v2ray/config.json：配置文件；/usr/bin/v2ray/geoip.dat：IP 数据文件/usr/bin/v2ray/geosite.dat：域名数据文件</code></pre><p>此脚本会配置自动运行脚本。自动运行脚本会在系统重启之后，自动运行 V2Ray。目前自动运行脚本只支持带有 Systemd 的系统，以及 Debian / Ubuntu 全系列。</p><p>运行脚本位于系统的以下位置：</p><pre><code>/etc/systemd/system/v2ray.service: Systemd/etc/init.d/v2ray: SysV</code></pre><p>脚本运行完成后，你需要：</p><p>编辑 /etc/v2ray/config.json 文件来配置你需要的代理方式；<br>运行 service v2ray start 来启动 V2Ray 进程；<br>之后可以使用 service v2ray start|stop|status|reload|restart|force-reload 控制 V2Ray 的运行。</p><p>將 Clinet 端貼上預設設定即可：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    "port": 1080,  // SOCKS 代理端口，在浏览器中需配置代理并指向这个端口</span><br><span class="line">    "listen": "127.0.0.1",</span><br><span class="line">    "protocol": "socks",</span><br><span class="line">    "domainOverride": ["tls","http"], // “識別相應協定的流量，並根據流量內容重置所請求的目標”，簡單說這東西就是從網路流量中識別出域名。手機用戶無法使用 chinasites 時使用。</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "auth": "noauth",  //socks的認證設置，noauth 代表不認證，由於 socks 通常在客戶端使用，所以這裡不認證</span><br><span class="line">      "udp": true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "vmess",</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "vnext": [&#123;</span><br><span class="line">        "address": "我是SERVER IP", // 服务器地址，请修改为你自己的服务器 ip 或域名</span><br><span class="line">        "port": 我是端口,  // 服务器端口</span><br><span class="line">        "users": [</span><br><span class="line">          &#123;</span><br><span class="line">            "id": "我是UUID", // 用戶 ID，必須與伺服器端配置相同</span><br><span class="line">            "alterID": 64 // 此處的值也應當與伺服器相同，認證用值越大會使用 V2Ray 佔用更多的記憶體。對於一般用戶來說，alterId 的值設為 30 到 100 之間應該是比較合適的。</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outboundDetour": [&#123;</span><br><span class="line">    "protocol": "freedom",</span><br><span class="line">    "tag": "direct", //如果要使用路由，這個 tag 是一定要有的，在這裡 direct 就是 freedom 的一個標號，在路由中說 direct V2Ray 就知道是這裡的 freedom 了</span><br><span class="line">    "settings": &#123;&#125;</span><br><span class="line">  &#125;],</span><br><span class="line">  "routing": &#123;</span><br><span class="line">    "strategy": "rules",</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "domainStrategy": "IPOnDemand",</span><br><span class="line">      "rules": [&#123;</span><br><span class="line">        "type": "field",</span><br><span class="line">        "ip": [</span><br><span class="line">          "0.0.0.0/8",</span><br><span class="line">          "10.0.0.0/8",</span><br><span class="line">          "100.64.0.0/10",</span><br><span class="line">          "127.0.0.0/8",</span><br><span class="line">          "169.254.0.0/16",</span><br><span class="line">          "172.16.0.0/12",</span><br><span class="line">          "192.0.0.0/24",</span><br><span class="line">          "192.0.2.0/24",</span><br><span class="line">          "192.168.0.0/16",</span><br><span class="line">          "198.18.0.0/15",</span><br><span class="line">          "198.51.100.0/24",</span><br><span class="line">          "203.0.113.0/24",</span><br><span class="line">          "::1/128",</span><br><span class="line">          "fc00::/7",</span><br><span class="line">          <span class="string">"fe80::/10"</span></span><br><span class="line">        ],</span><br><span class="line">        "outboundTag": "direct"</span><br><span class="line">      &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>UUID<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup> 生成指令<br>cat /proc/sys/kernel/random/uuid</p><h4 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h4><p>作者<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup><br>JSON 所有標點符號都要用半角符號（英文符號）<br>所有字串都要加雙引號 “ “，鍵是字串，所以鍵也要加雙引號，數字不用加雙引號<br>布爾類型也不用加雙引號，布爾值只有兩個就是 true 和 false，意思就是真和假<br>對象沒有順序，即大括弧 {} 括起來的內容順序是怎麼樣都沒關係</p><h4 id="中國地區不翻牆"><a href="#中國地區不翻牆" class="headerlink" title="中國地區不翻牆"></a>中國地區不翻牆</h4><p>Client 端的 Route 改為<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">"routing": &#123;</span><br><span class="line">  "strategy": "rules",  //固定格式</span><br><span class="line">  "settings": &#123;</span><br><span class="line">    "domainStrategy": "IPIfNonMatch",</span><br><span class="line">    "rules": [</span><br><span class="line">      &#123;</span><br><span class="line">        "type": "chinasites",  //中國的網站域名</span><br><span class="line">        "outboundTag": "direct"</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        "type": "chinaip",  //中國的IP</span><br><span class="line">        "outboundTag": "direct"</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="廣告過濾"><a href="#廣告過濾" class="headerlink" title="廣告過濾"></a>廣告過濾</h4><p>Client 端<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">"routing": &#123;</span><br><span class="line">   "strategy": "rules",</span><br><span class="line">   "settings": &#123;</span><br><span class="line">     "domainStrategy": "IPIfNonMatch",</span><br><span class="line">     "rules": [</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="attr">"domain"</span>: [</span><br><span class="line">           <span class="string">"tanx.com"</span>,</span><br><span class="line">           <span class="string">"googeadsserving.cn"</span>,</span><br><span class="line">           <span class="string">"baidu.com"</span></span><br><span class="line">         ],</span><br><span class="line">         <span class="attr">"type"</span>: <span class="string">"field"</span>,</span><br><span class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"adblock"</span>       </span><br><span class="line">       &#125;,</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="attr">"domain"</span>: [</span><br><span class="line">           <span class="string">"amazon.com"</span>,</span><br><span class="line">           <span class="string">"microsoft.com"</span>,</span><br><span class="line">           <span class="string">"jd.com"</span>,</span><br><span class="line">           <span class="string">"youku.com"</span>,</span><br><span class="line">           <span class="string">"baidu.com"</span></span><br><span class="line">         ],</span><br><span class="line">         <span class="attr">"type"</span>: <span class="string">"field"</span>,</span><br><span class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></span><br><span class="line">       &#125;,</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="attr">"type"</span>: <span class="string">"chinasites"</span>,</span><br><span class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></span><br><span class="line">       &#125;,</span><br><span class="line">       &#123;</span><br><span class="line">         <span class="attr">"type"</span>: <span class="string">"chinaip"</span>,</span><br><span class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></span><br><span class="line">       &#125;</span><br><span class="line">     ]</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p></p><p>在第一個規則中，域名包含有 tanx.com 或 baidu.com 的就會被阻止連接。在第二個規則當中，域名中包含有 amazon.com 或 microsoft.com 或 youku.com 或 baidu.com 的會直連。有一個問題大家發現沒有，兩個規則都有 baidu.com ，那麼會執行哪個呢？答案是只會執行第一個，原因是：</p><ol><li>規則是放在 routing.settings.rules 這個陣列當中，陣列的內容是有順序的，也就是說在這裡規則是有順序的，匹配規則時是從上往下匹配</li><li>當路由匹配到一個規則時就會跳出匹配而不會對之後的規則進行匹配</li></ol><h4 id="inbound-outbound-和-inboundDetour-outboundDetour-的區別"><a href="#inbound-outbound-和-inboundDetour-outboundDetour-的區別" class="headerlink" title="inbound / outbound 和 inboundDetour / outboundDetour 的區別"></a>inbound / outbound 和 inboundDetour / outboundDetour 的區別</h4><p>inbound 和 inboundDetour 的格式形如：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">"inbound": &#123;</span><br><span class="line">  "port": 1080,</span><br><span class="line">  "listen": "127.0.0.1",</span><br><span class="line">  "protocol": "協定名稱",</span><br><span class="line">  "settings": &#123;&#125;,</span><br><span class="line">  "streamSettings": &#123;&#125;,</span><br><span class="line">  "allowPassive": false,</span><br><span class="line">  "tag": "標識"</span><br><span class="line">&#125;,</span><br><span class="line">"inboundDetour": [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">2080</span>,</span><br><span class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"allowPassive"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</span><br><span class="line">    <span class="attr">"allocate"</span>: &#123;</span><br><span class="line">      <span class="attr">"strategy"</span>: <span class="string">"always"</span>,</span><br><span class="line">      <span class="attr">"refresh"</span>: <span class="number">5</span>,</span><br><span class="line">      <span class="attr">"concurrency"</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">3080</span>,</span><br><span class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"allowPassive"</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</span><br><span class="line">    <span class="attr">"allocate"</span>: &#123;</span><br><span class="line">      <span class="attr">"strategy"</span>: <span class="string">"always"</span>,</span><br><span class="line">      <span class="attr">"refresh"</span>: <span class="number">5</span>,</span><br><span class="line">      <span class="attr">"concurrency"</span>: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p></p><p>可以很明顯地看出來，inbound 和 inboundDetour 基本是一樣的，只不過 inboundDetour 是 inbound 的集合。還有一點不同的是 inboundDetour 多了一個 allocate 參數，這是只有在動態端口才會用到的參數，如果不配置動態端口 inboundDetour 和 inbound 無異。</p><p>即有兩點不同：</p><p>配置中 inbound 只能並且必須設置一個傳入的配置，而 inboundDetour 可以設置任意多個傳入配置<br>inboundDetour 的傳入配置多了一個給動態端口用的 allocate 參數<br>接著是傳出，outbound 和 outboundDetour 格式形如:<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">"outbound": &#123;</span><br><span class="line">  "sendThrough": "0.0.0.0",</span><br><span class="line">  "protocol": "協定名稱",</span><br><span class="line">  "settings": &#123;&#125;,</span><br><span class="line">  "tag": "標識",</span><br><span class="line">  "streamSettings": &#123;&#125;,</span><br><span class="line">  "proxySettings": &#123;</span><br><span class="line">    "tag": "another-outbound-tag"</span><br><span class="line">  &#125;  </span><br><span class="line">&#125;,</span><br><span class="line">"outboundDetour": [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"sendThrough"</span>: <span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"proxySettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"another-outbound-tag"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">"sendThrough"</span>: <span class="string">"0.0.0.0"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">"proxySettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"another-outbound-tag"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p></p><p>單純從配置格式來看，outbound 和 outboundDetour 沒有任何區別。但是實際上 outbound 和 outboundDetour 也有兩點不同：</p><p>配置中 outbound 只能並且必須設置一個傳出的配置，而 outboundDetour 可以設置任意多個傳出配置（實際上不可能任意多）<br>當沒有配置路由規則或者路由沒有匹配的情況下，默認由 outbound 將資料包發出去。<br>在上面給出的傳入和傳出配置格式當中，有一些參數不曾提到過，主要是因為一般情況下使用 V2Ray 默認設置即可</p><h3 id="V2Ray-高級設置"><a href="#V2Ray-高級設置" class="headerlink" title="V2Ray 高級設置"></a>V2Ray 高級設置</h3><p>V2Ray 的相比其他工具有一大優點是可以自行選擇傳輸層<sup id="fnref:6"><a href="#fn:6" rel="footnote">6</a></sup>的形式，也就是說 V2Ray 伺服器和客戶端之間的傳輸的流量格式我們是可以選擇的。如我們可以選擇偽裝成 HTTP(TCP) 流量，如果使用了 mKCP 也可以偽裝成 BT 下載、視頻通話、微信視頻通話。也可以選擇使用 WebSokcs 或者 TLS。以上這個都是傳輸層的配置決定的。</p><p>V2Ray 中傳輸層配置在 transport 裡設定，也可以在各個 inbound/outbound 中的 streamSettings 設定。這兩者的區別是 inbound/outbound 的 streamSettings 只對當前的 inbound/outbound 有效 (分連接配置)，不影響其他的 inbound/outbound 的傳輸層配置，而 transport 是全局的，對整個配置所有的 inbound 和 outbound 都有效 (全局配置)，如果一個 inbound/outbound 中設定了 streamSettings，transport 的設定不會影響這個 inbound/outbound。</p><p>在本篇當中，大部分內容都涉及到了傳輸層，關於這部分內容使用的是 inbound/outbound 的 streamSettings(分連接配置)，同時也建議大家使用分連接配置。因為如果你在全局配置中開啟了偽裝功能，會導致瀏覽器或者其他軟件無法與 V2Ray 通信！這不是 bug，只是因為你設置不當。</p><h4 id="Mux-多路復用-multiplexing"><a href="#Mux-多路復用-multiplexing" class="headerlink" title="Mux 多路復用 (multiplexing)"></a>Mux 多路復用 (multiplexing)</h4><p>將多個 TCP 連線合併為一條，可節省資源，提高並發能力。</p><p>Mux 只需在客戶端開啟，伺服器會自動識別，所以只給客戶端的配置。只要在 outbound 或 outboundDetour 加入 “mux”: {“enabled”: true} 即可：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    "port": 1080, // 監聽端口</span><br><span class="line">    "protocol": "socks", // 入口協定為 SOCKS 5</span><br><span class="line">    "domainOverride": ["tls","http"],</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "auth": "noauth"  // 不認證</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "vmess", // 出口協定</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "vnext": [</span><br><span class="line">        &#123;</span><br><span class="line">          "address": "serveraddr.com", // 伺服器位址，請修改為你自己的伺服器 ip 或域名</span><br><span class="line">          "port": 16823,  // 伺服器端口</span><br><span class="line">          "users": [</span><br><span class="line">            &#123;</span><br><span class="line">              "id": "b831381d-6324-4d53-ad4f-8cda48b30811",  // 用戶 ID，必須與伺服器端配置相同</span><br><span class="line">              "alterId": 64 // 此處的值也應當與伺服器相同</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "mux": &#123;"enabled": true&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="mKCP"><a href="#mKCP" class="headerlink" title="mKCP"></a>mKCP</h4><p>V2Ray 引入了 KCP 傳輸協定，稱為 mKCP，相對於常規的 TCP 來說，mKCP 在某些網路環境下具有更大的優勢，但是 mKCP 有一個很明顯的缺點就是會比 TCP 耗費更多的流量，所以請酌情使用。要瞭解的一點是，mKCP 與 KCPTUN 同樣是 KCP 協定，但兩者並不相容。</p><p>1.1. 配置<br>mKCP 的配置比較簡單，只需在伺服器的 inbound 和 客戶端的 outbound 添加一個 streamSettings 並設置成 mkcp 即可。</p><p>1.1.1. 伺服器配置<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">16823</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"clients"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      "network": "mkcp", //此處的 mkcp 也可寫成 kcp，兩種寫法是起同樣的效果</span><br><span class="line">      "kcpSettings": &#123; //包含一些關於 mKCP 設置的參數</span><br><span class="line">        "mtu": 1350,</span><br><span class="line">        "tti": 20,</span><br><span class="line">        "uplinkCapacity": 5, //上行鏈路容量，將決定 V2Ray 向外發送資料包的速率。單位為 MB</span><br><span class="line">        "downlinkCapacity": 100,  //下行鏈路容量，將決定 V2Ray 接收資料包的速率。單位同樣是 MB</span><br><span class="line">        "congestion": false,</span><br><span class="line">        "readBufferSize": 1,</span><br><span class="line">        "writeBufferSize": 1,</span><br><span class="line">        "header": &#123; //對於資料包的偽裝</span><br><span class="line">          "type": "none" //要偽裝成的資料包類型， 可以設置成 utp、srtp、wechat-video 或者 none，這四個可以分別將 mKCP 資料偽裝成 BT 下載、視頻通話、微信視頻通話以及不進行偽裝。這裡的 type 參數，客戶端與伺服器要一致</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "freedom",</span><br><span class="line">    "settings": &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.2. 客戶端配置<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"serveraddr.com"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">16823</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"network"</span>: <span class="string">"mkcp"</span>,</span><br><span class="line">      <span class="attr">"kcpSettings"</span>: &#123;</span><br><span class="line">        <span class="attr">"mtu"</span>: <span class="number">1350</span>,</span><br><span class="line">        <span class="attr">"tti"</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">"uplinkCapacity"</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">"downlinkCapacity"</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">"congestion"</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">"readBufferSize"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"writeBufferSize"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"header"</span>: &#123;</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"none"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.3. 說明<br>在上面的配置當中，與之前相比主要的變化在於多了一個 streamSettings</p><p>客戶端的上行對於伺服器來說是下行，同樣地客戶端的下行是伺服器的上行，mKCP 設置當中伺服器和客戶端都有 uplinkCapacity 和 downlinkCapacity，所以客戶端的上傳速率由伺服器的 downlinkCapacity 和客戶端的 uplinkCapacity 中的最小值決定，客戶端的下載速率也是同樣的道理。因此，建議將伺服器和客戶端的 downlinkCapacity 設成一個很大的值，然後分別修改兩端的 uplinkCapacity 以調整上下行速率。</p><p>還有一個 header 參數可以對 mKCP 進行偽裝，這是 mKCP 的一個優勢。具體的偽裝在 type 參數設置，type 可以設置成 utp、srtp、wechat-video 或者 none，這四個可以分別將 mKCP 資料偽裝成 BT 下載、視頻通話、微信視頻通話以及不進行偽裝。這裡的 type 參數，客戶端與伺服器要一致</p><p>至於上述配置裡有但是我沒有說明的參數，是 V2Ray 的默認值，我個人建議是保持默認。如果你需要瞭解或者修改，請參考手冊。</p><h3 id="動態端口"><a href="#動態端口" class="headerlink" title="動態端口"></a>動態端口</h3><p>V2Ray 提供了一個叫動態端口的功能。顧名思義，就是可以動態變化端口，對於對抗封鎖或許有效</p><p>伺服器 inbound 的端口作為主端口，在 inboundDetour 開動態監聽的端口，客戶端不用額外設定。</p><p>1.1.1. 伺服器配置<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>:&#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">37192</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"clients"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"d17a1af7-efa5-42ca-b7e9-6a35282d737f"</span>,</span><br><span class="line">          <span class="attr">"level"</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"detour"</span>: &#123;        </span><br><span class="line">        <span class="attr">"to"</span>: <span class="string">"dynamicPort"</span>   </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"inboundDetour"</span>:[</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">      "port": "10000-20000", // 端口範圍</span><br><span class="line">      "tag": "dynamicPort",       </span><br><span class="line">      "settings": &#123;</span><br><span class="line">        "default": &#123;</span><br><span class="line">          "level": 1,</span><br><span class="line">          "alterId": 32</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      "allocate": &#123;            // 分配模式</span><br><span class="line">        "strategy": "random",  // 隨機開啟</span><br><span class="line">        "concurrency": 2,      // 同時開放兩個端口</span><br><span class="line">        "refresh": 3           // 每三分鐘刷新一次</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="動態端口使用-mKCP"><a href="#動態端口使用-mKCP" class="headerlink" title="動態端口使用 mKCP"></a>動態端口使用 mKCP</h4><p>同 mKCP 章節，在 inbound 和 inboundDetour 加入 streamSettings 並將 network 設置為 kcp 即可。<br>伺服器配置<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">37192</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"clients"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"d17a1af7-efa5-42ca-b7e9-6a35282d737f"</span>,</span><br><span class="line">          <span class="attr">"level"</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"detour"</span>: &#123;        </span><br><span class="line">        <span class="attr">"to"</span>: <span class="string">"dynamicPort"</span>   </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"network"</span>: <span class="string">"kcp"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"inboundDetour"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">      "port": "10000-20000", // 端口範圍</span><br><span class="line">      "tag": "dynamicPort",       </span><br><span class="line">      "settings": &#123;</span><br><span class="line">        "default": &#123;</span><br><span class="line">          "level": 1,</span><br><span class="line">          "alterId": 32</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      "allocate": &#123;            // 分配模式</span><br><span class="line">        "strategy": "random",  // 隨機開啟</span><br><span class="line">        "concurrency": 2,      // 同時開放兩個端口</span><br><span class="line">        "refresh": 3           // 每三分鐘刷新一次</span><br><span class="line">      &#125;,</span><br><span class="line">      "streamSettings": &#123;</span><br><span class="line">        "network": "kcp"</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="傳出代理"><a href="#傳出代理" class="headerlink" title="傳出代理"></a>傳出代理</h3><p>V2Ray 提供了傳出代理功能，利用它可以實現中轉（在沒有中轉伺服器操作權限的情況下）。</p><p>1.1. 基本傳出代理<br>使用傳出代理可以實現由一個 Shadowsocks 伺服器或者 V2Ray(VMess) 伺服器來中轉你的網路流量，中轉伺服器只能看到你加密的資料而不知道原始的資料是什麼。</p><p>以下面的配置說明，它的工作原理是：</p><ol><li>你在 Twitter 發了個帖子 f**k GFW，由 V2Ray 代理</li><li>V2Ray 客戶端收到瀏覽器發出的 f**k GFW 的帖子後，首先由對其進行加密 (VMess，id: b12614c5-5ca4-4eba-a215-c61d642116ce, 目的伺服器: 1.1.1.1:8888)</li><li>加密後資料包將被轉到 transit 這個 outbound 中，在這裡資料包又會加密一次 (Shadowsocks, password: password, 伺服器: 2.2.2.2:1024)</li><li>兩次加密後的資料包被發送到了 Shadowsocks 伺服器，該伺服器收到後解包後得到仍是加密的資料包（步驟 2 中加密後的資料包），然後將資料包發到 VMess 伺服器。即便這個 Shadowsocks 伺服器的主人是個偷窺狂魔，他也沒辦法看到你的原始資料。</li><li>VMess 伺服器收到 Shadowsocks 伺服器發來的資料包，解密得到原始的資料包，然後把你這個帖子發到 Twitter 的網站中。</li></ol><p>只要第 5 步中的伺服器是自己掌控的就不用擔心別人看到你的上網的內容。</p><p>過程說明：<br>1.我是使用者-&gt;2.我是使用者安裝在系統上的 V2Ray 客戶端，加密成 V2Ray 格式→3.V2Ray 客戶端出口再加密成 SS 格式→4.中轉的 SS server 收到後只能解密一次，就再轉送給下一站→5.V2Ray Server 收到，解密後傳出。</p><p>客戶端：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    "settings": &#123; // settings 的根據實際情況修改</span><br><span class="line">      "vnext": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"1.1.1.1"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">8888</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span>,</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b12614c5-5ca4-4eba-a215-c61d642116ce"</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">      "network": "tcp"  // 此處不能是 "kcp"，設成 "kcp" 將無法聯網</span><br><span class="line">    &#125;,</span><br><span class="line">    "proxySettings": &#123;</span><br><span class="line">        "tag": "transit"  // 這裡的 tag 必須跟作為代理 VPS 的 tag 一致，這裡設定的是 "transit"</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outboundDetour": [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"shadowsocks"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;</span><br><span class="line">        <span class="attr">"servers"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"address"</span>: <span class="string">"2.2.2.2"</span>,</span><br><span class="line">            <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</span><br><span class="line">            <span class="attr">"ota"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"password"</span>,</span><br><span class="line">            <span class="attr">"port"</span>: <span class="number">1024</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"transit"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.2. 鏈式傳出代理<br>如果你有多個 Shadowsocks 或 VMess 賬戶，那麼你可以這樣:<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    "settings": &#123; // settings 的根據實際情況修改</span><br><span class="line">      "vnext": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"1.1.1.1"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">8888</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span>,</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b12614c5-5ca4-4eba-a215-c61d642116ce"</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">      "network": "tcp"  </span><br><span class="line">    &#125;,</span><br><span class="line">    "tag": "DOUS",</span><br><span class="line">    "proxySettings": &#123;</span><br><span class="line">        "tag": "DOSG"  </span><br><span class="line">      &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outboundDetour": [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"shadowsocks"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;</span><br><span class="line">        <span class="attr">"servers"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"address"</span>: <span class="string">"2.2.2.2"</span>,</span><br><span class="line">            <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</span><br><span class="line">            <span class="attr">"ota"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"password"</span>,</span><br><span class="line">            <span class="attr">"port"</span>: <span class="number">1024</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"AliHK"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"shadowsocks"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;</span><br><span class="line">        <span class="attr">"servers"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"address"</span>: <span class="string">"3.3.3.3"</span>,</span><br><span class="line">            <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</span><br><span class="line">            <span class="attr">"ota"</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"password"</span>,</span><br><span class="line">            <span class="attr">"port"</span>: <span class="number">3442</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"AliSG"</span>,</span><br><span class="line">      <span class="attr">"proxySettings"</span>: &#123;</span><br><span class="line">          <span class="attr">"tag"</span>: <span class="string">"AliHK"</span>  </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;</span><br><span class="line">        <span class="attr">"vnext"</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">"address"</span>: <span class="string">"4.4.4.4"</span>,</span><br><span class="line">            <span class="attr">"port"</span>: <span class="number">8462</span>,</span><br><span class="line">            <span class="attr">"users"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"alterId"</span>: <span class="number">64</span>,</span><br><span class="line">                <span class="attr">"id"</span>: <span class="string">"b27c24ab-2b5a-433e-902c-33f1168a7902"</span></span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"DOSG"</span>,</span><br><span class="line">      <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">        <span class="attr">"network"</span>: <span class="string">"tcp"</span>  </span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"proxySettings"</span>: &#123;</span><br><span class="line">          <span class="attr">"tag"</span>: <span class="string">"AliSG"</span>  </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>那麼資料包經過的節點依次為： PC -&gt; AliHK -&gt; AliSG -&gt; DOSG -&gt; DOUS -&gt; 目標網站</p><p>這樣的傳出代理形成了一條鏈條，我稱之為鏈式傳出代理。</p><p>注意：如果你打算配置 (動態) 鏈式傳出代理，應當明確幾點：</p><ul><li>性能。鏈式代理使用了多個節點，可能會造成延時、帶寬等網路性能問題，並且客戶端對每一個加解密的次數取決於代理鏈的長度，理論上也會有一定的影響。</li><li>安全。前文提到，傳出代理會一定程度上提高安全性，但安全取決於最弱一環，並不意味著代理鏈越長就會越安全。如果你需要匿名，請考慮成熟的匿名方案。 另外，使用了傳出代理 streamSettings 會失效。</li></ul><h3 id="HTTP-偽裝"><a href="#HTTP-偽裝" class="headerlink" title="HTTP 偽裝"></a>HTTP 偽裝</h3><p>（2018-03-16 註：個人建議不要使用 HTTP 偽裝） V2Ray 自 v2.5 版本開始提供 HTTP 偽裝功能，後經作者不斷完善，到現在已經非常成熟穩定了。V2Ray 的 HTTP 偽裝功能可以可以將 V2Ray 的流量偽裝成正常的 HTTP 協定的。這裡給出一個 HTTP 偽裝的伺服器端與客戶端配置文件示例。</p><p>配置中關於 HTTP 頭欄位的內容及含義，Wikipedia 有簡要的說明，可參閱。</p><p>1.1. 配置<br>從 V2Ray 的實現角度來說，使用 HTTP 偽裝的同時完全可以使用動態端口。但我個人並不建議這麼做，因為從實際情況來看，基本上不會有人在一個伺服器上開使用多個端口的 Web 服務。如果你覺得 HTTP 偽裝的配置過於複雜不懂得如何修改，那請直接使用下面的配置即可。</p><p>1.1.1. 伺服器<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"log"</span> : &#123;</span><br><span class="line">    <span class="attr">"access"</span>: <span class="string">"/var/log/v2ray/access.log"</span>,</span><br><span class="line">    <span class="attr">"error"</span>: <span class="string">"/var/log/v2ray/error.log"</span>,</span><br><span class="line">    <span class="attr">"loglevel"</span>: <span class="string">"warning"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    "port": 80, //推薦80端口，更好地迷惑防火牆（好吧實際上並沒有什麼卵用</span><br><span class="line">    "protocol": "vmess",</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "clients": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">          <span class="attr">"level"</span>: <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">      "network": "tcp",</span><br><span class="line">      "tcpSettings": &#123;</span><br><span class="line">        "header": &#123; // header 這一項是關於資料包偽裝的設置，可自定義合理的內容，但要確保伺服器與客戶端一致</span><br><span class="line">          "type": "http",</span><br><span class="line">          "response": &#123;</span><br><span class="line">            "version": "1.1",</span><br><span class="line">            "status": "200",</span><br><span class="line">            "reason": "OK",</span><br><span class="line">            "headers": &#123;</span><br><span class="line">              "Content-Type": ["application/octet-stream", "application/x-msdownload", "text/html", "application/x-shockwave-flash"],</span><br><span class="line">              "Transfer-Encoding": ["chunked"],</span><br><span class="line">              "Connection": ["keep-alive"],</span><br><span class="line">              "Pragma": "no-cache"</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "freedom",</span><br><span class="line">    "settings": &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outboundDetour": [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"blackhole"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"blocked"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  "routing": &#123;</span><br><span class="line">    "strategy": "rules",</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "rules": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"field"</span>,</span><br><span class="line">          <span class="attr">"ip"</span>: [</span><br><span class="line">            <span class="string">"0.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"10.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"100.64.0.0/10"</span>,</span><br><span class="line">            <span class="string">"127.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"169.254.0.0/16"</span>,</span><br><span class="line">            <span class="string">"172.16.0.0/12"</span>,</span><br><span class="line">            <span class="string">"192.0.0.0/24"</span>,</span><br><span class="line">            <span class="string">"192.0.2.0/24"</span>,</span><br><span class="line">            <span class="string">"192.168.0.0/16"</span>,</span><br><span class="line">            <span class="string">"198.18.0.0/15"</span>,</span><br><span class="line">            <span class="string">"198.51.100.0/24"</span>,</span><br><span class="line">            <span class="string">"203.0.113.0/24"</span>,</span><br><span class="line">            <span class="string">"::1/128"</span>,</span><br><span class="line">            <span class="string">"fc00::/7"</span>,</span><br><span class="line">            <span class="string">"fe80::/10"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"blocked"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.2. 客戶端<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"log"</span>: &#123;</span><br><span class="line">    <span class="attr">"loglevel"</span>: <span class="string">"warning"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"serveraddr.com"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">80</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"network"</span>: <span class="string">"tcp"</span>,</span><br><span class="line">      <span class="attr">"tcpSettings"</span>: &#123;</span><br><span class="line">        "header": &#123;  //這裡的 header 要與伺服器保持一致</span><br><span class="line">          "type": "http",</span><br><span class="line">          "request": &#123;</span><br><span class="line">            "version": "1.1",</span><br><span class="line">            "method": "GET",</span><br><span class="line">            "path": ["/"],</span><br><span class="line">            "headers": &#123;</span><br><span class="line">              "Host": ["www.cloudflare.com", "www.amazon.com"],</span><br><span class="line">              "User-Agent": [</span><br><span class="line">                "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.75 Safari/537.36",</span><br><span class="line">                        <span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 10_0_2 like Mac OS X) AppleWebKit/601.1 (KHTML, like Gecko) CriOS/53.0.2785.109 Mobile/14A456 Safari/601.1.46"</span></span><br><span class="line">              ],</span><br><span class="line">              "Accept-Encoding": ["gzip, deflate"],</span><br><span class="line">              "Connection": ["keep-alive"],</span><br><span class="line">              "Pragma": "no-cache"</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outboundDetour": [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"protocol"</span>: <span class="string">"freedom"</span>,</span><br><span class="line">      <span class="attr">"settings"</span>: &#123;&#125;,</span><br><span class="line">      <span class="attr">"tag"</span>: <span class="string">"direct"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  "routing": &#123;</span><br><span class="line">    "strategy": "rules",</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "domainStrategy": "IPIfNonMatch",</span><br><span class="line">      "rules": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"field"</span>,</span><br><span class="line">          <span class="attr">"ip"</span>: [</span><br><span class="line">            <span class="string">"0.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"10.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"100.64.0.0/10"</span>,</span><br><span class="line">            <span class="string">"127.0.0.0/8"</span>,</span><br><span class="line">            <span class="string">"169.254.0.0/16"</span>,</span><br><span class="line">            <span class="string">"172.16.0.0/12"</span>,</span><br><span class="line">            <span class="string">"192.0.0.0/24"</span>,</span><br><span class="line">            <span class="string">"192.0.2.0/24"</span>,</span><br><span class="line">            <span class="string">"192.168.0.0/16"</span>,</span><br><span class="line">            <span class="string">"198.18.0.0/15"</span>,</span><br><span class="line">            <span class="string">"198.51.100.0/24"</span>,</span><br><span class="line">            <span class="string">"203.0.113.0/24"</span>,</span><br><span class="line">            <span class="string">"::1/128"</span>,</span><br><span class="line">            <span class="string">"fc00::/7"</span>,</span><br><span class="line">            <span class="string">"fe80::/10"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"chinasites"</span>,</span><br><span class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"type"</span>: <span class="string">"chinaip"</span>,</span><br><span class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h3><p>從 v1.19 起引入了 TLS，TLS 中文譯名是傳輸層安全，如果你沒聽說過，請 Google 瞭解一下。以下給出些我認為介紹較好的文章鏈結：</p><p><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" target="_blank" rel="noopener">SSL/TLS 協定運行機制的概述</a><br><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E5%8D%94%E8%AD%B0" target="_blank" rel="noopener">傳輸層安全協定</a></p><h4 id="1-1-註冊一個域名"><a href="#1-1-註冊一個域名" class="headerlink" title="1.1. 註冊一個域名"></a>1.1. 註冊一個域名</h4><p>如果已經註冊有域名了可以跳過。 TLS 需要一個域名，域名有免費的和有付費的，如果你不捨得為一個域名每年花點錢，用個免費域名也可以，但總體來說付費的會優於免費的。為了方便，在本文中我就忽略如何註冊購買域名了。關於如何獲取域名，具體搜索相關文章教程。</p><p>註冊好域名之後務必記得添加一個 A 記錄指向你的 VPS!</p><p>以下假設註冊的域名為 mydomain.me，請將之替換成自己的域名。</p><h4 id="1-2-證書生成"><a href="#1-2-證書生成" class="headerlink" title="1.2. 證書生成"></a>1.2. 證書生成</h4><p>TLS 是證書認證機制，所以使用 TLS 需要證書，證書也有免費付費的，同樣的這裡使用免費證書，證書認證機構為 Let’s Encrypt。 證書的生成有許多方法，這裡使用的是比較簡單的方法：使用 acme.sh 腳本生成，本部分說明部分內容參考於 acme.sh README。</p><p>證書有兩種，一種是 ECC 證書（內置公鑰是 ECDSA 公鑰），一種是 RSA 證書（內置 RSA 公鑰）。簡單來說，同等長度 ECC 比 RSA 更安全, 也就是說在具有同樣安全性的情況下，ECC 的密鑰長度比 RSA 短得多（加密解密會更快）。但問題是 ECC 的相容性會差一些，Android 4.x 以下和 Windows XP 不支援。只要您的設備不是非常老的老古董，強烈建議使用 ECC 證書。</p><p>以下將給出這兩類證書的生成方法，請大家根據自身的情況自行選擇其中一種證書類型。</p><p>證書生成只需在伺服器上操作。</p><h5 id="1-2-1-安裝-acme-sh"><a href="#1-2-1-安裝-acme-sh" class="headerlink" title="1.2.1. 安裝 acme.sh"></a>1.2.1. 安裝 acme.sh</h5><p>執行以下命令，acme.sh 會安裝到 ~/.acme.sh 目錄下。<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ curl  https://get.acme.sh | sh</span><br><span class="line">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                               Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679</span><br><span class="line">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                               Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k</span><br><span class="line">[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.</span><br><span class="line">[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installing <span class="built_in">alias</span> to <span class="string">'/home/user/.profile'</span></span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job</span><br><span class="line">no crontab <span class="keyword">for</span> user</span><br><span class="line">no crontab <span class="keyword">for</span> user</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] OK</span><br><span class="line">[Fri 30 Dec 01:03:33 GMT 2016] Install success!</span><br></pre></td></tr></table></figure><p></p><p>安裝成功後執行 <code>source ~/.bashrc</code> 以確保腳本所設置的命令別名生效。</p><p>如果安裝報錯，那麼可能是因為系統缺少 acme.sh 所需要的依賴項，acme.sh 的依賴項主要是 netcat(nc)，我們通過以下命令來安裝這些依賴項，然後重新安裝一遍 acme.sh:</p><pre><code>sudo apt-get -y install netcat</code></pre><h5 id="1-2-2-使用-acme-sh-生成證書"><a href="#1-2-2-使用-acme-sh-生成證書" class="headerlink" title="1.2.2. 使用 acme.sh 生成證書"></a>1.2.2. 使用 acme.sh 生成證書</h5><p>證書生成<br>執行以下命令生成證書：</p><p>以下的命令會臨時監聽 80 端口，請確保執行該命令前 80 端口沒有使用<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256</span><br><span class="line">[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.</span><br><span class="line">[Fri Dec 30 08:59:12 HKT 2016] Single domain=<span class="string">'mydomain.me'</span></span><br><span class="line">[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token <span class="keyword">for</span> each domain</span><br><span class="line">[Fri Dec 30 08:59:12 HKT 2016] Getting webroot <span class="keyword">for</span> domain=<span class="string">'mydomain.me'</span></span><br><span class="line">[Fri Dec 30 08:59:12 HKT 2016] _w=<span class="string">'no'</span></span><br><span class="line">[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz <span class="keyword">for</span> domain=<span class="string">'mydomain.me'</span></span><br><span class="line">[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.</span><br><span class="line">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.</span><br><span class="line">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</span><br><span class="line">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</span><br><span class="line">[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.</span><br><span class="line">[Fri Dec 30 08:59:16 HKT 2016] Cert success.</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA</span><br><span class="line">MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD</span><br><span class="line">ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x</span><br><span class="line">NzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49</span><br><span class="line">****************************************************************</span><br><span class="line">4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9</span><br><span class="line">+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40</span><br><span class="line">zweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2</span><br><span class="line">VAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9</span><br><span class="line">gPUI45eltrjcv8FCSTOUcT7PWCa3</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">[Fri Dec 30 08:59:16 HKT 2016] Your cert is <span class="keyword">in</span>  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer</span><br><span class="line">[Fri Dec 30 08:59:16 HKT 2016] Your cert key is <span class="keyword">in</span>  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key</span><br><span class="line">[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is <span class="keyword">in</span>  /root/.acme.sh/mydomain.me_ecc/ca.cer</span><br><span class="line">[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer</span><br></pre></td></tr></table></figure><p></p><p><code>-k</code> 表示密鑰長度，後面的值可以是 <code>ec-256 、ec-384、2048、3072、4096、8192</code>，帶有 <code>ec</code> 表示生成的是 ECC 證書，沒有則是 RSA 證書。在安全性上 256 位的 ECC 證書等同於 3072 位的 RSA 證書。</p><h5 id="證書更新"><a href="#證書更新" class="headerlink" title="證書更新"></a>證書更新</h5><p>由於 Let’s Encrypt 的證書有效期只有 3 個月，因此需要 90 天至少要更新一次證書，acme.sh 腳本會每 60 天自動更新證書。也可以手動更新。</p><p>手動更新 ECC 證書，執行：</p><pre><code>sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc</code></pre><p>如果是 RSA 證書則執行：</p><pre><code>sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force</code></pre><p>由於本例中將證書生成到 /etc/v2ray/ 文件夾，更新證書之後還得把新證書生成到 /etc/v2ray。</p><h5 id="1-2-3-安裝證書和密鑰"><a href="#1-2-3-安裝證書和密鑰" class="headerlink" title="1.2.3. 安裝證書和密鑰"></a>1.2.3. 安裝證書和密鑰</h5><p>ECC 證書<br>將證書和密鑰安裝到 /etc/v2ray 中：</p><pre><code>sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc</code></pre><p>RSA 證書</p><pre><code>sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key</code></pre><p>注意：無論什麼情況，密鑰 (即上面的 v2ray.key) 都不能洩漏，如果你不幸洩漏了密鑰，可以使用 acme.sh 將原證書吊銷，再生成新的證書，吊銷方法請自行參考 acme.sh 的手冊</p><h4 id="1-3-配置-V2Ray"><a href="#1-3-配置-V2Ray" class="headerlink" title="1.3. 配置 V2Ray"></a>1.3. 配置 V2Ray</h4><p>1.3.1. 伺服器<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    "port": 443, // 建議使用 443 端口</span><br><span class="line">    "protocol": "vmess",    </span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "clients": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297"</span>,  </span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">      "network": "tcp",</span><br><span class="line">      "security": "tls", // security 要設置為 tls 才會啟用 TLS</span><br><span class="line">      "tlsSettings": &#123;</span><br><span class="line">        "certificates": [</span><br><span class="line">          &#123;</span><br><span class="line">            "certificateFile": "/etc/v2ray/v2ray.crt", // 證書文件</span><br><span class="line">            "keyFile": "/etc/v2ray/v2ray.key" // 密鑰文件</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "freedom",</span><br><span class="line">    "settings": &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.3.2. 客戶端<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          "address": "mydomain.me", // tls 需要域名，所以這裡應該填自己的域名</span><br><span class="line">          "port": 443,</span><br><span class="line">          "users": [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297"</span>,</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">      "network": "tcp",</span><br><span class="line">      "security": "tls" // 客戶端的 security 也要設置為 tls</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="1-4-驗證"><a href="#1-4-驗證" class="headerlink" title="1.4. 驗證"></a>1.4. 驗證</h4><p>一般來說，按照以上步驟操作完成，V2Ray 客戶端能夠正常聯網說明 TLS 已經成功啟用。但要是有個可靠的方法來驗證是否正常開啟 TLS 無疑更令人放心。 驗證的方法有很多，我僅介紹一種小白化一點的，便是 Qualys SSL Labs’s SSL Server Test。</p><p>注意：使用 Qualys SSL Labs’s SSL Server Test 要求使用 443 端口，意味著你伺服器配置的 inbound.port 應當是 443</p><p>打開 Qualys SSL Labs’s SSL Server Test，在 Hostname 中輸入你的域名，點提交，過一會結果就出來了。</p><h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><p>WebSocket 的配置其實很簡單，就跟 mKCP 一樣把 network 一改就行了。話不多說，直接上配置。</p><p>1.1. 配置<br>1.1.1. 伺服器配置<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">16823</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"clients"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"network"</span>:<span class="string">"ws"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"freedom"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.2. 客戶端配置<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"serveraddr.com"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">16823</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>:&#123;</span><br><span class="line">      <span class="attr">"network"</span>:<span class="string">"ws"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="WebSocket-TLS-Web"><a href="#WebSocket-TLS-Web" class="headerlink" title="WebSocket+TLS+Web"></a>WebSocket+TLS+Web</h3><p>前文分別提到過 TLS 和 WebSocket 的配置方法，而本文搭配 Web 服務並同時實現 TLS 和 WebSocket。關於 Web 的軟件本文給出了 Nginx 和 Caddy 兩個例子，二選一即可，也可以選用其他的軟件（如 Apache）。</p><p>很多新手一接觸 V2Ray 就想搞 WebSocket+TLS+Web 或 WebSocket+TLS+Web+CDN，我就想問 ssh 和 vim/nano 用利索了沒，步子這麼大不怕扯到蛋嗎？使用 Nginx/Caddy 是因為 VPS 已經有 Nginx/Caddy 可以將 V2Ray 稍作隱藏，使用 WebSocket 是因為搭配 Nginx/Caddy 只能用 WebSocket，使用 TLS 是因為可以流量加密，看起來更像 HTTPS。 也許 WebSocket+TLS+Web 的配置組合相對較好，但不意味著這樣的配置適合任何人。因為本節涉及 Nginx 和 Caddy，只給出了配置示例而不講具體使用方法，也就是說你在閱讀本節內容前得會使用這兩個軟件的其中之一，如果你還不會，請自行 Google。</p><p>注意: V2Ray 的 Websocket+TLS 配置組合並不依賴 Nginx 或 Caddy，只是能與其搭配使用而已，沒有它們也可以正常使用。</p><p>1.1. 配置<br>這次 TLS 的配置將寫入 Nginx 或者 Caddy 配置中，由這些軟件來監聽 443 端口，然後將其轉發到 V2Ray 的 WebSocket 所監聽的內網端口，V2Ray 伺服器端不需要配置 TLS。</p><p>1.1.1. 伺服器配置<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">10000</span>,</span><br><span class="line">    "listen":"127.0.0.1",//只監聽 127.0.0.1，避免除本機外的機器探測到開放了 10000 端口</span><br><span class="line">    "protocol": "vmess",</span><br><span class="line">    "settings": &#123;</span><br><span class="line">      "clients": [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    "streamSettings": &#123;</span><br><span class="line">      "network": "ws",</span><br><span class="line">      "wsSettings": &#123;</span><br><span class="line">      "path": "/ray"</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "freedom",</span><br><span class="line">    "settings": &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.2. Nginx 配置<br>配置中使用的是域名和證書使用 TLS 小節的舉例，請替換成自己的。<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen  443 ssl;</span><br><span class="line">  ssl on;</span><br><span class="line">  ssl_certificate       /etc/v2ray/v2ray.crt;</span><br><span class="line">  ssl_certificate_key   /etc/v2ray/v2ray.key;</span><br><span class="line">  ssl_protocols         TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">  ssl_ciphers           HIGH:!aNULL:!MD5;</span><br><span class="line">  server_name           mydomain.me;</span><br><span class="line">        location /ray &#123;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        proxy_pass http://127.0.0.1:10000;#假設WebSocket監聽在環回位址的10000端口上</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection "upgrade";</span><br><span class="line">        proxy_set_header Host $http_host;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.3. Caddy 配置<br>因為 Caddy 會自動申請證書並自動更新，所以使用 Caddy 不用指定證書、密鑰。<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mydomain.me</span><br><span class="line">&#123;</span><br><span class="line">  log ./caddy.log</span><br><span class="line">  proxy /ray localhost:10000 &#123;</span><br><span class="line">    websocket</span><br><span class="line">    header_upstream -Origin</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.4. 客戶端配置<br></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span>,</span><br><span class="line">      <span class="attr">"udp"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"mydomain.me"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">443</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"network"</span>: <span class="string">"ws"</span>,</span><br><span class="line">      <span class="attr">"security"</span>: <span class="string">"tls"</span>,</span><br><span class="line">      <span class="attr">"wsSettings"</span>: &#123;</span><br><span class="line">        <span class="attr">"path"</span>: <span class="string">"/ray"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.5. 注意事項</p><ul><li>較低版本的 nginx 的 location 需要寫為 <code>/ray/</code> 才能正常工作</li><li>如果在設置完成之後不能成功使用，可能是由於 SElinux 機制 (如果你是 CentOS 7 的用戶請特別留意 SElinux 這一機制) 阻止了 Nginx 轉發向內網的資料。如果是這樣的話，在 V2Ray 的日誌裡不會有訪問資訊，在 Nginx 的日誌裡會出現大量的 “Permission Denied” 欄位，要解決這一問題需要在終端下鍵入以下命令：<br>setsebool -P httpd_can_network_connect 1</li><li>請保持伺服器和客戶端的 wsSettings 嚴格一致，對於 V2Ray，/ray 和 /ray/ 是不一樣的</li></ul><p>1.1.6. 其他的話</p><ol><li>開啟了 TLS 之後 path 參數是被加密的，GFW 看不到；</li><li>主動探測一個 path 產生 Bad request 不能證明是 V2Ray；</li><li>不安全的因素在於人，自己的問題就不要甩鍋，哪怕我把示例中的 path 改成一個 UUID，依然有不少人原封不動地 COPY；</li><li>使用 Header 分流並不比 path 安全， 不要迷信。</li></ol><h3 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h3><p>簡單地說 HTTP/2 是 HTTP/1.1 的升級版（目前大多數網頁還是 HTTP/1.1），點擊這裡可以直觀地體會到 HTTP/2 相比於 HTTP/1.1 的提升（不代表 V2Ray 中 HTTP/2 相對於 TCP 的提升就是這樣的）。</p><p>在 V2Ray 的手冊中並沒有 HTTP/2 的相關內容，而且 V2Ray 的 HTTP/2 還處於測試階段。</p><p>1.1. 配置<br>最近幾版的 V2Ray 已經開始支援 HTTP/2，可能 v3.12 就支援了，實測 v3.14 能夠使用 HTTP/2 了。與其他的傳輸層協定一樣在 streamSettings 中配置。</p><p>1.1.1. 伺服器配置<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">443</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"clients"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      "network": "h2", // h2 也可寫成 http，效果一樣</span><br><span class="line">      "httpSettings": &#123; //此項是關於 HTTP/2 的設置</span><br><span class="line">        "path": "/ray"</span><br><span class="line">      &#125;,</span><br><span class="line">      "security": "tls", // 配置tls</span><br><span class="line">      "tlsSettings": &#123;</span><br><span class="line">        "certificates": [</span><br><span class="line">          &#123;</span><br><span class="line">            "certificateFile": "/etc/v2ray/v2ray.crt", // 證書文件，詳見 tls 小節</span><br><span class="line">            "keyFile": "/etc/v2ray/v2ray.key" // 密鑰文件</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  "outbound": &#123;</span><br><span class="line">    "protocol": "freedom",</span><br><span class="line">    "settings": &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>1.1.2. 客戶端配置<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"inbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</span><br><span class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span>,</span><br><span class="line">      <span class="attr">"udp"</span>: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"outbound"</span>: &#123;</span><br><span class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</span><br><span class="line">    <span class="attr">"settings"</span>: &#123;</span><br><span class="line">      <span class="attr">"vnext"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"address"</span>: <span class="string">"mydomain.me"</span>,</span><br><span class="line">          <span class="attr">"port"</span>: <span class="number">443</span>,</span><br><span class="line">          <span class="attr">"users"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</span><br><span class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"streamSettings"</span>: &#123;</span><br><span class="line">      <span class="attr">"network"</span>: <span class="string">"h2"</span>,</span><br><span class="line">      "httpSettings": &#123; //此項是關於 HTTP/2 的設置</span><br><span class="line">        "path": "/ray"</span><br><span class="line">      &#125;,</span><br><span class="line">      "security": "tls"</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h3 id="不推薦的配置"><a href="#不推薦的配置" class="headerlink" title="不推薦的配置"></a>不推薦的配置</h3><p>也許有一部分朋友發現了，高級篇的內容關於傳輸層的，各種配置的組合，可以搭配出非常多的配置。但是，有一些組合是我認為不值得或者是冗餘的（僅代表個人意見），以下給出。</p><ul><li><p>TLS+KCP<br>這是相當一部分人喜歡的組合，不推薦的原因是 vmess 本身的加密方式已經足夠，加 TLS 只是多消耗設備算力，尤其是移動設備，TLS 也不在最外層，已經失去大部分人使用 TLS 的初衷。</p></li><li><p>TLS+HTTP 偽裝<br>這並沒有什麼卵用，這樣的組合不是 HTTPS。</p></li><li><p>單純使用 Websocket<br>理論上，使用 Websocket 會比 TCP 性能差一些，所以如果不是搭配 CDN、nginx 或者在 PaaS 上使用，那還是使用 TCP 吧。</p></li></ul><h3 id="透明代理"><a href="#透明代理" class="headerlink" title="透明代理"></a>透明代理</h3><p>透明代理是什麼意思請自行 Google，在這兒指使用 V2Ray 做透明代理實現路由器翻牆。然而，我個人認為路由器翻牆的說法並不準確，應該叫閘道翻牆。所以本例實際上是關於閘道翻牆的內容。當然了，單純使用路由器翻牆也是可以的，因為普通的家用路由器本就是一個閘道。使用閘道翻牆可以使局域網內的所有設備都具有直接翻牆的能力，並且能夠全局代理，而不必每台設備都安裝 V2Ray，配置更新時只需在閘道修改配置，用一些網友的話說就是就感覺沒有牆一樣。但是，有意上透明代理的同學請評估一下透明代理是否合適自己，而不要盲目跟風。</p><p>透明代理適用於以下情況：</p><ul><li>局域網設備較多，比如說辦公室、實驗室、子孫滿堂的家庭等；</li><li>設備 (的軟件) 無法 / 不方便設置代理，比如說 chromecast、電視盒子等；</li><li><p>希望設備的所有軟件都走代理。<br>不適用於：</p></li><li><p>隨便拿個垃圾路由器就想上的</p></li></ul><p>1.1. 優點<br>其實，V2Ray 早就可以作透明代理，當時我也研究了好一段時間，最終是折騰出來了。但是由於 DNS 的問題，我用著總感覺不太舒服。雖然有 ChinaDNS 這類的解決方案，但個人主觀上並不喜歡。 不過嘛，現在就不一樣了。就目前來說，使用 V2Ray 透明代理：</p><ol><li>解決了牆外 DNS 污染問題；</li><li>在解決了 1 的情況下國內域名的即能夠解析到國內 CDN；</li><li>不需要外部軟件或自建 DNS 就可決絕 1 和 2 的問題，只要系統支援 V2Ray 和 iptables；</li><li>能夠完美利用 V2Ray 強大而靈活的路由功能，而不必額外維護一個路由表；</li></ol><p>1.2. 軟硬體準備</p><ul><li>一台已經搭建 V2Ray 並能正常使用的 VPS ，本文假設 IP 為 110.231.43.65；</li><li>一台帶 iptables、有 root 權限並且系統為 Linux 的設備，假設位址為 192.168.1.22，已經配置好 V2Ray 作為客戶端。這個設備可以是路由器、開發板、個人電腦、虛擬機和 Android 設備等，更具普適性地稱之為閘道。我個人非常不建議使用 MT7620 系路由器開透明代理，性能太差了，很多固件也沒有開啟 FPU 。要是真不願意出這點錢，用電腦開個虛擬機吧 (我就是這麼幹的)，VirtualBox、Hyper 之類的都可以，但是別忘了網路模式用網橋。</li></ul><p>1.3. 設置步驟</p><p>設置步驟如下，假設使用 root。</p><ol><li><p>閘道開啟 IP 轉發。在 /etc/sysctl.conf 文件添加一行 net.ipv4.ip_forward=1 ，執行下列命令生效：<br>sysctl -p</p></li><li><p>路由器 DHCP 設定閘道位址為閘道設備的 IP，本例為 192.168.1.22，或者電腦手機等設備單獨設置閘道位址，但閘道設備必須指定閘道位址為路由器的 IP，然後電腦 / 手機測試是不是可以正常上網 (這時還不能翻牆)，如果不能上網先去學習一個把這個搞定，否則接下來再怎麼也同樣上不了網。</p></li><li><p>在伺服器和閘道安裝 V2Ray（如果不會就參照前面的教程，由於 GFW 會惡化 GitHub Releases 的流量，閘道直接運行腳本幾乎無法安裝，建議從 <a href="https://v2ray.com/download" target="_blank" rel="noopener">https://v2ray.com/download</a> 下載然後使用 –local 參數進行安裝），並配置好配置文件。一定要確定搭建的 V2Ray 能夠正常使用。在閘道執行 <code>curl -x socks5://127.0.0.1:1080 google.com</code>測試配置的 V2Ray 是否可以翻牆 (命令中 socks5 指 inbound 為 socks，1080 指該 inbound 端口是 1080)。如果出現類似下面的輸出則可以翻牆，如果沒有出現就說明翻不了，你得仔細檢查以下哪步操作不對或漏了。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">HTML</span>&gt;</span><span class="tag">&lt;<span class="name">HEAD</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">TITLE</span>&gt;</span>301 Moved<span class="tag">&lt;/<span class="name">TITLE</span>&gt;</span><span class="tag">&lt;/<span class="name">HEAD</span>&gt;</span><span class="tag">&lt;<span class="name">BODY</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H1</span>&gt;</span>301 Moved<span class="tag">&lt;/<span class="name">H1</span>&gt;</span></span><br><span class="line">The document has moved</span><br><span class="line"><span class="tag">&lt;<span class="name">A</span> <span class="attr">HREF</span>=<span class="string">"http://www.google.com/"</span>&gt;</span>here<span class="tag">&lt;/<span class="name">A</span>&gt;</span>.</span><br><span class="line"><span class="tag">&lt;/<span class="name">BODY</span>&gt;</span><span class="tag">&lt;/<span class="name">HTML</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ol><p>在閘道的配置，添加 dokodemo ，並開啟 domain override（注意不要寫錯配置）。配置形如：<br></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> "inbound": &#123;...&#125;,</span><br><span class="line"> "outbound": &#123;...&#125;,</span><br><span class="line"> "inboundDetour": [</span><br><span class="line">     &#123;</span><br><span class="line">         <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</span><br><span class="line">         <span class="attr">"port"</span>: <span class="number">12345</span>,</span><br><span class="line">         <span class="attr">"protocol"</span>: <span class="string">"dokodemo-door"</span>,</span><br><span class="line">         <span class="attr">"settings"</span>: &#123;</span><br><span class="line">             <span class="attr">"network"</span>: <span class="string">"tcp,udp"</span>,</span><br><span class="line">             <span class="attr">"followRedirect"</span>: <span class="literal">true</span></span><br><span class="line">         &#125;</span><br><span class="line">     &#125;,</span><br><span class="line">     ...</span><br><span class="line"> ],</span><br><span class="line"> "outboundDetour": [...],</span><br><span class="line"> "routing": &#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>設定 iptables 規則，命令如下<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iptables -t nat -N V2RAY</span><br><span class="line">iptables -t nat -A V2RAY -d 192.168.0.0/16 -j RETURN</span><br><span class="line">iptables -t nat -A V2RAY -p tcp -j REDIRECT --to-ports 12345</span><br><span class="line">iptables -t nat -A PREROUTING -p tcp -j V2RAY</span><br></pre></td></tr></table></figure><p></p><p>UDP 流量透明代理的 iptables 規則，命令如下<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ip rule add fwmark 1 table 100</span><br><span class="line">ip route add <span class="built_in">local</span> 0.0.0.0/0 dev lo table 100</span><br><span class="line">iptables -t mangle -N V2RAY_MASK</span><br><span class="line">iptables -t mangle -A V2RAY_MASK  -d 192.168.0.0/16 -j RETURN</span><br><span class="line">iptables -t mangle -A V2RAY_MASK -p udp -j TPROXY --on-port 12345 --tproxy-mark 1</span><br><span class="line">iptables -t mangle -A PREROUTING -p udp -j V2RAY_MASK</span><br></pre></td></tr></table></figure><p></p><ol><li><p>使用電腦 / 手機直接訪問被牆網站，這時應當可以訪問的（如果不能，你可能得請教大神手把手指導了）。</p></li><li><p>寫腳本開機載入上述的 iptables，或者使用第三方軟件 (如 iptables-persistent)，否則閘道重啟後 iptables 會失效 (即透明代理會失效)。</p></li></ol><p>1.4. 注意事項</p><ul><li>在上面的設置中，假設訪問了國外網站，如 Google 等，閘道依然會使用的系統 DNS 進行查詢，只不過返回的結果是污染過的，而 V2Ray 提供的 domain override 能夠從流量中提取域名資訊交由 VPS 解析。也就是說，每次打算訪問被牆的網站，DNS 提供商都知道，鑑於國內企業尿性，也許 GFW 也都知道，會不會將這些資料收集喂 AI 也未可知。解決辦法是建一個 DNS，不向上級查詢，直接返回一個錯誤的 IP，反正 V2Ray 能夠解決污染問題。如果有朋友知道有什麼這樣的軟件，請告之 (可以使用 dnsmasq 實現)。</li><li>domain override 目前只能從 TLS 和 HTTP 流量中提取域名，如果上網流量有非這兩種類型的慎用 domain override 解決 DNS 污染。</li><li>由於對 iptables 不熟，我省略掉了對 UDP 流量的透明代理的設置，請精通此道的朋友補充一下 (目前 V2Ray 對 UDP 透明代理的實現有些問題，網路流量有大量 UDP 的網友請慎用)。</li><li>V2Ray 只能代理 TCP/UDP 的流量，ICMP 不支援，即就算透明代理成功了之後 ping Google 這類網站也是不通的。</li><li>最好設定閘道的位址為靜態 IP，否則閘道重啟後換了 IP 上不了網會很尷尬</li><li>上述的 iptables 配置只能使局域網內的其他設備翻牆，閘道本身是無法翻牆的，如果要閘道也能翻牆，要使用 iptables 的 owener 模組直連 V2Ray 發出的流量，然後執行 iptables -t nat -A OUTPUT -p tcp -j V2RAY。</li><li>按照網上的透明代理教程，設置 iptables 肯定要 RETURN 127.0.0.0/8 這類私有位址，但我個人觀點是放到 V2Ray 的路由裡好一些。</li></ul><h2 id="Docker-部署-V2Ray"><a href="#Docker-部署-V2Ray" class="headerlink" title="Docker 部署 V2Ray"></a>Docker 部署 V2Ray</h2><p>Docker 技術是一種新的虛擬化技術，和傳統的虛擬化技術不同。V2Ray 同樣提供 Docker 部署方式，並且通過 Docker 來部署 V2Ray 會非常輕鬆高效。</p><p>Docker 只能部署在 KVM 或者 XEN 架構的 VPS 中</p><p>首先安裝 Docker：</p><pre><code>sudo apt-get install -y docker</code></pre><p>安裝完 Docker 後我們從 <a href="https://toutyrater.github.io/app/https%EF%BC%9A/hub.docker.com" target="_blank" rel="noopener">DockerHub</a> 通過搜索找到 V2Ray 官方提供的鏡像， <a href="https://toutyrater.github.io/app/https%EF%BC%9A/hub.docker.com/r/v2ray/official" target="_blank" rel="noopener">鏈結</a>在此. 找到拉取鏡像的的命令並複製下來，在網頁右側我們可以看到命令為 docker pull v2ray/official ，我們將其複製下來回到命令行中粘貼並執行：</p><pre><code>sudo docker pull v2ray/official</code></pre><p>待 V2Ray 的 Docker 鏡像拉取完成後就可以進入下一個部署階段. 在此之前，你需要在 /etc 目錄下新建一個文件夾 v2ray， 並把你的配置寫好後命名為 config.json 放入 v2ray 文件夾內. 待配置文件準備就緒後鍵入以下命令進行部署，部署前請記下配置文件中你所設置的端口號，在部署時需要將其映射到宿主機上. 否則將無法訪問. 此處假設設定的端口號為 8888，需要映射到宿主機的 8888 端口上. 則命令為：</p><pre><code>sudo docker run -d --name v2ray -v /etc/v2ray：/etc/v2ray -p 8888:8888 v2ray/official  v2ray -config=/etc/v2ray/config.json</code></pre><p>鍵入以上命令後，命令行會出現一串字符，代表容器部署成功，可以立即通過客戶端連接並開始使用了. 如果還不放心，鍵入以下命令來查看容器的運行狀態：</p><pre><code>sudo docker container ls</code></pre><p>如果看到輸出的結果中有以下欄位代表容器成功運行：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker container ls</span><br><span class="line">CONTAINER ID        IMAGE                 COMMAND                  CREATED             STATUS              PORTS                     NAMES</span><br><span class="line">2a7sdo87kdf3        v2ray/official        <span class="string">"v2ray -config=/et..."</span>   3 minutes ago       Up 3 minutes        0.0.0.0：8888-&gt;8888/tcp    v2ray</span><br></pre></td></tr></table></figure><p></p><p>通過以下命令來啟動 V2Ray：</p><pre><code>sudo docker container start v2ray</code></pre><p>停止 V2Ray：</p><pre><code>sudo docker container stop v2ray</code></pre><p>重啟 V2Ray：</p><pre><code>sudo docker container restart v2ray</code></pre><p>查看日誌：</p><pre><code>sudo docker container log  v2ray</code></pre><p>更新配置後，需要重新部署容器，命令如下：</p><pre><code>sudo docker container stop v2raysudo docker container rm v2raysudo docker run -d --name v2ray -v /etc/v2ray：/etc/v2ray -p 8888：8888 v2ray/official  v2ray -config=/etc/v2ray/config.json</code></pre><p>假如你的配置換了端口號，那麼相應的端口映射也要更改，假如你在配置文件中把監聽端口改為了 9999，則’-p’參數應該這樣寫：</p><pre><code>-p  9999:9999</code></pre><p>假如你想將容器中的端口映射到本機的端口，則命令應該這樣寫</p><pre><code>-p 127.0.0.1:端口號:端口號</code></pre><p>除非你打算使用 Nginx 來轉發 Websocket 否則不需要映射到本地，直接填寫端口號：端口號的形式即可</p><p>另外，如果開啟了動態端口，-p 標記可以多次使用來綁定多個端口. 具體用法是在指令中再加上多個 -p 標記即可。</p><p>更新 V2Ray 的 Docker 鏡像：</p><pre><code>docker pull v2ray/official</code></pre><p>更新完之後，你需要重新部署容器，方法見上。</p><h2 id="BBR"><a href="#BBR" class="headerlink" title="BBR"></a>BBR</h2><p>Google 開發的擁塞控制，但個人的 VPS 記憶體略小先不裝，僅記錄<br>作者<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup><br>網上限定說記憶體需要 1G 大小，最小也需要 128M，經過我的折騰發現，128M 小記憶體 VPS 有時候並不如意，即使安裝好了 UML 也進不去系統，這就很讓人捉急，但是還好有了 LKL，比 UML 更加的方便，今天的教程就是教大家使用小記憶體 VPS 安裝 LKL+v2ray 體驗極速上網。</p><p>開始<br>首先還是一點，你需要 VPS，本次教程環境是 openvz，如果你沒有，那就可以去買個 KVM 框架的 VPS，免去折騰<br>推薦 BBR 一鍵安裝 + 小白翻牆教程<br>服務搭建已經寫在教程中。</p><p>本次教程環境<br>debian8 mini</p><p>128M 記憶體 + 20 端口轉發 NET</p><p>連接 SSH<br>Windows 推薦使用 putty 或者 Xshell，這裡不多贅述。</p><p>安裝 LKL<br>wget –no-check-certificate <a href="https://github.com/91yun/uml/raw/master/lkl/install.sh" target="_blank" rel="noopener">https://github.com/91yun/uml/raw/master/lkl/install.sh</a> &amp;&amp; bash install.sh</p><p>判斷是否安裝成功</p><p>ping 10.0.0.2 如果能 ping 通就說明安裝成功，否則失敗</p><p>修改轉發端口<br>修改 /root/lkl/run.sh ，查找 9000-9999 ，改成你想要的端口段</p><p>修改 /root/lkl/haproxy.cfg 查找 9000-9999 ，改成你想要的端口段</p><p>重啟 vps</p><p>安裝 v2ray<br>這裡要注意一下，安裝 v2ray 的端口要在 LKL 轉發的端口範圍內，否則安裝 LKL 也無用。</p><hr><p>OpenConnet Server (ocserv) 通過實現 Cisco 的 AnyConnect 協議，用 DTLS 作為主無協議，UPD DTLS 失敗時會轉用 TCP TLS。<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>記錄：<br><a href="https://wangwanjie.github.io/2017/07/28/购买BanwagonHOST" target="_blank" rel="noopener">購買 BanwagonHOST VPS 自建 Shadowsocks 記錄</a></p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none;padding-left:0"><li id="fn:1"><span style="display:inline-block;vertical-align:top;padding-right:10px">1.</span><span style="display:inline-block;vertical-align:top"><a href="https://bitinn.net/11084/" target="_blank" rel="noopener">加設 OpenConnect Server 給 iPhone 提供更順暢的網路生活</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display:inline-block;vertical-align:top;padding-right:10px">2.</span><span style="display:inline-block;vertical-align:top"><a href="https://www.v2ray.com/chapter_00/install.html" target="_blank" rel="noopener">Project V 安裝</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display:inline-block;vertical-align:top;padding-right:10px">3.</span><span style="display:inline-block;vertical-align:top"><a href="https://toutyrater.github.io/prep/json.html" target="_blank" rel="noopener">V2ray 白話教程</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display:inline-block;vertical-align:top;padding-right:10px">4.</span><span style="display:inline-block;vertical-align:top"><a href="https://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E5%94%AF%E4%B8%80%E8%AF%86%E5%88%AB%E7%A0%81" target="_blank" rel="noopener">通用唯一識別碼</a></span><a href="#fnref:4" rev="footnote"> ↩</a></li><li id="fn:5"><span style="display:inline-block;vertical-align:top;padding-right:10px">5.</span><span style="display:inline-block;vertical-align:top"><a href="https://www.aihoom.com/1194.html" target="_blank" rel="noopener">openVZ 框架安裝 LKL+v2ray 讓你閒置的小記憶體 VPS 翻牆</a></span><a href="#fnref:5" rev="footnote"> ↩</a></li><li id="fn:6"><span style="display:inline-block;vertical-align:top;padding-right:10px">6.</span><span style="display:inline-block;vertical-align:top"><a href="https://zh.wikipedia.org/zh-tw/%E4%BC%A0%E8%BE%93%E5%B1%82" target="_blank" rel="noopener">傳輸層</a></span><a href="#fnref:6" rev="footnote"> ↩</a></li></ol></div></div><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;預定要寫&lt;br&gt;
    
    </summary>
    
    
      <category term="VPN" scheme="https://ppundsh.github.io/tags/VPN/"/>
    
      <category term="GFW" scheme="https://ppundsh.github.io/tags/GFW/"/>
    
      <category term="V2Ray" scheme="https://ppundsh.github.io/tags/V2Ray/"/>
    
      <category term="ShadowSocksR" scheme="https://ppundsh.github.io/tags/ShadowSocksR/"/>
    
  </entry>
  
  <entry>
    <title>SDN 筆記</title>
    <link href="https://ppundsh.github.io/2018-04-15/SDN-%E7%AD%86%E8%A8%98/"/>
    <id>https://ppundsh.github.io/2018-04-15/SDN-筆記/</id>
    <published>2018-04-15T09:12:24.000Z</published>
    <updated>2018-04-15T13:48:04.322Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>SDN (Software-defined networking) 是利用 Data link Layer 層中的 OpenFlow 協定<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>，將 Forwording 的硬體和控制行為分離，而得設置 Programmable network (程式化的網路行為), 比起用 ACL 和路由協定，能作更複雜的管理<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>。<br><a id="more"></a><br>資料來源<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br>SDN 將網路架構簡化為封包轉送硬體與網路決策控制器 (decision-making network controller) 二個單元，其中封包轉送硬體由<br>(1) 包含了條目 (entry) 以及對於活躍的流程 (active flows) 所必須採取的行動的流程表 (flow table)；<br>(2) 以及能夠與控制器經由安全的通道溝通對於尚未在流程表上的新條目所必須採取行動的階層 (layer) 所構成。</p><p>1. 現存的 SDN 架構 ForCES 與 OpenFlow 為前最具影響力的主流 SDN 介面，二者皆遵守 SDN 的基本精神，也就是將資料傳輸與控制單元分離以及使得兩者經由安全通道交換訊息；但二者在架構、封包轉送模式與通訊協定介面上有顯著的不同。</p><p>2. ForCES 由 IETF ForCES(Forwarding and Control Element Separation) Working Group 所提出，將網路元件內部重新定義為控制單元以及封包轉送單元分離的架構，但網路元件依然被視為一個個體；如此一來不但網路元件巨觀上與傳統網路元件極為類似，控制單元的決策亦可由第三方軟體來控制。<br>ForCES 定義了一個稱為稱為 Forwarding Element(FE)，實施 ForCES 通訊協定的邏輯個體 (logic entity)，負責利用其下層的硬體處理封包；一個負責執行控制訊號函數的邏輯個體稱為 Control Element(CE)，告訴 FE 如何處理封包；另外一個在 FE 上、被 CE 根據 ForCES 通訊協定所控制的函數區塊稱為 Logical Function Block(LFB)，允許 CE 控制 FE 的組態。</p><p>3. OpenFlow<br>在 OpenFlow 的架構中，封包轉送裝置稱為 OpenFlow Switch，包含了一個或多個流程表，流程表由流程條目 (flow entry) 所組成，由它們決定屬於一個流程的封包應該如何處理與轉送。流程條目由<br>(1) 配對區域 (match fields)：配對流入封包位於標頭區 (header) 的資訊。<br>(2) 計數器 (counters)：蒐集特定流程的資料，例如接收封包數、封包大小、流程持續時間等。<br>(3) 採取的動作：封包符合配對的話應該採取處理封包的動作所組成。</p><p>當 OpenFlow Switch 接收到一個封包時，它會解開封包的標頭區並根據流程表進行配對，若配對未通過則進行至下一個流程表，直到通過配對並決定應該採取的動作為止；如果該封包沒有通過任何一個流程表的配對，所採取的動作將由表上無名流程條目 (table-miss flow entry) 決定，這個條目尚包含的動作可能是丟棄封包、將封包經由 OpenFlow 的頻道 (channel) 傳給控制元件等。</p><p>其它</p><hr><p>SDN 是由 SUN 在1995年首次提出。<br>OpenFlow 是由 2008 年在史丹褔大學開使。<br>IBM 的控制器為 PNC (Programmable Network Controller)<br>Cisco 的 OF 控制器為 Cisco XNC<br>Cisco ONE (Cisco Open Network Environment) 提供開放 API 讓開發人員可使用自已熟悉的語言開發符合企業網路管理的應用<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup><br>Microsoft 的網路虛擬化協定 NVGRE (Network Virtualization using Generic Routing Encapsulation)<br>IBM 的網路虛擬化協定 DOVE (Distributed Overlay Virtual Ethernet)<br>VMware 的網路虛擬化協定VXLAN (Virtual eXtensible Local Area Network)</p><p>Nicira 被 VMware 收購，而其創辨人參與了 OF 的制定和發展，SDN 解決方案為 NVP (Network Virtualization Platform) ，NTT、AT&amp;T、ebay 皆是其客戶<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></p><p>資料來源：</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none;padding-left:0"><li id="fn:1"><span style="display:inline-block;vertical-align:top;padding-right:10px">1.</span><span style="display:inline-block;vertical-align:top"><a href="https://zh.wikipedia.org/wiki/%E8%BB%9F%E9%AB%94%E5%AE%9A%E7%BE%A9%E7%B6%B2%E8%B7%AF" target="_blank" rel="noopener">SDN Wiki</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display:inline-block;vertical-align:top;padding-right:10px">2.</span><span style="display:inline-block;vertical-align:top"><a href="http://www.cc.ntu.edu.tw/chinese/epaper/0029/20140620_2908.html" target="_blank" rel="noopener">軟體定義網路架構簡介</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display:inline-block;vertical-align:top;padding-right:10px">3.</span><span style="display:inline-block;vertical-align:top"><a href="https://www.ithome.com.tw/node/77354" target="_blank" rel="noopener">3種SDN架構的産品策略</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;SDN (Software-defined networking) 是利用 Data link Layer 層中的 OpenFlow 協定&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;，將 Forwording 的硬體和控制行為分離，而得設置 Programmable network (程式化的網路行為), 比起用 ACL 和路由協定，能作更複雜的管理&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
      <category term="SDN" scheme="https://ppundsh.github.io/tags/SDN/"/>
    
      <category term="OVSDB" scheme="https://ppundsh.github.io/tags/OVSDB/"/>
    
  </entry>
  
  <entry>
    <title>學習單</title>
    <link href="https://ppundsh.github.io/2018-04-14/%E5%AD%B8%E7%BF%92%E5%96%AE/"/>
    <id>https://ppundsh.github.io/2018-04-14/學習單/</id>
    <published>2018-04-13T16:33:15.000Z</published>
    <updated>2018-04-14T19:47:04.664Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>以後學習用的記錄<br><a id="more"></a></p><h2 id="Trace"><a href="#Trace" class="headerlink" title="Trace"></a>Trace</h2><ul><li>Grafana</li><li>Rancher</li><li>Spunk</li><li>ELK</li><li><a href="https://joshhu.gitbooks.io/docker_theory_install/content/index.html" target="_blank" rel="noopener">Docker</a></li><li>Probe</li></ul><h2 id="系統"><a href="#系統" class="headerlink" title="系統"></a>系統</h2><ul><li>SIEM</li><li>DLP</li></ul><h3 id="1-作業系統基礎"><a href="#1-作業系統基礎" class="headerlink" title="1.作業系統基礎"></a>1.作業系統基礎</h3><ul><li>CentOS7 mionimal</li><li>修改 hostname，查看hostname ，分暫時與永久</li><li>ip 修改為固定 ip/dhcp ，查看 gateway, 暫時DNS</li><li>停用防火牆，查看開機是否執行</li><li>查看系統時間/怎麼看對時，如何強制對時，手動修改時間</li><li>查看 SELINUX 狀態，暫時/永久停用</li><li>查看現在的 DNS 為何，暫時/水久停用</li><li>安裝 telnet，nslookup、man、wget</li></ul><h3 id="2-Log"><a href="#2-Log" class="headerlink" title="2.Log"></a>2.Log</h3><ul><li>查看系統訊息log</li><li>查看目前登入人員，查看目前登入人員正在下什麼指令，查看曾經登入使用者</li><li>查看硬體 log</li><li>查看 crontab log</li><li>查看曾經輸入過的指令</li><li>查看誰成功登入，誰失敗登入</li><li>cat 最後十筆記錄，最前十筆紀錄，一修改就跳 log</li><li>資料夾欄位的意思 root,root 意思</li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;以後學習用的記錄&lt;br&gt;
    
    </summary>
    
    
      <category term="Personal" scheme="https://ppundsh.github.io/tags/Personal/"/>
    
  </entry>
  
  <entry>
    <title>Cmder 筆記</title>
    <link href="https://ppundsh.github.io/2018-04-13/Cmder-%E7%AD%86%E8%A8%98/"/>
    <id>https://ppundsh.github.io/2018-04-13/Cmder-筆記/</id>
    <published>2018-04-12T18:37:06.000Z</published>
    <updated>2018-04-14T19:46:35.800Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>設定上的記錄，全新安裝後要做的設定<br><a id="more"></a></p><h2 id="安裝右鍵選單"><a href="#安裝右鍵選單" class="headerlink" title="安裝右鍵選單"></a>安裝右鍵選單</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cmder.exe /REGISTER ALL</span><br></pre></td></tr></table></figure><h2 id="開啟時自動到指定的位置："><a href="#開啟時自動到指定的位置：" class="headerlink" title="開啟時自動到指定的位置："></a>開啟時自動到指定的位置：</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">setting →Startup:Tasks→+</span><br><span class="line">cmd /k <span class="string">"%ConEmuDir%\..\init.bat"</span>  -new_console:d:D:\GitHub\Hexo\</span><br></pre></td></tr></table></figure><h2 id="安裝後的調整："><a href="#安裝後的調整：" class="headerlink" title="安裝後的調整："></a>安裝後的調整：</h2><p>中文字體：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Font ，Mani font 下的 Aternative font 加入 CJK 字體，再設置 Unicode ranges 為 CJK</span><br></pre></td></tr></table></figure><p></p><h2 id="中文亂碼"><a href="#中文亂碼" class="headerlink" title="中文亂碼:"></a>中文亂碼:</h2><p>順便把代碼頁換成 utf-8<br>Startup→Environnment 下，加入<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> LANG=zh_CN.UTF-8</span><br><span class="line">chcp 65001</span><br></pre></td></tr></table></figure><p></p><h2 id="無邊框"><a href="#無邊框" class="headerlink" title="無邊框"></a>無邊框</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">main&gt;&gt; appearence &gt;&gt; hide caption always</span><br></pre></td></tr></table></figure><h2 id="避免殘留字"><a href="#避免殘留字" class="headerlink" title="避免殘留字"></a>避免殘留字</h2><p>默認的為λ，改成常用的$<br>打開\cmder\vendor目錄下面的clink.lua文件，搜索λ，全部替換成$即可！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;設定上的記錄，全新安裝後要做的設定&lt;br&gt;
    
    </summary>
    
    
      <category term="cmd" scheme="https://ppundsh.github.io/tags/cmd/"/>
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
      <category term="install" scheme="https://ppundsh.github.io/tags/install/"/>
    
  </entry>
  
  <entry>
    <title>Windows 改本機密碼</title>
    <link href="https://ppundsh.github.io/2018-04-13/Windows%E6%94%B9%E6%9C%AC%E6%A9%9F%E5%AF%86%E7%A2%BC/"/>
    <id>https://ppundsh.github.io/2018-04-13/Windows改本機密碼/</id>
    <published>2018-04-12T17:51:39.000Z</published>
    <updated>2018-04-13T07:26:25.901Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>剛好遇到，小記一下。<br>用開機光碟修改，以便在鎖定畫面叫出 cmd 改密碼。<br><a id="more"></a><br>用開機光碟，不要按下一步，用指令叫出 cmd<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">shift</span> + F10</span><br></pre></td></tr></table></figure><p></p><p>用 diskpart 查看分區<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">diskpaart</span><br></pre></td></tr></table></figure><p></p><p>將螢幕小鍵盤改成 cmd<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> windows\system32</span><br><span class="line">copy cmd.exe cmd.exe.ori</span><br><span class="line">copy osk.exe osk.exe.ori</span><br><span class="line">del osk.exe</span><br><span class="line">ren cmd.exe osk.exe</span><br><span class="line">shutdown –r –t 00</span><br></pre></td></tr></table></figure><p></p><p>或<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">copy C:\windows\system32\sethc.exe c:\</span><br><span class="line">copy /y c:\windows\system32\cmd.exe c:\windows\system32\sethc.exe</span><br></pre></td></tr></table></figure><p></p><p>(登入界面按五次 shift )</p><p>重開機後，點右下角的“輕鬆讀取”，點螢幕小鍵盤，用 net user 改密碼的指令<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user 帳號 *</span><br></pre></td></tr></table></figure><p></p><p>完成後按 exit 離開。</p><p>之後預定：<br></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">H3</span>&gt;</span>中間人<span class="tag">&lt;/<span class="name">H3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"datafile"</span> <span class="attr">size</span>=<span class="string">"40"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;剛好遇到，小記一下。&lt;br&gt;用開機光碟修改，以便在鎖定畫面叫出 cmd 改密碼。&lt;br&gt;
    
    </summary>
    
    
      <category term="cmd" scheme="https://ppundsh.github.io/tags/cmd/"/>
    
      <category term="windows" scheme="https://ppundsh.github.io/tags/windows/"/>
    
      <category term="crack" scheme="https://ppundsh.github.io/tags/crack/"/>
    
  </entry>
  
  <entry>
    <title>維運指令備忘</title>
    <link href="https://ppundsh.github.io/2018-04-11/%E7%B6%AD%E9%81%8B%E6%8C%87%E4%BB%A4%E5%82%99%E5%BF%98/"/>
    <id>https://ppundsh.github.io/2018-04-11/維運指令備忘/</id>
    <published>2018-04-10T18:38:35.000Z</published>
    <updated>2018-04-14T16:22:06.734Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>先記錄 CMD 、能直接執行的命令、控制台快捷鍵<br><a id="more"></a></p><h2 id="CMD"><a href="#CMD" class="headerlink" title="CMD"></a>CMD</h2><p>Cmd 用檔案總管開啟當前資料夾<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start .</span><br></pre></td></tr></table></figure><p></p><p>檔案總管用 Cmd 開啟當前資料夾<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">shift</span> + 右鍵</span><br><span class="line">位置列輸入 cmd</span><br></pre></td></tr></table></figure><p></p><h2 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h2><p>開啟指令為<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">win + r</span><br></pre></td></tr></table></figure><p></p><p>創建新捷徑<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe shell32.dll,Control_RunDLL ncpa.cpl</span><br></pre></td></tr></table></figure><p></p><p>常用參數有：</p><table><thead><tr><th>命令</th><th>功能</th></tr></thead><tbody><tr><td>calc</td><td>小算盤</td></tr><tr><td>ncpa.cpl</td><td>控制台：網路連線</td></tr><tr><td>sysdm.cpl</td><td>系統</td></tr><tr><td>appwize.cpl</td><td>新增程式</td></tr><tr><td>gpedit.msc</td><td>群組</td></tr><tr><td>mstsc</td><td>遠端桌面</td></tr><tr><td>services.msc</td><td>服務</td></tr><tr><td>control userpasswords2</td><td>自動登入</td></tr><tr><td>netplwiz</td><td>自動登入</td></tr><tr><td>lusrmgr.msc</td><td>本機使用者和群組</td></tr><tr><td>certmgr.msc</td><td>憑證管理</td></tr><tr><td>perfmon.msc</td><td>效能監視器</td></tr><tr><td>winver</td><td>查看 windows 版本</td></tr></tbody></table><h2 id="命令列工具"><a href="#命令列工具" class="headerlink" title="命令列工具"></a>命令列工具</h2><table><thead><tr><th>工具</th><th>功能</th></tr></thead><tbody><tr><td>systeminfo</td><td>系統祥細訊息</td></tr><tr><td>net use</td><td>查看網路連線</td></tr><tr><td>net user</td><td>查看本機帳號</td></tr><tr><td>whoami</td><td>查看當前帳號狀態</td></tr></tbody></table><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;先記錄 CMD 、能直接執行的命令、控制台快捷鍵&lt;br&gt;
    
    </summary>
    
    
      <category term="cmd" scheme="https://ppundsh.github.io/tags/cmd/"/>
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
  </entry>
  
  <entry>
    <title>Hexo + GitHub 搭建記錄</title>
    <link href="https://ppundsh.github.io/2018-04-09/Hexo-GitHub-%E6%90%AD%E5%BB%BA%E8%A8%98%E9%8C%84/"/>
    <id>https://ppundsh.github.io/2018-04-09/Hexo-GitHub-搭建記錄/</id>
    <published>2018-04-08T16:45:23.000Z</published>
    <updated>2018-04-15T15:29:33.986Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>作為第一篇記錄，圖片等之後確認圖床再補上。<br>官網 <a href="https://hexo.io/" target="_blank" rel="noopener">https://hexo.io/</a><br><a id="more"></a></p><h2 id="安裝-Git-和-Node-js"><a href="#安裝-Git-和-Node-js" class="headerlink" title="安裝 Git 和 Node.js"></a>安裝 Git 和 Node.js</h2><p>主要參者作者：<a href="https://lyyybz.github.io/blog/2016/12/15/Hexo-%E6%9E%84%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener">lyyybz</a>、<a href="https://xuanwo.org/2015/03/26/hexo-intor/" target="_blank" rel="noopener">Xuanwo</a><br>必需先裝好 Git 和 Node.js 。</p><h3 id="安裝和設定-Git"><a href="#安裝和設定-Git" class="headerlink" title="安裝和設定 Git"></a>安裝和設定 Git</h3><p>Git 是一款免費、開源的分佈式版本控制系統。<br>Git 的安裝詳細可參考 <a href="https://github.com/doggy8088/Learn-Git-in-30-days/blob/master/zh-tw/02.md" target="_blank" rel="noopener">在 Windows 平台必裝的三套 Git 工具</a> 一文，在此簡述必要的動作。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">到 https://gitforwindows.org/ 官網，點擊 Download 下載，預設安裝即可</span><br><span class="line">開啟 CMD ，輸入 git --version 確認安裝版本。</span><br></pre></td></tr></table></figure><p>設定使用者名稱及電子郵件。 Git 的提交會使用這些資訊，而且提交後不能再被修改。<br>詳細可參考 <a href="https://git-scm.com/book/zh-tw/v2/%E9%96%8B%E5%A7%8B-%E5%88%9D%E6%AC%A1%E8%A8%AD%E5%AE%9A-Git" target="_blank" rel="noopener">開始-初次設定-Git</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">"名稱"</span></span><br><span class="line">$ git config --global user.email Email地址</span><br></pre></td></tr></table></figure><p>可用 <code>git config --global --list</code> 確認是否設定正確</p><hr><h3 id="安裝-Node-js"><a href="#安裝-Node-js" class="headerlink" title="安裝 Node.js"></a>安裝 Node.js</h3><p>Node.js 是一款開源且跨平台的伺服器端和網路應用，使用 JavaScript 開發。<br>到官網下載 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">https://nodejs.org/en/</a> ，默認安裝即可。</p><p>完成後可以在 cmd 輸入以下指令確認</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node -v</span><br><span class="line">npm -v</span><br></pre></td></tr></table></figure><h2 id="配置-Github"><a href="#配置-Github" class="headerlink" title="配置 Github"></a>配置 Github</h2><p>至 <a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a> 申請一個帳號。<br>登陸之後，點擊頁面右上角的加號，選擇New repository (建立儲存庫)</p><p>在Repository name下填寫yourname.github.io，Description (optional)下填寫一些簡單的描述（不寫也沒有關係）</p><p>開啟 gh-pages 功能<br>點擊界面右側的Settings，你將會打開這個庫的 setting 頁面，向下拖動，直到看見GitHub Pages</p><p>點擊Automatic page generator，Github 將會創建出一個 gh-pages 的頁面。 如果配置沒有問題，那麼大約 15 分鐘之後，yourname.github.io這個網址就可以正常訪問了~ 如果yourname.github.io已經可以正常訪問了，那麼 Github 一側的配置已經全部結束了。</p><h2 id="配置-Hexo"><a href="#配置-Hexo" class="headerlink" title="配置 Hexo"></a>配置 Hexo</h2><p>先決定好要放置 blog 文件的資料夾，假設是 D://Github/blug，建立好後該資料後在位置列輸入 cmd ，用當前目錄開啟 CMD</p><p>於 CMD　中輸入<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-cli-g</span><br><span class="line">npm install hexo --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><p></p><p>輸入以下指令確認<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo -v</span><br></pre></td></tr></table></figure><p></p><h3 id="初始化-Hexo"><a href="#初始化-Hexo" class="headerlink" title="初始化 Hexo"></a>初始化 Hexo</h3><p>繼續輸入<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><p></p><p>部建<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure><p></p><p>本機測試<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo s</span><br></pre></td></tr></table></figure><p></p><p>打在 <a href="http://localhost:4000/" target="_blank" rel="noopener">http://localhost:4000/</a> ，可以看到當前的網頁</p><h2 id="使用-Hexo"><a href="#使用-Hexo" class="headerlink" title="使用 Hexo"></a>使用 Hexo</h2><p>可以在 _config.yml 中修改大部份的配置。</p><h2 id="配置-Deployment"><a href="#配置-Deployment" class="headerlink" title="配置 Deployment"></a>配置 Deployment</h2><p>用文字編輯器修改 D://Github/blog (範例用)下的 _config.yml ，找到 Deployment ，按照如下</p><p>deploy:<br>type: git<br>repo: <a href="mailto:git@github.com" target="_blank" rel="noopener">git@github.com</a>:yourname/yourname.github.io.git<br>branch: master</p><p>在 blog 輸入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure><p>開始佈署</p><h2 id="添加新文章"><a href="#添加新文章" class="headerlink" title="添加新文章"></a>添加新文章</h2><p>打開 Hexo 目錄下的source文件夾，所有的文章都會以 md 形式保存在_post文件夾中，只要在_post文件夾中新建 md 類型的文檔，就能在執行hexo g的時候被渲染。 新建的文章頭需要添加一些 yml 資訊，如下所示：</p><pre><code>title: hello-world   //在此處添加你的標題。date: 2014-11-7 08:55:29   //在此處輸入你編輯這篇文章的時間。categories: Exercise   //在此處輸入這篇文章的分類。</code></pre><h2 id="Markdown-記錄"><a href="#Markdown-記錄" class="headerlink" title="Markdown 記錄"></a>Markdown 記錄</h2><p>編輯格式是用 markdown ，留一下參考連結<br><a href="http://markdown.tw/" target="_blank" rel="noopener">http://markdown.tw/</a><br><a href="https://hyxxsfwy.github.io/2016/01/15/Hexo-Markdown-%E7%AE%80%E6%98%8E%E8%AF%AD%E6%B3%95%E6%89%8B%E5%86%8C/" target="_blank" rel="noopener">https://hyxxsfwy.github.io/2016/01/15/Hexo-Markdown-%E7%AE%80%E6%98%8E%E8%AF%AD%E6%B3%95%E6%89%8B%E5%86%8C/</a></p><h3 id="HTML-錨點跳轉"><a href="#HTML-錨點跳轉" class="headerlink" title="HTML 錨點跳轉"></a>HTML 錨點跳轉</h3><p>來源：<a href="https://charlottehong.blogspot.com/2017/07/markdown-hackmd-github.html" target="_blank" rel="noopener">Charlotte.HonG</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"First"</span>&gt;</span>跳轉到的地方<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>相對應的跳轉方式就是<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[點我跳轉](<span class="comment">#First)</span></span><br></pre></td></tr></table></figure><p></p><h3 id="增加注解功能"><a href="#增加注解功能" class="headerlink" title="增加注解功能"></a>增加注解功能</h3><p>安裝 hexo-footnotes</p><pre><code>npm install hexo-footnotes --save</code></pre><p>安裝完成即自動啟用，如果沒啟用，可以修改</p><figure class="highlight plain"><figcaption><span>添加以下資料：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">````bash</span><br><span class="line">plugins:</span><br><span class="line">  - hexo-footnotes</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p></p><p>使用方法為<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></span><br><span class="line">### 部署時保證 README.md 不被渲染來源：[Godlike](http://godlikemeteor.com/2017/07/20/Hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%94%BB%E7%95%A5%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E8%BF%9B%E9%98%B6%E7%AF%87/)一般 Git 倉庫下面都有一個README.md來表現這個倉庫設立的目的，但是運用 hexo 佈置的時候會被自動渲染，接下來要介紹部署時保證README.md不被渲染的方法。在 Hexo 目錄下的source根目錄下添加一個,README.md。修改 Hexo 目錄下的_config.yml。將skip_render參數的值設置上。skip_render: README.md保存退出即可。## 修改主題為 Next作者：[zhiho](https://zhiho.github.io/2015/09/29/hexo-next/)在 blog 資料夾下使用命令下載 Next 主題到 themes 目錄中<escape><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure><p></p><p>修改站點配置文件_config.yml 中的 theme 標籤：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure><p>修改成功後，重新啟動 Server 就能夠看到修改後的效果。<br>Next 主題一共有三種樣式，可以通過修改 Next 主題的配置文件_config.yml 來修改：</p><pre><code># ---------------------------------------------------------------# Scheme Settings# ---------------------------------------------------------------# Schemesscheme: Muse#scheme: Mist#scheme: Pisces</code></pre><h2 id="Gitalk-評論系統"><a href="#Gitalk-評論系統" class="headerlink" title="Gitalk 評論系統"></a>Gitalk 評論系統</h2><p>作者：<a href="https://asdfv1929.github.io/2018/01/20/gitalk/" target="_blank" rel="noopener">asdfv1020</a><br>一個基於 Github Issue 和 Preact 開發的評論插件，所有要修改的檔案都是在 D:\GitHub\blog\themes\next (範例目錄的\themes\next) 之下<br>詳情 Demo 可見：<a href="https://gitalk.github.io/" target="_blank" rel="noopener">https://gitalk.github.io/</a></p><h3 id="註冊新應用"><a href="#註冊新應用" class="headerlink" title="註冊新應用"></a>註冊新應用</h3><p>在 GitHub 上註冊新應用，鏈結：<a href="https://github.com/settings/applications/new" target="_blank" rel="noopener">https://github.com/settings/applications/new</a></p><p>參數說明：<br>    Application name： # 應用名稱，隨意<br>    Homepage URL： # 網站 URL，如 <a href="https://ppundsh.github.io">https://ppundsh.github.io</a> ，不是 repo<br>    Application description # 描述，隨意<br>    Authorization callback URL：# 網站 URL，<a href="https://ppundsh.github.io">https://ppundsh.github.io</a> ，不是 repo</p><p>點擊註冊後，頁面跳轉，其中Client ID和Client Secret在後面的配置中需要用到，到時複製粘貼即可</p><h3 id="comments-swig"><a href="#comments-swig" class="headerlink" title="comments.swig"></a>comments.swig</h3><p>修改/layout/_partials/comments.swig，添加內容在最下面：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> theme.gitalk.enable %&#125;</span><br><span class="line">  &lt;div id=<span class="string">"gitalk-container"</span>&gt;&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h3 id="index-swig"><a href="#index-swig" class="headerlink" title="index.swig"></a>index.swig</h3><p>修改layout/_third-party/comments/index.swig，在最後一行添加內容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include <span class="string">'gitalk.swig'</span> %&#125;</span><br></pre></td></tr></table></figure><h3 id="gitalk-styl"><a href="#gitalk-styl" class="headerlink" title="gitalk.styl"></a>gitalk.styl</h3><p>新建/source/css/_common/components/third-party/gitalk.styl文件，添加內容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.gt-header a, .gt-comments a, .gt-popup a</span><br><span class="line">  border-bottom: none;</span><br><span class="line">.gt-container .gt-popup .gt-action.is--active:before</span><br><span class="line">  top: 0.7em;</span><br></pre></td></tr></table></figure><h3 id="third-party-styl"><a href="#third-party-styl" class="headerlink" title="third-party.styl"></a>third-party.styl</h3><p>修改/source/css/_common/components/third-party/third-party.styl，在最後一行上添加內容，引入樣式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@import <span class="string">"gitalk"</span>;</span><br></pre></td></tr></table></figure><h3 id="Md5-加密-id-避免中文編碼過長"><a href="#Md5-加密-id-避免中文編碼過長" class="headerlink" title="Md5 加密 id 避免中文編碼過長"></a>Md5 加密 id 避免中文編碼過長</h3><p>參考資料與作者：<a href="https://qhh0205.github.io/2018/03/25/hexo-next-%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AEgitalk%E8%AF%84%E8%AE%BA-%E7%88%AC%E5%9D%91%E8%AE%B0/" target="_blank" rel="noopener">qhh0205</a>、<a href="https://gist.github.com/uolcano/70c3926a4716759ec6599f444a172e64" target="_blank" rel="noopener">uolcano</a><br>post 檔名為中文時，容易造成編碼出 github issue lables 50 字符限制而出現 Error: Validation Failed. ，解決方法為使用 md5 加密 id 來縮短長度。</p><p>在此把 md5 加密的 js 放在 gist 上托管，在主頁面上右上角的頭像，點一下選 your gist<br>Gist description ：說明，選填<br>Filename including extension ：md5.min.js<br>內容請貼上以下 js 源碼點開後的內容：<a href="https://gist.githubusercontent.com/qhh0205/78e9e0b1f3114db6737f3ed8cdd51d3a/raw/3894c5be5aa2378336b1f5ee0f296fa0b22d06e9/md5.min.js" target="_blank" rel="noopener">點我</a></p><p>完成後點右下的 Create public gist 以創建。</p><p>創建成功後，點擊右邊的 RAW ，將網址的 gist.githubusercontent.com 替換為 rawgit.com ，即 <a href="https://rawgit.com/ppundsh/f359785730acb0fbfdee07eb12522623/raw/15ce7e5ea97e7afb71792d58a21978f225195a12/md5.min.js" target="_blank" rel="noopener">https://rawgit.com/ppundsh/f359785730acb0fbfdee07eb12522623/raw/15ce7e5ea97e7afb71792d58a21978f225195a12/md5.min.js</a></p><p>以上即為 md5 js gist 嵌入鏈結</p><h3 id="gitalk-swig"><a href="#gitalk-swig" class="headerlink" title="gitalk.swig"></a>gitalk.swig</h3><p>新建/layout/_third-party/comments/gitalk.swig文件，並添加內容：<br>第二行 &lt;scrip scrc= 替換為自已的 md5 js gist 嵌入鏈結</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> page.comments &amp;&amp; theme.gitalk.enable %&#125;</span><br><span class="line">  &lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.css"</span>&gt;</span><br><span class="line">  &lt;script src=<span class="string">"https://unpkg.com/gitalk/dist/gitalk.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script src=<span class="string">"https://rawgit.com/qhh0205/78e9e0b1f3114db6737f3ed8cdd51d3a/raw/3894c5be5aa2378336b1f5ee0f296fa0b22d06e9/md5.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line">        var gitalk = new Gitalk(&#123;</span><br><span class="line">          clientID: <span class="string">'&#123;&#123; theme.gitalk.ClientID &#125;&#125;'</span>,</span><br><span class="line">          clientSecret: <span class="string">'&#123;&#123; theme.gitalk.ClientSecret &#125;&#125;'</span>,</span><br><span class="line">          repo: <span class="string">'&#123;&#123; theme.gitalk.repo &#125;&#125;'</span>,</span><br><span class="line">          owner: <span class="string">'&#123;&#123; theme.gitalk.githubID &#125;&#125;'</span>,</span><br><span class="line">          admin: [<span class="string">'&#123;&#123; theme.gitalk.adminUser &#125;&#125;'</span>],</span><br><span class="line">          id: md5(location.pathname),</span><br><span class="line">          distractionFreeMode: <span class="string">'&#123;&#123; theme.gitalk.distractionFreeMode &#125;&#125;'</span></span><br><span class="line">        &#125;)</span><br><span class="line">        gitalk.render(<span class="string">'gitalk-container'</span>)           </span><br><span class="line">       &lt;/script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><h3 id="關閉不須要的評論"><a href="#關閉不須要的評論" class="headerlink" title="關閉不須要的評論"></a>關閉不須要的評論</h3><p>D:\GitHub\Blog\source\tags\inedx.md<br>在 type: 下加入<br>    comments: false</p><h4 id="config-yml"><a href="#config-yml" class="headerlink" title="_config.yml"></a>_config.yml</h4><p>在主題配置文件next/_config.yml中添加如下內容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gitalk:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  githubID: github帳號  <span class="comment"># 例：ppundsh  </span></span><br><span class="line">  repo: 倉庫名稱   <span class="comment"># 例：ppundsh.github.io</span></span><br><span class="line">  ClientID: Client ID</span><br><span class="line">  ClientSecret: Client Secret</span><br><span class="line">  adminUser: github帳號 <span class="comment">#指定可初始化評論賬戶 例：ppundsh</span></span><br><span class="line">  distractionFreeMode: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>以上就是 NexT 中添加 gitalk 評論的配置，博客上傳到 GitHub 上後，打開頁面進入某一博客內容下，就可看到評論處。</p><h2 id="Next-其它功能完善"><a href="#Next-其它功能完善" class="headerlink" title="Next 其它功能完善"></a>Next 其它功能完善</h2><h3 id="顯示閱讀全文按鈕"><a href="#顯示閱讀全文按鈕" class="headerlink" title="顯示閱讀全文按鈕"></a>顯示閱讀全文按鈕</h3><p>在文章中添加 more 標籤即可，形式如下：</p><pre><code>&lt;!--more--&gt; </code></pre><p>標籤以上的內容將以摘要的形式在首頁顯示，並出現閱讀全文的按鈕。</p><h3 id="搜索功能"><a href="#搜索功能" class="headerlink" title="搜索功能"></a>搜索功能</h3><p>作者：<a href="https://www.iots.vip/post/hexo-build-to-optimize.html" target="_blank" rel="noopener">Alliot</a><br>　　推薦使用 Local Search 作為站內搜索，搜索速度快，同時比較簡潔，啟用方法如下：</p><p>1、安裝插件<br>　　安裝 hexo-generator-searchdb 插件<br>　　打開 Node.js command prompt，在站點的根目錄下執行以下命令：</p><pre><code>npm install hexo-generator-searchdb --save</code></pre><p>2、更改配置文件<br>更改站點配置文件，新增如下內容於任意位置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  <span class="built_in">limit</span>: 10000</span><br></pre></td></tr></table></figure><p>更改 NexT 主題配置文件，開啟 Local Search 作為站內搜索：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Local search</span></span><br><span class="line">local_search:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="功能表設置"><a href="#功能表設置" class="headerlink" title="功能表設置"></a>功能表設置</h3><p>NexT 主題功能表設置，用於設置博客上方導航欄，在主題配置文件中修改。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /                       #主頁</span><br><span class="line">  categories: /categories#分類頁（需手動創建）</span><br><span class="line">  #about: /about#關於頁面（需手動創建）</span><br><span class="line">  archives: /archives#歸檔頁</span><br><span class="line">  tags: /tags#標籤頁（需手動創建）</span><br><span class="line">  #commonweal: /404.html        # 404 （需手動創建）</span><br></pre></td></tr></table></figure><p>只是在 menu 選項中設置還不能讓標籤頁面、分類頁面生效，需要我們手動創建</p><h3 id="標籤頁面"><a href="#標籤頁面" class="headerlink" title="標籤頁面"></a>標籤頁面</h3><p>運行以下命令<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page <span class="string">"tags"</span></span><br></pre></td></tr></table></figure><p></p><p>同時，在 / source 目錄下會生成一個 tags 文件夾，裡面包含一個index.md文件</p><p>修改 / source/tags 目錄下的index.md文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: tags</span><br><span class="line">date: 2015-09-29 14:37:02</span><br><span class="line"><span class="built_in">type</span>: <span class="string">"tags"</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>修改主題配置文件</p><p>去掉 tags 的註釋</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /                       <span class="comment">#主頁</span></span><br><span class="line">  categories: /categories<span class="comment">#分類頁（需手動創建）</span></span><br><span class="line">  <span class="comment">#about: /about#關於頁面（需手動創建）</span></span><br><span class="line">  archives: /archives<span class="comment">#歸檔頁</span></span><br><span class="line">  tags: /tags<span class="comment">#標籤頁（需手動創建）</span></span><br><span class="line">  <span class="comment">#commonweal: /404.html        #公益 404 （需手動創建）</span></span><br></pre></td></tr></table></figure><h3 id="標籤雲"><a href="#標籤雲" class="headerlink" title="標籤雲"></a>標籤雲</h3><p>參閱官方<a href="https://github.com/MikeCoder/hexo-tag-cloud/blob/master/README.ZH.md#%E8%87%AA%E5%AE%9A%E4%B9%89" target="_blank" rel="noopener">教學</a><br>進入到 hexo 的根目錄，然後在 package.json 中添加依賴(注意此為 json 格式，最後一個項目以外行尾都要加上“,”): “hexo-tag-cloud”: “2.0.*”<br>然後執行 npm install 命令</p><h4 id="添加在側邊欄"><a href="#添加在側邊欄" class="headerlink" title="添加在側邊欄"></a>添加在側邊欄</h4><h5 id="對於-ejs-的用戶"><a href="#對於-ejs-的用戶" class="headerlink" title="對於 ejs 的用戶"></a>對於 ejs 的用戶</h5><p>這裡以默認主題 landscape 為例。<br>    tagcloud 範本文件為 hexo/themes/landscape/layout/_widget/tagcloud.ejs<br>將這個文件修改為如下內容：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;% <span class="keyword">if</span> (site.tags.length) &#123; %&gt;</span><br><span class="line">    &lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> charset=<span class="string">"utf-8"</span> src=<span class="string">"/js/tagcloud.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> charset=<span class="string">"utf-8"</span> src=<span class="string">"/js/tagcanvas.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;div class=<span class="string">"widget-wrap"</span>&gt;</span><br><span class="line">        &lt;h3 class=<span class="string">"widget-title"</span>&gt;Tag Cloud&lt;/h3&gt;</span><br><span class="line">        &lt;div id=<span class="string">"myCanvasContainer"</span> class=<span class="string">"widget tagcloud"</span>&gt;</span><br><span class="line">            &lt;canvas width=<span class="string">"250"</span> height=<span class="string">"250"</span> id=<span class="string">"resCanvas"</span> style=<span class="string">"width=100%"</span>&gt;</span><br><span class="line">                &lt;%- tagcloud() %&gt;</span><br><span class="line">            &lt;/canvas&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;% &#125; %&gt;</span><br></pre></td></tr></table></figure><p></p><h5 id="對於-swig-用戶"><a href="#對於-swig-用戶" class="headerlink" title="對於 swig 用戶"></a>對於 swig 用戶</h5><p>這裡以 Next 主題為例。<br>找到文件 next/layout/_macro/sidebar.swig, 然後添加如下內容。<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> site.tags.length &gt; 1 %&#125;</span><br><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> charset=<span class="string">"utf-8"</span> src=<span class="string">"/js/tagcloud.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> charset=<span class="string">"utf-8"</span> src=<span class="string">"/js/tagcanvas.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;div class=<span class="string">"widget-wrap"</span>&gt;</span><br><span class="line">    &lt;h3 class=<span class="string">"widget-title"</span>&gt;Tag Cloud&lt;/h3&gt;</span><br><span class="line">    &lt;div id=<span class="string">"myCanvasContainer"</span> class=<span class="string">"widget tagcloud"</span>&gt;</span><br><span class="line">        &lt;canvas width=<span class="string">"250"</span> height=<span class="string">"250"</span> id=<span class="string">"resCanvas"</span> style=<span class="string">"width=100%"</span>&gt;</span><br><span class="line">            &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">        &lt;/canvas&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p></p><h4 id="添加在標籤頁"><a href="#添加在標籤頁" class="headerlink" title="添加在標籤頁"></a>添加在標籤頁</h4><p>以 Next 主題為例。<br>在 Blog\themes\next\layout\page.swig 中，修改並添加以下內容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">if</span> page.type === <span class="string">"tags"</span> %&#125;</span><br><span class="line">  &lt;div class=<span class="string">"tag-cloud"</span>&gt;</span><br><span class="line">    &lt;div class=<span class="string">"tag-cloud-title"</span>&gt;</span><br><span class="line">        &#123;% <span class="built_in">set</span> visibleTags = 0 %&#125;</span><br><span class="line">        &#123;% <span class="keyword">for</span> tag <span class="keyword">in</span> site.tags %&#125;</span><br><span class="line">          &#123;% <span class="keyword">if</span> tag.length %&#125;</span><br><span class="line">            &#123;% <span class="built_in">set</span> visibleTags += 1 %&#125;</span><br><span class="line">          &#123;% endif %&#125;</span><br><span class="line">        &#123;% endfor %&#125;</span><br><span class="line">        &#123;&#123; _p(<span class="string">'counter.tag_cloud'</span>, visibleTags) &#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">   &#123;<span class="comment">#&lt;div class="tag-cloud-tags"&gt;</span></span><br><span class="line">      &#123;&#123; tagcloud(&#123;min_font: 12, max_font: 30, amount: 300, color: <span class="literal">true</span>, start_color: <span class="string">'#ccc'</span>, end_color: <span class="string">'#111'</span>&#125;) &#125;&#125;</span><br><span class="line">    &lt;/div&gt;<span class="comment">#&#125;</span></span><br><span class="line">      </span><br><span class="line">    &#123;% <span class="keyword">if</span> site.tags.length &gt; 1 %&#125;</span><br><span class="line">    &lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> charset=<span class="string">"utf-8"</span> src=<span class="string">"/js/tagcloud.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span> charset=<span class="string">"utf-8"</span> src=<span class="string">"/js/tagcanvas.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">      &lt;div class=<span class="string">"widget-wrap"</span>&gt;</span><br><span class="line">        &lt;div id=<span class="string">"myCanvasContainer"</span> class=<span class="string">"widget tagcloud"</span>&gt;</span><br><span class="line">          &lt;canvas width=<span class="string">"500"</span> height=<span class="string">"500"</span> id=<span class="string">"resCanvas"</span> style=<span class="string">"width=100%"</span>&gt;</span><br><span class="line">            &#123;&#123; list_tags() &#125;&#125;</span><br><span class="line">          &lt;/canvas&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&#123;% <span class="keyword">elif</span> page.type === <span class="string">'categories'</span> %&#125;</span><br></pre></td></tr></table></figure><h4 id="最後一步"><a href="#最後一步" class="headerlink" title="最後一步"></a>最後一步</h4><p>完成安裝和顯示，可以通過 hexo clean &amp;&amp; hexo g &amp;&amp; hexo s 來進行本地預覽, hexo clean 為必須選項。<br>**PS: 不要使用 hexo g -d 或者 hexo d -g 這類組合命令。</p><p>雖然有看到<a href="https://wangwanjie.github.io/2017/03/19/%E4%B8%BA-NexT-%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0%E7%90%83%E5%BD%A2%E6%A0%87%E7%AD%BE%E4%BA%91/" target="_blank" rel="noopener">這則</a> 教學，但測試下失敗了，而同時加入側邊欄和標籤頁的話 Tag 會變兩倍，有空在來想要怎麼解決。</p><h4 id="自定義"><a href="#自定義" class="headerlink" title="自定義"></a>自定義</h4><p>現在 hexo-tag-cloud 插件支援自定義啦。非常簡單的步驟就可以改變你的標籤雲的字體和顏色，還有突出高亮。</p><p>在你的博客根目錄，找到 _config.yml 文件然後添加如下的配置項:<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-tag-cloud</span></span><br><span class="line">tag_cloud:</span><br><span class="line">    textFont: Trebuchet MS, Helvetica</span><br><span class="line">    textColour: \<span class="comment">#333</span></span><br><span class="line">    textHeight: 25</span><br><span class="line">    outlineColour: \<span class="comment">#E2E1D1</span></span><br></pre></td></tr></table></figure><p></p><h3 id="分類頁面"><a href="#分類頁面" class="headerlink" title="分類頁面"></a>分類頁面</h3><p>運行以下命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page <span class="string">"categories"</span></span><br></pre></td></tr></table></figure><p>同時，在 / source 目錄下會生成一個 categories 文件夾，裡面包含一個index.md文件</p><p>修改 / source/categories 目錄下的index.md文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">title: categories</span><br><span class="line">date: 2015-09-29 14:47:21</span><br><span class="line"><span class="built_in">type</span>: <span class="string">"categories"</span></span><br><span class="line">---</span><br></pre></td></tr></table></figure><p>修改主題配置文件<br>去掉 categories 的註釋<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /                       <span class="comment">#主頁</span></span><br><span class="line">  categories: /categories<span class="comment">#分類頁（需手動創建）</span></span><br><span class="line">  <span class="comment">#about: /about#關於頁面（需手動創建）</span></span><br><span class="line">  archives: /archives<span class="comment">#歸檔頁</span></span><br><span class="line">  tags: /tags<span class="comment">#標籤頁（需手動創建）</span></span><br></pre></td></tr></table></figure><p></p><h3 id="側邊欄頭像設置"><a href="#側邊欄頭像設置" class="headerlink" title="側邊欄頭像設置"></a>側邊欄頭像設置</h3><p>編輯站點配置文件，增加 avatar 欄位</p><p>頭像<br>    avatar: /images/avatar.png<br>頭像圖片須放置在主題的 /source/images / 目錄下</p><h3 id="開啟“更新時間”"><a href="#開啟“更新時間”" class="headerlink" title="開啟“更新時間”"></a>開啟“更新時間”</h3><p>在 D:\GitHub\Blog\themes\next_config.yml 中修改以下內容開啟功能：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Post meta display settings</span></span><br><span class="line">post_meta:</span><br><span class="line">  item_text: <span class="literal">true</span></span><br><span class="line">  created_at: <span class="literal">true</span></span><br><span class="line">  updated_at: <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Only show 'updated' if different from 'created'. 當更新時間和創建時間不同時才顯示</span></span><br><span class="line">  updated_diff: <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="修改文章底部的-tag-為-號的標籤"><a href="#修改文章底部的-tag-為-號的標籤" class="headerlink" title="修改文章底部的 tag 為 #號的標籤"></a>修改文章底部的 tag 為 #號的標籤</h3><p>作者：<a href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html" target="_blank" rel="noopener">Moorez</a><br>修改範本/themes/next/layout/_macro/post.swig，搜索 rel=”tag”&gt;#，將 # 換成<i class="fa fa-tag"></i></p><h3 id="文章字數統計"><a href="#文章字數統計" class="headerlink" title="文章字數統計"></a>文章字數統計</h3><p>切換到根目錄下，然後運行如下代碼</p><pre><code>npm install hexo-symbols-count-time --save</code></pre><p>在根目錄下的 _config.yml 加上：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  symbols: <span class="literal">true</span></span><br><span class="line">  time: <span class="literal">true</span></span><br><span class="line">  total_symbols: <span class="literal">true</span></span><br><span class="line">  total_time: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p>在 D:\GitHub\Blog\themes\next_config.yml 中修改以下內容開啟功能：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">symbols_count_time:</span><br><span class="line">  separated_meta: <span class="literal">true</span> <span class="comment">#是否要跳行</span></span><br><span class="line">  item_text_post: <span class="literal">true</span></span><br><span class="line">  item_text_total: <span class="literal">false</span></span><br><span class="line">  awl: 1 <span class="comment">#平均單字長度</span></span><br><span class="line">  wpm: 200 <span class="comment">#每分鐘閱讀速度</span></span><br></pre></td></tr></table></figure><h3 id="設置網站的圖示-Favicon"><a href="#設置網站的圖示-Favicon" class="headerlink" title="設置網站的圖示 Favicon"></a>設置網站的圖示 Favicon</h3><p>具體方法實現<br>在 <a href="https://hk.saowen.com/rd/aHR0cHM6Ly9saW5rLmppYW5zaHUuY29tLz90PWh0dHAlM0ElMkYlMkZ3d3cuZWFzeWljb24ubmV0JTJG" target="_blank" rel="noopener">EasyIcon</a> 中找一張（32*32）的ico圖示, 或者去別的網站下載或者製作，並將圖示名稱改為favicon.ico，然後把圖示放在/themes/next/source/images裡，並且修改主題配置文檔：</p><pre><code># Put your favicon.ico into `hexo-site/source/` directory.favicon: /favicon.ico</code></pre><h3 id="隱藏網頁底部-powered-By-Hexo-強力驅動"><a href="#隱藏網頁底部-powered-By-Hexo-強力驅動" class="headerlink" title="隱藏網頁底部 powered By Hexo / 強力驅動"></a>隱藏網頁底部 powered By Hexo / 強力驅動</h3><p>打開themes/next/layout/_partials/footer.swig, 使用”” 隱藏之間的代碼即可，或者直接刪除。位置搜尋 “powered-by”</p><h3 id="文章加密訪問"><a href="#文章加密訪問" class="headerlink" title="文章加密訪問"></a>文章加密訪問</h3><p>####不用 Plug 的方式<br>作者：<a href="https://www.iots.vip/post/hexo-build-to-optimize.html#%E6%96%87%E7%AB%A0%E5%AF%86%E7%A0%81" target="_blank" rel="noopener">Alliot</a><br>原文<a href="https://blog.paddings.cn/2016/12/01/blog/hexo-password/" target="_blank" rel="noopener">點此</a> 這裡搬運過來做備份 (這種方式是不安全的，詳情請點擊 <a href="https://www.iots.vip/post/hexo-password-crack.html" target="_blank" rel="noopener">hexo 文章密碼訪問的” 破解” 方法</a>)</p><h5 id="head-swig"><a href="#head-swig" class="headerlink" title="head.swig"></a>head.swig</h5><p>找到 themes-&gt;next-&gt;layout-&gt;_partials-&gt;head.swig 文件。添加如下代碼 (推薦加在所有的標籤之後):</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="string">'&#123;&#123; page.password &#125;&#125;'</span>)&#123;</span><br><span class="line"><span class="keyword">if</span> (prompt(<span class="string">'請輸入文章密碼'</span>,<span class="string">''</span>) !== <span class="string">'&#123;&#123; page.password &#125;&#125;'</span>)&#123;</span><br><span class="line">alert(<span class="string">'密碼錯誤！'</span>);</span><br><span class="line">history.back();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h5 id="發文"><a href="#發文" class="headerlink" title="發文"></a>發文</h5><p>發文的時候頂部的頁面變量添加”password: 密碼” 即可，如:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">title: <span class="string">'2017-01-01'</span></span><br><span class="line">permalink: post/111111111.html</span><br><span class="line">tags:</span><br><span class="line">  - TEST</span><br><span class="line">date: 2017-01-01 00:00:00</span><br><span class="line">password: 123</span><br></pre></td></tr></table></figure><h3 id="hexo-blog-encrypt"><a href="#hexo-blog-encrypt" class="headerlink" title="hexo-blog-encrypt"></a>hexo-blog-encrypt</h3><h4 id="安裝"><a href="#安裝" class="headerlink" title="安裝"></a>安裝</h4><p>在 D:\Github\Blog 下，找到 package.json 加上<br>    “hexo-blog-encrypt”: “2.0.”<br>需注意此為 json 格式，除了最後一筆以外都句尾都要有 “ , ”</p><p>在此目錄下，開啟 CMD ，執行<br>    npminstall</p><h4 id="config-yml-1"><a href="#config-yml-1" class="headerlink" title="_config.yml"></a>_config.yml</h4><p>在 D:\Github\Blog 下，修改 _config.yml ，加入以下字句<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Secutity</span></span><br><span class="line">encrypt:</span><br><span class="line">  <span class="built_in">enable</span>:<span class="literal">true</span></span><br></pre></td></tr></table></figure><p></p><p>可在 D:\GitHub\Blog\scaffolds\post.md 下加入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">password: <span class="comment">#密碼</span></span><br><span class="line">abstract: <span class="comment">#加密時顯示在文章列表的摘要</span></span><br></pre></td></tr></table></figure><p>之後只要填寫 password: 後的密碼，該文即會被加密</p><h3 id="動態背景"><a href="#動態背景" class="headerlink" title="動態背景"></a>動態背景</h3><p>參考：<a href="http://www.xudajian.com/2017/07/30/hexo-%E5%8A%A8%E6%80%81%E8%83%8C%E6%99%AF/" target="_blank" rel="noopener">Xujian</a>、<a href="https://github.com/theme-next/theme-next-canvas-nest" target="_blank" rel="noopener">canvas-nest.js for NexT</a></p><h4 id="修改主題配置文件"><a href="#修改主題配置文件" class="headerlink" title="修改主題配置文件"></a>修改主題配置文件</h4><p>在根目錄 blog 中輸入</p><pre><code>git clone https://github.com/theme-next/theme-next-canvas-nest source/lib/canvas-nest</code></pre><p>再開啟主題配置文件，文件位址：blog/theme/next/_config.yml<br>將文件中的 canvas_nest: false 為 canvas_nest: true 即可。</p><h4 id="配置項說明"><a href="#配置項說明" class="headerlink" title="配置項說明"></a>配置項說明</h4><p>若覺得線條太多或想自行設定，可開啟 <code>D:\GitHub\Hexo\ppundsh.github.io\themes\next\source\lib\canvas-nest\canvas-nest.min.js</code> 找到以下參數：<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">z: o(v, <span class="string">"zIndex"</span>, -1), //背景的 z-index 屬性，css 屬性用於控制所在層的位置, 默認: -1</span><br><span class="line">o: o(v, <span class="string">"opacity"</span>, 0.3), //線條透明度（0~1）, 默認: 0.5</span><br><span class="line">c: o(v, <span class="string">"color"</span>, <span class="string">"0,0,0"</span>), //線條顏色, 默認: ‘0,0,0’；三個數字分別為 (R,G,B)</span><br><span class="line">n: o(v, <span class="string">"count"</span>, 70) //線條的總數量, 默認: 150</span><br></pre></td></tr></table></figure><p></p><h3 id="文章下設置版權訊息"><a href="#文章下設置版權訊息" class="headerlink" title="文章下設置版權訊息"></a>文章下設置版權訊息</h3><p>作者：<a href="http://www.crocutax.com/2017/05/20/Hexo%E6%8C%81%E7%BB%AD%E4%BC%98%E5%8C%96-%E5%9C%A8%E6%96%87%E7%AB%A0%E5%B0%BE%E9%83%A8%E6%B7%BB%E5%8A%A0%E7%89%88%E6%9D%83%E5%A3%B0%E6%98%8E%E4%BF%A1%E6%81%AF/" target="_blank" rel="noopener">Crocutax</a></p><p>Hexo+NexT 主題，主題默認的版權聲明配置在themes\next_config.yml文件中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Declare license on posts</span></span><br><span class="line">post_copyright:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">false</span></span><br><span class="line">  license: CC BY-NC-SA 3.0</span><br><span class="line">  license_url: https://creativecommons.org/licenses/by-nc-sa/3.0/</span><br></pre></td></tr></table></figure><p>直接把enable 改為true即可開啟。</p><p>進階自定作法請參閱原文。</p><h2 id="SEO-優化"><a href="#SEO-優化" class="headerlink" title="SEO 優化"></a>SEO 優化</h2><p>為了讓搜尋影擎更方便索引，可以有以下設置。</p><h3 id="站點地圖"><a href="#站點地圖" class="headerlink" title="站點地圖"></a>站點地圖</h3><p>作者：<a href="http://zhy.one/html/hexo-generator-sitemap-baidusitemap.html" target="_blank" rel="noopener">姜正宏的網路日誌</a>、<a href="http://zhy.one/html/hexo-generator-sitemap-baidusitemap.html" target="_blank" rel="noopener">際富</a><br>可以方便搜尋影擎索引</p><h4 id="安裝插件"><a href="#安裝插件" class="headerlink" title="安裝插件"></a>安裝插件</h4><p>安裝 google sitemap</p><pre><code>npm install hexo-generator-sitemap --save</code></pre><p>安裝百度 sitemap</p><pre><code>npm install hexo-generator-baidu-sitemap --save</code></pre><p>修改站點_config.yml 文件<br>增加以下內容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sitemap:</span><br><span class="line">    path: sitemap.xml</span><br><span class="line">baidusitemap:</span><br><span class="line">    path: baidusitemap.xml</span><br></pre></td></tr></table></figure><p>注意縮進。</p><p>執行hexo g後，public 目錄下就會生成 sitemap.xml 和 baidusitemap.xml 兩個文件了。</p><h3 id="在-Google-站點工具設置"><a href="#在-Google-站點工具設置" class="headerlink" title="在 Google 站點工具設置"></a>在 Google 站點工具設置</h3><p>個人使用 google 推薦的方試一直失敗，參考此文後能成功<br>作者: <a href="https://github.com/iissnan/hexo-theme-next/wiki/%E6%B7%BB%E5%8A%A0-Google-Webmaster-tools-%E9%AA%8C%E8%AF%81" target="_blank" rel="noopener">iissnan</a><br>設置 <a href="https://www.google.com/webmasters/tools/" target="_blank" rel="noopener">Google 站點管理工具</a> 的驗證字串，用於提交 sitemap</p><h3 id="獲取-google-site-verification-code"><a href="#獲取-google-site-verification-code" class="headerlink" title="獲取 google site verification code"></a>獲取 google site verification code</h3><p>登錄 Google Webmaster Tools，導航到驗證方法，並選擇 HTML Tag。將會獲取到一段代碼：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=<span class="string">"google-site-verification"</span> content=<span class="string">"XXXXXXXXXXXXXXXXXXXXXXX"</span> /&gt;</span><br></pre></td></tr></table></figure><p>將 content 裡面的 XXXXXXXXXXXXXXXXXXXXXXX 複製出來。</p><h3 id="設置主題"><a href="#設置主題" class="headerlink" title="設置主題"></a>設置主題</h3><p>編輯站點的 _config.yml，新增欄位 google_site_verification</p><pre><code>google_site_verification: XXXXXXXXXXXXXXXXXXXXXXX</code></pre><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="壓縮代碼加速載入"><a href="#壓縮代碼加速載入" class="headerlink" title="壓縮代碼加速載入"></a>壓縮代碼加速載入</h3><p>在生成時會慢一點，但可以加速載入<br>CMD 進入博客根目錄，執行以下命令</p><pre><code>npm install hexo-neat --save</code></pre><p>打開站點配置文件_config.yml，添加以下內容：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#hexo-neat 加速</span></span><br><span class="line">neat_enable: <span class="literal">true</span></span><br><span class="line">neat_html:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  exclude:</span><br><span class="line">  </span><br><span class="line">neat_css:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  exclude:</span><br><span class="line">    - <span class="string">'*.min.css'</span></span><br><span class="line">neat_js:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  mangle: <span class="literal">true</span></span><br><span class="line">  output:</span><br><span class="line">  compress:</span><br><span class="line">  exclude:</span><br><span class="line">    - <span class="string">'*.min.js'</span></span><br></pre></td></tr></table></figure><h3 id="圖片沿後載入來加速頁面載入速度"><a href="#圖片沿後載入來加速頁面載入速度" class="headerlink" title="圖片沿後載入來加速頁面載入速度"></a>圖片沿後載入來加速頁面載入速度</h3><p>作者  <sup id="fnref:21"><a href="#fn:21" rel="footnote">21</a></sup></p><blockquote><p>圖片懶載入是提升網站性能和用戶體驗的一個非常很好方式，並且幾乎所有的大型網站都使用到了，比如微博，僅把用戶可見的部分顯示圖片，其餘的都暫時不載入，做法就是：讓所有圖片元素 src 指向一個小的站位圖片比如 loading，並新增一個屬性 (如 data-original) 存放真實圖片位址。每當頁面載入（或者卷軸滾動），使用 JS 腳本將可視區域內的圖片 src 替換回真實位址，並做請求重新載入。</p></blockquote><p>安裝步驟：<br>    npm install hexo-lazyload-image –save<br>然後修改 _config.yml 文件<br></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">lazyload:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span> </span><br><span class="line">  onlypost: <span class="literal">false</span></span><br><span class="line">  loadingImg: <span class="comment"># eg. ./images/loading.png</span></span><br></pre></td></tr></table></figure><p></p><h2 id="參考網址"><a href="#參考網址" class="headerlink" title="參考網址"></a>參考網址</h2><p><a href="https://lyyybz.github.io/blog/2016/12/15/Hexo-%E6%9E%84%E5%BB%BA%E5%8D%9A%E5%AE%A2%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener">Hexo - 構建博客詳解</a></p><p><a href="https://xuanwo.org/2015/03/26/hexo-intor/" target="_blank" rel="noopener">史上最詳細的 Hexo 博客搭建圖文教程</a></p><p><a href="http://www.lovebxm.com/2017/05/30/buildBlog/" target="_blank" rel="noopener">可能是最詳細的 Hexo + GitHub Pages 搭建博客的教程</a></p><p><a href="https://kingofamani.gitbooks.io/git-teach/content/chapter_5/github.html" target="_blank" rel="noopener">GitHub 建立遠端儲存庫</a></p><p><a href="https://gist.github.com/uolcano/70c3926a4716759ec6599f444a172e64" target="_blank" rel="noopener">Gist 是 GitHub 推出的一款類似於 Pastebin 的代碼片段託管服務</a></p><p><a href="https://www.jianshu.com/p/0205eb64a275" target="_blank" rel="noopener">Hexo 構建博客詳解</a></p><p><a href="https://zhiho.github.io/2015/09/29/hexo-next/" target="_blank" rel="noopener">Hexo 搭建 GitHub 博客（三）- NexT 主題配置使用</a></p><p><a href="https://asdfv1929.github.io/2018/01/20/gitalk/" target="_blank" rel="noopener">Hexo NexT 主題中集成 gitalk 評論系統</a></p><p><a href="https://qhh0205.github.io/2018/03/25/hexo-next-%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AEgitalk%E8%AF%84%E8%AE%BA-%E7%88%AC%E5%9D%91%E8%AE%B0/" target="_blank" rel="noopener">hexo-next - 主題配置 gitalk 評論 - 爬坑記</a></p><p><a href="http://qiubaiying.top/2017/12/19/%E4%B8%BA%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0-Gitalk-%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6/" target="_blank" rel="noopener">為博客添加 Gitalk 評論插件</a></p><p><a href="http://www.whtis.com/2017/10/19/%E7%BB%99hexo%E5%8D%9A%E5%AE%A2nexT%E4%B8%BB%E9%A2%98%E6%B7%BB%E5%8A%A0Gitalk%E8%AF%84%E8%AE%BA%E7%B3%BB%E7%BB%9F/" target="_blank" rel="noopener">給 hexo 博客 nexT 主題添加 Gitalk 評論系統</a></p><p><a href="http://zhy.one/html/hexo-generator-sitemap-baidusitemap.html" target="_blank" rel="noopener">給 hexo 添加 sitemap 和 baidusitemap 站點地圖功能</a></p><p><a href="https://www.xbug.me/post/2018-03-27-add-sitemap.html" target="_blank" rel="noopener">添加站點地圖</a></p><p><a href="http://qiubaiying.top/2017/02/06/%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/" target="_blank" rel="noopener">快速搭建個人博客</a></p><p><a href="http://www.xudajian.com/2017/07/30/hexo-%E5%8A%A8%E6%80%81%E8%83%8C%E6%99%AF/" target="_blank" rel="noopener">使用 hexo 的 next 主題如何添加動態背景</a></p><p><a href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html" target="_blank" rel="noopener">hexo的next主题个性化配置教程</a></p><p><a href="https://www.iots.vip/post/hexo-build-to-optimize.html#%E6%96%87%E7%AB%A0%E5%AF%86%E7%A0%81" target="_blank" rel="noopener">hexo 的搭建、設置與部分優化</a></p><p><a href="https://charlottehong.blogspot.com/2017/07/markdown-hackmd-github.html" target="_blank" rel="noopener">Markdown HackMD Github 同一頁文內跳轉</a></p><p><a href="https://github.com/iissnan/hexo-theme-next/wiki/%E6%B7%BB%E5%8A%A0-Google-Webmaster-tools-%E9%AA%8C%E8%AF%81" target="_blank" rel="noopener">添加 Google Webmaster tools 驗證</a></p><p><a href="http://godlikemeteor.com/2017/07/20/Hexo%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E6%94%BB%E7%95%A5%EF%BC%88%E4%BA%8C%EF%BC%89%EF%BC%9A%E8%BF%9B%E9%98%B6%E7%AF%87/" target="_blank" rel="noopener">Hexo 博客搭建攻略（二）：進階篇</a></p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none;padding-left:0"><li id="fn:1"><span style="display:inline-block;vertical-align:top;padding-right:10px">1.</span><span style="display:inline-block;vertical-align:top">注解1</span><br></li></ol></div></div></escape></span></pre></td></tr></table></figure><a href="#fnref:1" rev="footnote">↩</a><li id="fn:21"><span style="display:inline-block;vertical-align:top;padding-right:10px">21.</span><span style="display:inline-block;vertical-align:top"><a href="https://troyyang.com/2017/08/06/hexo-lazyload-image/" target="_blank" rel="noopener">Hexo-lazyload-image 圖片懶載入</a></span><a href="#fnref:21" rev="footnote"> ↩</a></li><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;作為第一篇記錄，圖片等之後確認圖床再補上。&lt;br&gt;官網 &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://hexo.io/&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://ppundsh.github.io/tags/Hexo/"/>
    
      <category term="Git" scheme="https://ppundsh.github.io/tags/Git/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://ppundsh.github.io/2018-04-08/hello-world/"/>
    <id>https://ppundsh.github.io/2018-04-08/hello-world/</id>
    <published>2018-04-08T15:05:25.391Z</published>
    <updated>2018-04-10T19:24:36.207Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p><p><a href="https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet" target="_blank" rel="noopener">Markdown</a></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Mon Apr 16 2018 06:50:34 GMT+0800 (台北標準時間) --&gt;&lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/
      
    
    </summary>
    
    
  </entry>
  
</feed>
