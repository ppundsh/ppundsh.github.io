<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Flymia 凡事用心之事</title>
  
  <subtitle>科技、藝術、工藝</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://ppundsh.github.io/"/>
  <updated>2018-04-27T06:44:48.752Z</updated>
  <id>https://ppundsh.github.io/</id>
  
  <author>
    <name>Flymia</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo 文章編輯技巧-流程圖、按扭、分頁、小圖示</title>
    <link href="https://ppundsh.github.io/posts/cdf3/"/>
    <id>https://ppundsh.github.io/posts/cdf3/</id>
    <published>2018-04-26T17:02:08.000Z</published>
    <updated>2018-04-27T06:44:48.752Z</updated>
    
    <content type="html"><![CDATA[<p>筆記一下，過去沒用過的功能用法<br><a id="more"></a></p><h1 id="流程圖"><a href="#流程圖" class="headerlink" title="流程圖"></a>流程圖</h1><p>官網<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>需要安裝插件</p><figure class="highlight plain"><div class="figcode"><div class="gutter"><pre><div class="line">1</div></pre></div><div class="code"><pre><div class="line">npm install --save hexo-filter-flowchart</div></pre></div></div></figure><p>線上測試 <a href="http://flowchart.js.org/" rel="external nofollow noopener noreferrer" target="_blank">flowchart.js</a> 貼一下官方的範例：<br>目前暫無法成功。</p><h1 id="按扭"><a href="#按扭" class="headerlink" title="按扭"></a>按扭</h1><p>參考資料<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></div><div class="code"><pre><div class="line">Usage: &#123;% button /path/to/url/, text, icon [class], title %&#125;</div><div class="line">Alias: &#123;% btn /path/to/url/, text, icon [class], title %&#125;</div></pre></div></div></figure><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div></pre></div><div class="code"><pre><div class="line">&#123;% button <span class="comment">#, Text %&#125;&#123;% btn #,, home fa-lg %&#125;&#123;% btn #,, home %&#125;</span></div></pre></div></div></figure><a class="btn" href="#">Text</a><a class="btn" href="#"><i class="fa fa-home fa-lg"></i></a><a class="btn" href="#"><i class="fa fa-home"></i></a><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div></pre></div><div class="code"><pre><div class="line">&#123;% btn <span class="comment">#,, home fa-4x %&#125;</span></div></pre></div></div></figure><a class="btn" href="#"><i class="fa fa-home fa-4x"></i></a><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></div><div class="code"><pre><div class="line">&#123;% btn <span class="comment">#, Text &amp; Icon (buggy), home %&#125;</span></div><div class="line">&#123;% btn <span class="comment">#, Text &amp; Large Icon, home fa-fw fa-lg %&#125;</span></div></pre></div></div></figure><a class="btn" href="#"><i class="fa fa-home"></i>Text & Icon (buggy)</a><a class="btn" href="#"><i class="fa fa-home fa-fw fa-lg"></i>Text & Large Icon</a><h1 id="分頁"><a href="#分頁" class="headerlink" title="分頁"></a>分頁</h1><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></div><div class="code"><pre><div class="line">&#123;% tabs First unique name %&#125;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 1.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 2.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 3.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&#123;% endtabs %&#125;</div></pre></div></div></figure><h2 id="Tab-tag-simple-sample"><a href="#Tab-tag-simple-sample" class="headerlink" title="Tab tag simple sample"></a>Tab tag simple sample</h2><div class="tabs" id="first-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#first-unique-name-1">First unique name 1</a></li><li class="tab"><a href="#first-unique-name-2">First unique name 2</a></li><li class="tab"><a href="#first-unique-name-3">First unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="first-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="first-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="first-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div><h2 id="Tab-tag-with-3rd-tab-selected"><a href="#Tab-tag-with-3rd-tab-selected" class="headerlink" title="Tab tag with 3rd tab selected"></a>Tab tag with 3rd tab selected</h2><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></div><div class="code"><pre><div class="line">&#123;% tabs Second unique name, 3 %&#125;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 1.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 2.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 3.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&#123;% endtabs %&#125;</div></pre></div></div></figure><div class="tabs" id="second-unique-name"><ul class="nav-tabs"><li class="tab"><a href="#second-unique-name-1">Second unique name 1</a></li><li class="tab"><a href="#second-unique-name-2">Second unique name 2</a></li><li class="tab active"><a href="#second-unique-name-3">Second unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane" id="second-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="second-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane active" id="second-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div><h2 id="Tab-tag-with-no-tab-selected"><a href="#Tab-tag-with-no-tab-selected" class="headerlink" title="Tab tag with no tab selected"></a>Tab tag with no tab selected</h2><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></div><div class="code"><pre><div class="line">&#123;% tabs Third unique name, -1 %&#125;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 1.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 2.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab --&gt;</div><div class="line">**This is Tab 3.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&#123;% endtabs %&#125;</div></pre></div></div></figure><div class="tabs" id="third-unique-name"><ul class="nav-tabs"><li class="tab"><a href="#third-unique-name-1">Third unique name 1</a></li><li class="tab"><a href="#third-unique-name-2">Third unique name 2</a></li><li class="tab"><a href="#third-unique-name-3">Third unique name 3</a></li></ul><div class="tab-content"><div class="tab-pane" id="third-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="third-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="third-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div><h2 id="Tab-tag-with-custom-labels"><a href="#Tab-tag-with-custom-labels" class="headerlink" title="Tab tag with custom labels"></a>Tab tag with custom labels</h2><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></div><div class="code"><pre><div class="line">&#123;% tabs Fourth unique name %&#125;</div><div class="line">&lt;!-- tab Solution 1 --&gt;</div><div class="line">**This is Tab 一.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab Solution 2 --&gt;</div><div class="line">**This is Tab 二.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab Solution 3 --&gt;</div><div class="line">**This is Tab 三.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&#123;% endtabs %&#125;</div></pre></div></div></figure><div class="tabs" id="fourth-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#fourth-unique-name-1">Solution 1</a></li><li class="tab"><a href="#fourth-unique-name-2">Solution 2</a></li><li class="tab"><a href="#fourth-unique-name-3">Solution 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="fourth-unique-name-1"><p><strong>This is Tab 一.</strong></p></div><div class="tab-pane" id="fourth-unique-name-2"><p><strong>This is Tab 二.</strong></p></div><div class="tab-pane" id="fourth-unique-name-3"><p><strong>This is Tab 三.</strong></p></div></div></div><h2 id="Tab-tag-with-icons-only"><a href="#Tab-tag-with-icons-only" class="headerlink" title="Tab tag with icons only"></a>Tab tag with icons only</h2><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></div><div class="code"><pre><div class="line">&#123;% tabs Fifth unique name %&#125;</div><div class="line">&lt;!-- tab @text-width --&gt;</div><div class="line">**This is Tab 1.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab @amazon --&gt;</div><div class="line">**This is Tab 2.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab @bold --&gt;</div><div class="line">**This is Tab 3.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&#123;% endtabs %&#125;</div></pre></div></div></figure><div class="tabs" id="fifth-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#fifth-unique-name-1"><i class="fa fa-text-width" style="text-align: center;"></i></a></li><li class="tab"><a href="#fifth-unique-name-2"><i class="fa fa-amazon" style="text-align: center;"></i></a></li><li class="tab"><a href="#fifth-unique-name-3"><i class="fa fa-bold" style="text-align: center;"></i></a></li></ul><div class="tab-content"><div class="tab-pane active" id="fifth-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="fifth-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="fifth-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div><h2 id="Tab-tag-with-icons-and-labels"><a href="#Tab-tag-with-icons-and-labels" class="headerlink" title="Tab tag with icons and labels"></a>Tab tag with icons and labels</h2><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></div><div class="code"><pre><div class="line">&#123;% tabs Sixth unique name %&#125;</div><div class="line">&lt;!-- tab Solution 1@text-width --&gt;</div><div class="line">**This is Tab 1.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab Solution 2@amazon --&gt;</div><div class="line">**This is Tab 2.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&lt;!-- tab Solution 3@bold --&gt;</div><div class="line">**This is Tab 3.**</div><div class="line">&lt;!-- endtab --&gt;</div><div class="line">&#123;% endtabs %&#125;</div></pre></div></div></figure><div class="tabs" id="sixth-unique-name"><ul class="nav-tabs"><li class="tab active"><a href="#sixth-unique-name-1"><i class="fa fa-text-width" "=""></i>Solution 1</a></li><li class="tab"><a href="#sixth-unique-name-2"><i class="fa fa-amazon" "=""></i>Solution 2</a></li><li class="tab"><a href="#sixth-unique-name-3"><i class="fa fa-bold" "=""></i>Solution 3</a></li></ul><div class="tab-content"><div class="tab-pane active" id="sixth-unique-name-1"><p><strong>This is Tab 1.</strong></p></div><div class="tab-pane" id="sixth-unique-name-2"><p><strong>This is Tab 2.</strong></p></div><div class="tab-pane" id="sixth-unique-name-3"><p><strong>This is Tab 3.</strong></p></div></div></div><h2 id="小圖示"><a href="#小圖示" class="headerlink" title="小圖示"></a>小圖示</h2><p>用法來源<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>，可以看官網的範例，更多圖示可去官網找<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup></p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">&lt;i class=<span class="string">"fa fa-pencil"</span>&gt;&lt;/i&gt; 鉛筆</div><div class="line">&lt;i class=<span class="string">"fa fa-cloud-upload"</span>&gt;&lt;/i&gt; 上傳</div><div class="line">&lt;i class=<span class="string">"fa fa-download"</span>&gt;&lt;/i&gt; 下載</div></pre></div></div></figure><p><i class="fa fa-pencil"></i> 鉛筆<br><i class="fa fa-cloud-upload"></i> 上傳<br><i class="fa fa-download"></i> 下載</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">&lt;i class=<span class="string">"fa fa-download"</span>&gt;&lt;/i&gt; 下載</div><div class="line">&lt;i class=<span class="string">"fa fa-download fa-lg"</span>&gt;&lt;/i&gt; 下載變大 33%</div><div class="line">&lt;i class=<span class="string">"fa fa-download fa-2x"</span>&gt;&lt;/i&gt; 下載兩倍大</div></pre></div></div></figure><p><i class="fa fa-download"></i> 下載<br><i class="fa fa-download fa-lg"></i> 下載變大 33%<br><i class="fa fa-download fa-2x"></i> 下載兩倍大</p><h3 id="Bordered-amp-Pulled-Icons"><a href="#Bordered-amp-Pulled-Icons" class="headerlink" title="Bordered &amp; Pulled Icons"></a>Bordered &amp; Pulled Icons</h3><p>Use <code>fa-border</code> and <code>fa-pull-right</code> or <code>fa-pull-left</code> for easy pull quotes or article icons.</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">&lt;i class=<span class="string">"fas fa-quote-left fa-2x fa-pull-left fa-border"</span>&gt;&lt;/i&gt;</div><div class="line">Gatsby believed <span class="keyword">in</span> the green light, the orgastic future that year by year recedes before us.</div><div class="line">It eluded us <span class="keyword">then</span>, but that’s no matter — tomorrow we will run faster, stretch our arms further...</div><div class="line">And one fine morning — So we beat on, boats against the current, borne back ceaselessly into the past.</div></pre></div></div></figure><p><i class="fas fa-quote-left fa-2x fa-pull-left fa-border"></i><br>Gatsby believed in the green light, the orgastic future that year by year recedes before us.<br>It eluded us then, but that’s no matter — tomorrow we will run faster, stretch our arms further…<br>And one fine morning — So we beat on, boats against the current, borne back ceaselessly into the past.</p><h3 id="Animated-Icons"><a href="#Animated-Icons" class="headerlink" title="Animated Icons"></a>Animated Icons</h3><p>Use the <code>fa-spin</code> class to get any icon to rotate, and use <code>fa-pulse</code> to have it rotate with 8 steps. Works especially well with <code>fa-spinner</code> &amp; everything in the <a href="https://fontawesome.com/icons?c=spinners" rel="external nofollow noopener noreferrer" target="_blank">spinner icons category</a>.</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">&lt;div class=<span class="string">"fa-3x"</span>&gt;</div><div class="line">  &lt;i class=<span class="string">"fa fa-cog fa-spin"</span>&gt;&lt;/i&gt;</div><div class="line">  &lt;i class=<span class="string">"fa fa-spinner fa-pulse"</span>&gt;&lt;/i&gt;</div><div class="line">&lt;/div&gt;</div></pre></div></div></figure><div class="fa-3x"><br>  <i class="fa fa-cog fa-spin"></i><br>  <i class="fa fa-spinner fa-pulse"></i><br></div><h3 id="Masking"><a href="#Masking" class="headerlink" title="Masking"></a>Masking</h3><p>Inner Icon (cut out)：Set using typical <code>class</code> attribute. Transform using any <code>data-fa-transform</code> properties.<br>Outer Icon：Set using <code>data-fa-mask</code> attribute.</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">&lt;div class=<span class="string">"fa-4x"</span>&gt;</div><div class="line">  &lt;i class=<span class="string">"fa fa-facebook-f"</span> data-fa-transform=<span class="string">"shrink-3.5 down-1.6 right-1.25"</span> data-fa-mask=<span class="string">"fa fa-circle"</span> style=<span class="string">"background:MistyRose"</span>&gt;&lt;/i&gt;</div><div class="line">  &lt;i class=<span class="string">"fa fa-headphones"</span> data-fa-transform=<span class="string">"shrink-6"</span> data-fa-mask=<span class="string">"fa fa-square"</span> style=<span class="string">"background:MistyRose"</span>&gt;&lt;/i&gt;</div><div class="line">&lt;/div&gt;</div></pre></div></div></figure><div class="fa-4x"><br>  <i class="fa fa-facebook-f" data-fa-transform="shrink-3.5 down-1.6 right-1.25" data-fa-mask="fa fa-circle" style="background:MistyRose"></i><br>  <i class="fa fa-headphones" data-fa-transform="shrink-6" data-fa-mask="fa fa-square" style="background:MistyRose"></i><br></div><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://github.com/bubkoo/hexo-filter-flowchart" rel="external nofollow noopener noreferrer" target="_blank"> hexo-filter-flowchart </a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="https://almostover.ru/2016-01/hexo-theme-next-test" rel="external nofollow noopener noreferrer" target="_blank"> Hexo Theme Next Test </a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://reuixiy.github.io/technology/computer/computer-aided-art/2017/06/09/hexo-next-optimization.html#%E5%A5%BD%E7%8E%A9%E7%9A%84%E5%86%99%E4%BD%9C%E6%A0%B7%E5%BC%8F" rel="external nofollow noopener noreferrer" target="_blank"> 打造個性超贊博客Hexo+NexT+GithubPages的超深度優化 </a></span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;"><a href="https://fontawesome.com/icons?d=gallery" rel="external nofollow noopener noreferrer" target="_blank"> Font Awesome </a></span><a href="#fnref:4" rev="footnote"> ↩</a></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">5.</span><span style="display: inline-block; vertical-align: top;"><a href="https://fontawesome.com/how-to-use/svg-with-js" rel="external nofollow noopener noreferrer" target="_blank"> SVG with JavaScript </a></span><a href="#fnref:5" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;筆記一下，過去沒用過的功能用法&lt;br&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://ppundsh.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>Hexo 使用 imgur 圖床跟並列顯示圖片</title>
    <link href="https://ppundsh.github.io/posts/cb53/"/>
    <id>https://ppundsh.github.io/posts/cb53/</id>
    <published>2018-04-26T16:10:49.000Z</published>
    <updated>2018-04-26T16:54:55.485Z</updated>
    
    <content type="html"><![CDATA[<p>Github 提供 1GB 的免費空間<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>，個人認為圖片或多媒體資源應該要另外存放才對。<br>以下記錄 imgur 的用法以及讓圖片並晚顯示的方法。<br><a id="more"></a></p><h1 id="imgur-作為圖床"><a href="#imgur-作為圖床" class="headerlink" title="imgur 作為圖床"></a>imgur 作為圖床</h1><p>文章來源<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br>imgur 的優點：</p><ol><li>圖片不會被刪除，即使瀏覽量很低 [1]</li><li>桌面版可以使用 Chrome 的 <a href="https://chrome.google.com/webstore/detail/imgur-extension-by-metron/ehoopddfhgaehhmphfcooacjdpmbjlao" rel="external nofollow noopener noreferrer" target="_blank">Extension</a>，可支援直接 copy &amp; paste 跟拖拉上傳。</li><li>預設圖片上傳都是私密的，除非知道圖片網址，否則無法瀏覽</li><li>可以直接用網址來控制圖片的大小</li><li>完全免費</li></ol><p>目前 imgur 支援六種不同尺寸的縮圖:</p><table><thead><tr><th>Thumbnail Suffix</th><th>Thumbnail Name</th><th>Thumbnail Size</th><th>Keeps Image Proportions</th></tr></thead><tbody><tr><td>s</td><td>Small Square</td><td>90x90</td><td>No</td></tr><tr><td>b</td><td>Big Square</td><td>160x160</td><td>No</td></tr><tr><td>t</td><td>Small Thumbnail</td><td>160x160</td><td>Yes</td></tr><tr><td>m</td><td>Medium Thumbnail</td><td>320x320</td><td>Yes</td></tr><tr><td>l</td><td>Large Thumbnail</td><td>640x640</td><td>Yes</td></tr><tr><td>h</td><td>Huge Thumbnail</td><td>1024x1024</td><td>Yes</td></tr></tbody></table><p>For example,the image located at http:\//i.imgur.com/12345.jpg has the Medium Thumbnail located at http:\//i.imgur.com/12345<code>m</code>.jpg</p><h1 id="圖片並列顯示"><a href="#圖片並列顯示" class="headerlink" title="圖片並列顯示"></a>圖片並列顯示</h1><p>在內文要有效果要，要先修改一下<code>themes\next\source\css\_common\components\tags\group-pictures.styl</code>文件，註解或刪除其中兩項。</p><figure class="highlight plain"><figcaption><span class="fileDir">file:~themes\next\source\css\_common\components\tags\</span><span class="caption">group-pictures</span><span class="suffix">.styl</span></figcaption><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></div><div class="code"><pre><div class="line">.page-post-detail .post-body .group-picture-column &#123;</div><div class="line marked">  // float: none;</div><div class="line">  margin-top: 10px;</div><div class="line marked">  // width: auto !important;</div><div class="line">  img &#123; margin: 0 auto; &#125;</div><div class="line">&#125;</div></pre></div></div></figure><p>要隱藏首頁的標題列只顯示圖的話，文章的 Header 要加入 <code>type: &quot;picture&quot;</code>，如下範例</p><figure class="highlight plain"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></div><div class="code"><pre><div class="line">---</div><div class="line">title:</div><div class="line">tags:</div><div class="line">date:</div><div class="line marked">type: &quot;picture&quot;</div><div class="line">password:</div><div class="line">abstract:</div><div class="line">---</div></pre></div></div></figure><p>然後在內文中使用</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></div><div class="code"><pre><div class="line">&#123;% gp 5-3 %&#125;</div><div class="line">![](/images/post/18210.jpg)</div><div class="line">![](/images/post/196232.jpg)</div><div class="line">![](/images/post/224147.jpg)</div><div class="line">![](/images/post/199301.jpg)</div><div class="line">![](/images/post/213318.jpg)</div><div class="line">&#123;% endgp %&#125;</div></pre></div></div></figure><p>另外{\% gp 5-3 \%}：設置圖片展示效果，參考 theme/next/scripts/tags/group-pictures.js 註釋示意圖 , 如下。</p><figure class="highlight bash"><figcaption><span class="caption"> </span></figcaption><div class="figcode"><div class="code"><pre><div class="line"> * 2-1</div><div class="line"> *</div><div class="line"> *  □</div><div class="line"> *  □</div><div class="line">/**</div><div class="line"> * 2-2</div><div class="line"> *</div><div class="line"> * □ □</div><div class="line">/**</div><div class="line"> * 3-1</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 3-2</div><div class="line"> *</div><div class="line"> *  □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 3-3</div><div class="line"> *</div><div class="line"> * □ □</div><div class="line"> *  □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 4-1</div><div class="line"> *</div><div class="line"> *  □</div><div class="line"> * □ □</div><div class="line"> *  □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 4-2</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 4-3</div><div class="line"> *</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 4-4</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *   □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 5-1</div><div class="line"> *</div><div class="line"> *  □</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 5-2</div><div class="line"> *</div><div class="line"> * □ □</div><div class="line"> *  □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 5-3</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 5-4</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 6-1</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 6-2</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 6-3</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 6-4</div><div class="line"> *</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 6-5</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 7-1</div><div class="line"> *</div><div class="line"> *  □</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 7-2</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 7-3</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 7-4</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 7-5</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 8-1</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 8-2</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 8-3</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line">/**</div><div class="line"> * 8-4</div><div class="line"> *</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> * □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 8-5</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 8-6</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 8-7</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-1</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-2</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-3</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-4</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-5</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-6</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 9-7</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-1</div><div class="line"> *</div><div class="line"> *   □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-2</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-3</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-4</div><div class="line"> *</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-5</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-6</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * 10-7</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> *  □ □</div><div class="line"> *  □ □</div><div class="line"> *</div><div class="line">/**</div><div class="line"> * Defaults Layout</div><div class="line"> *</div><div class="line"> * □ □ □</div><div class="line"> * □ □ □</div><div class="line"> * ...</div></pre></div></div></figure><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://stackoverflow.com/questions/28706454/github-pages-site-size-limits" rel="external nofollow noopener noreferrer" target="_blank">Github pages site size limits?</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="使用 imgur 來當 blog 圖床">使用 imgur 來當 blog 圖床</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://ehlxr.me/2016/08/30/%E4%BD%BF%E7%94%A8Hexo%E5%9F%BA%E4%BA%8EGitHub-Pages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%EF%BC%88%E4%B8%89%EF%BC%89/#%E5%85%AB%E3%80%81%E5%9B%BE%E7%89%87%E6%A8%A1%E5%BC%8F" rel="external nofollow noopener noreferrer" target="_blank">使用Hexo基于GitHub-Pages搭建个人博客（三）/#八、图片模式</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Github 提供 1GB 的免費空間&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;，個人認為圖片或多媒體資源應該要另外存放才對。&lt;br&gt;以下記錄 imgur 的用法以及讓圖片並晚顯示的方法。&lt;br&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://ppundsh.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>在 Hexo new 時自動用 VS Code 開啟新建文章</title>
    <link href="https://ppundsh.github.io/posts/c073/"/>
    <id>https://ppundsh.github.io/posts/c073/</id>
    <published>2018-04-26T15:16:11.000Z</published>
    <updated>2018-04-26T16:53:39.816Z</updated>
    
    <content type="html"><![CDATA[<p>讓煩瑣的動作再少一點。<br><a id="more"></a></p><h2 id="系統路徑"><a href="#系統路徑" class="headerlink" title="系統路徑"></a>系統路徑</h2><p>本文參考來源<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>Visual Studio Code 安裝時要勾選<code>添加到 PATCH</code><br>如果是免安裝版的，請輸入 <code>Win+R</code> 叫出執行，再輸入<code>sysdm.cpl</code>，到<code>進階→環境變數</code>中，編輯<code>Path</code>，將 VS code 的資料夾路徑也加入。</p><div class="group-picture"><div class="group-picture-container"><div class="group-picture-row"><div class="group-picture-column" style="width: 50%;"><img src="https://i.imgur.com/tWmI9Sc.png" alt="添加 PATCH"></div><div class="group-picture-column" style="width: 50%;"><img src="https://i.imgur.com/XquQujU.png" alt="添加 PATCH2"></div></div><div class="group-picture-row"></div></div></div><h2 id="自動打開編輯器腳本"><a href="#自動打開編輯器腳本" class="headerlink" title="自動打開編輯器腳本"></a>自動打開編輯器腳本</h2><p>在 Blog 根目錄下新建 /scripts/AutoOpenEditor.js 文件（取其他名字也可以，不影響），並加入以下代碼。</p><figure class="highlight plain"><figcaption><span class="fileDir">file:~/scripts/</span><span class="caption">AutoOpenEditor</span><span class="suffix">.js</span></figcaption><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></div><div class="code"><pre><div class="line">let spawn = require(&apos;hexo-util/lib/spawn&apos;);</div><div class="line"></div><div class="line">hexo.on(&apos;new&apos;, (data) =&gt; &#123;</div><div class="line">  spawn(&apos;code&apos;, [hexo.base_dir, data.path]);</div><div class="line">&#125;);</div></pre></div></div></figure><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://leaferx.online/2018/03/17/hexo-auto-open-vscode/" rel="external nofollow noopener noreferrer" target="_blank">https://leaferx.online/2018/03/17/hexo-auto-open-vscode/</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;讓煩瑣的動作再少一點。&lt;br&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://ppundsh.github.io/tags/Hexo/"/>
    
      <category term="VS code" scheme="https://ppundsh.github.io/tags/VS-code/"/>
    
  </entry>
  
  <entry>
    <title>HEXO添加複製功能</title>
    <link href="https://ppundsh.github.io/posts/8e7e/"/>
    <id>https://ppundsh.github.io/posts/8e7e/</id>
    <published>2018-04-26T01:00:51.000Z</published>
    <updated>2018-04-26T18:37:25.346Z</updated>
    
    <content type="html"><![CDATA[<p>處理了非常久，總算找齊所有的問題點並成功做出該功能。<br><a id="more"></a><br>本文取自於這邊<a href="https://www.ofind.cn/blog/HEXO/HEXO%E4%BC%98%E5%8C%96%E4%B9%8B%EF%BC%88%E4%BA%8C%EF%BC%89-%E6%B7%BB%E5%8A%A0%E5%A4%8D%E5%88%B6%E5%8A%9F%E8%83%BD.html" rel="external nofollow noopener noreferrer" target="_blank">HEXO優化之（二）-添加複製功能</a></p><p>但有幾點不同，<code>custom.js</code>要修改以下幾點：</p><ol><li>原教學的 <code>clipboard.min.js</code> 是使用 1.7.1 版 <a class="btn" href="https://github.com/zenorocha/clipboard.js/releases/tag/v1.7.1 " rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fal fa-download" "=""></i></a>，若要用最新的 2.0.0 版<a class="btn" href="https://raw.githubusercontent.com/zenorocha/clipboard.js/v2.0.0/dist/clipboard.min.js " rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-fal fa-download" "=""></i></a>，需要將 <code>var clipboard = new Clipboard(&#39;#copyBtn&#39;, {</code> 修改為 <code>var clipboard = new ClipboardJS(&#39;#copyBtn&#39;, {</code></li><li><code>var $codeArea = $(&quot;figure table&quot;);</code><br> 改為<br> <code>var $codeArea = $(&quot;figure&quot;);</code></li><li><code>$(&quot;.post-body&quot;).before(&#39;&lt;div id=&quot;copyBtn&quot; style=&quot;opacity: 0; position: absolute;top:0px;display: none;line-height: 1; font-size:1.5em&quot;&gt;&lt;span id=&quot;imgCopy&quot; &gt;&lt;i class=&quot;fa fa-paste fa-fw&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;span id=&quot;imgSuccess&quot; style=&quot;display: none;&quot;&gt;&lt;i class=&quot;fa fa-check-circle fa-fw&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#39;);</code><br> 改為<br> <code>$(&quot;.post-body&quot;).before(&#39;&lt;div id=&quot;copyBtn&quot; style=&quot;opacity: 0; position: absolute;top:0px;left:0px;display: none;line-height: 1; font-size:1.5em&quot;&gt;&lt;span id=&quot;imgCopy&quot; &gt;&lt;i class=&quot;fa fa-paste fa-fw&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;span id=&quot;imgSuccess&quot; style=&quot;display: none;&quot;&gt;&lt;i class=&quot;fa fa-check-circle fa-fw&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#39;);</code></li><li><code>$copyBtn.css(&quot;left&quot;, -$copyBtn.width() - 3);</code><br> 改為<br> <code>$copyBtn.css(&quot;left&quot;,$(this).offset().left -$copyBtn.width() - 3);</code></li></ol><p>完整過程代碼如下：<br>保存文件 clipboard.min.js (壓縮檔的話是在 dist 資料夾內)至 <code>.\themes\next\source\lib\zclip\clipboard.min.js</code></p><p>新建文件 custom.js 至 <code>.\themes\next\source\js\src\custom.js</code></p><p>內容如下<br><figure class="highlight plain"><figcaption><span class="fileDir">file:~\themes\next\source\js\src\</span><span class="caption">custom</span><span class="suffix">.js</span></figcaption><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></div><div class="code"><pre><div class="line">//此函數用於創建複製按鈕</div><div class="line">function createCopyBtns() &#123;</div><div class="line marked">    var $codeArea = $(&quot;figure&quot;);</div><div class="line">    //查看頁面是否具有代碼區域，沒有代碼塊則不創建 複製按鈕</div><div class="line">    if ($codeArea.length &gt; 0) &#123;</div><div class="line">        //複製成功後將要干的事情</div><div class="line">        function changeToSuccess(item) &#123;</div><div class="line">             $imgOK = $(&quot;#copyBtn&quot;).find(&quot;#imgSuccess&quot;);</div><div class="line">                if ($imgOK.css(&quot;display&quot;) == &quot;none&quot;) &#123;</div><div class="line">                    $imgOK.css(&#123;</div><div class="line">                        opacity: 0,</div><div class="line">                        display: &quot;block&quot;</div><div class="line">                    &#125;);</div><div class="line">                    $imgOK.animate(&#123;</div><div class="line">                        opacity: 1</div><div class="line">                    &#125;, 1000);</div><div class="line">                    setTimeout(function() &#123;</div><div class="line">                        $imgOK.animate(&#123;</div><div class="line">                            opacity: 0</div><div class="line">                        &#125;, 2000);</div><div class="line">                    &#125;, 2000);</div><div class="line">                    setTimeout(function() &#123;</div><div class="line">                        $imgOK.css(&quot;display&quot;, &quot;none&quot;);</div><div class="line">                    &#125;, 4000);</div><div class="line">                &#125;;</div><div class="line">        &#125;;</div><div class="line">        //創建 全局複製按鈕，僅有一組。包含：複製按鈕，複製成功回應按鈕</div><div class="line">        //值得注意的是：1.按鈕默認隱藏，2.位置使用絕對位置 position: absolute; (position: fixed 也可以，需要修改代碼)</div><div class="line marked">        $(&quot;.post-body&quot;).before(&apos;&lt;div id=&quot;copyBtn&quot; style=&quot;opacity: 0; position: absolute;top:0px;left:0px;display: none;line-height: 1; font-size:1.5em&quot;&gt;&lt;span id=&quot;imgCopy&quot; &gt;&lt;i class=&quot;fa fa-paste fa-fw&quot;&gt;&lt;/i&gt;&lt;/span&gt;&lt;span id=&quot;imgSuccess&quot; style=&quot;display: none;&quot;&gt;&lt;i class=&quot;fa fa-check-circle fa-fw&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&lt;/span&gt;&apos;);</div><div class="line">        //創建 複製 插件，綁定單機時間到 指定元素，支援JQuery</div><div class="line marked">        var clipboard = new ClipboardJS(&apos;#copyBtn&apos;, &#123;</div><div class="line">            target: function() &#123;</div><div class="line">                //返回需要複製的元素內容</div><div class="line">                return document.querySelector(&quot;[copyFlag]&quot;);</div><div class="line">            &#125;,</div><div class="line">            isSupported: function() &#123;</div><div class="line">                //支援複製內容</div><div class="line">                return document.querySelector(&quot;[copyFlag]&quot;);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">        //複製成功事件綁定</div><div class="line">        clipboard.on(&apos;success&apos;,</div><div class="line">            function(e) &#123;</div><div class="line">                //清除內容被選擇狀態</div><div class="line">                e.clearSelection();</div><div class="line">                changeToSuccess(e);</div><div class="line">            &#125;);</div><div class="line">        //複製失敗綁定事件</div><div class="line">        clipboard.on(&apos;error&apos;,</div><div class="line">            function(e) &#123;</div><div class="line">                console.error(&apos;Action:&apos;, e.action);</div><div class="line">                console.error(&apos;Trigger:&apos;, e.trigger);</div><div class="line">            &#125;);</div><div class="line">        //滑鼠 在複製按鈕上滑動和離開後漸變顯示/隱藏效果</div><div class="line">        $(&quot;#copyBtn&quot;).hover(</div><div class="line">            function() &#123;</div><div class="line">                $(this).stop();</div><div class="line">                $(this).css(&quot;opacity&quot;, 1);</div><div class="line">            &#125;,</div><div class="line">            function() &#123;</div><div class="line">                $(this).animate(&#123;</div><div class="line">                    opacity: 0</div><div class="line">                &#125;, 2000);</div><div class="line">            &#125;</div><div class="line">        );</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">//感應滑鼠是否在代碼區</div><div class="line">$(&quot;figure&quot;).hover(</div><div class="line">    function() &#123;</div><div class="line">        //-------滑鼠活動在代碼塊內</div><div class="line">        //移除之前含有複製標誌代碼塊的 copyFlag</div><div class="line">        $(&quot;[copyFlag]&quot;).removeAttr(&quot;copyFlag&quot;);</div><div class="line">        //在新的（當前滑鼠所在代碼區）代碼塊插入標誌：copyFlag</div><div class="line">        $(this).find(&quot;.code&quot;).attr(&quot;copyFlag&quot;, 1);</div><div class="line">        //獲取複製按鈕</div><div class="line">        $copyBtn = $(&quot;#copyBtn&quot;);</div><div class="line">        if ($copyBtn.lenght != 0) &#123;</div><div class="line">            //獲取到按鈕的前提下進行一下操作</div><div class="line">            //停止按鈕動畫效果</div><div class="line">            //設置為 顯示狀態</div><div class="line">            //修改 複製按鈕 位置到 當前代碼塊開始部位</div><div class="line">            //設置代碼塊 左側位置</div><div class="line">            $copyBtn.stop();</div><div class="line">            $copyBtn.css(&quot;opacity&quot;, 0.8);</div><div class="line">            $copyBtn.css(&quot;display&quot;, &quot;block&quot;);</div><div class="line">            $copyBtn.css(&quot;top&quot;, parseInt($copyBtn.css(&quot;top&quot;)) + $(this).offset().top - $copyBtn.offset().top + 3);</div><div class="line marked">            $copyBtn.css(&quot;left&quot;,$(this).offset().left -$copyBtn.width() - 3);</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    function() &#123;</div><div class="line">        //-------滑鼠離開代碼塊</div><div class="line">        //設置複製按鈕可見度 2秒內到 0</div><div class="line">        $(&quot;#copyBtn&quot;).animate(&#123;</div><div class="line">            opacity: 0</div><div class="line">        &#125;, 2000);</div><div class="line">    &#125;</div><div class="line">);</div><div class="line">//頁面載入完成後，創建複製按鈕</div><div class="line">$(document).ready(function() &#123;</div><div class="line">  createCopyBtns();</div><div class="line">&#125;);</div></pre></div></div></figure></p><p>新建文件 custom.swig 至 <code>.\themes\next\layout_custom\custom.swig</code></p><figure class="highlight plain"><figcaption><span class="fileDir">file:~\themes\next\layout\_custom\</span><span class="caption">custom</span><span class="suffix">.swig</span></figcaption><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></div><div class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/lib/zclip/clipboard.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/custom.js&quot;&gt;&lt;/script&gt;</div></pre></div></div></figure><p>修改文件 _layout.swig 位置<code>.\themes\next\layout_layout.swig</code><br>在&lt;\/body>上方插入<br><figure class="highlight plain"><figcaption><span class="fileDir">file:~themes\next\</span><span class="caption">layout_layout</span><span class="suffix">.swig</span></figcaption><div class="figcode"><div class="gutter"><pre><div class="line">1</div></pre></div><div class="code"><pre><div class="line">&#123;% include &apos;_custom/custom.swig&apos; %&#125;</div></pre></div></div></figure></p><hr><p>再次感謝作者 zhuzhuxia 的創作！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;處理了非常久，總算找齊所有的問題點並成功做出該功能。&lt;br&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://ppundsh.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>國際海纜</title>
    <link href="https://ppundsh.github.io/posts/b545/"/>
    <id>https://ppundsh.github.io/posts/b545/</id>
    <published>2018-04-25T18:56:49.000Z</published>
    <updated>2018-04-25T20:40:12.694Z</updated>
    
    <content type="html"><![CDATA[<p>看到相關的圖才發現自已對此沒有了解過，記錄一下。<br><a id="more"></a></p><h1 id="全圖"><a href="#全圖" class="headerlink" title="全圖"></a>全圖</h1><p><img src="https://i.imgur.com/DD2kKPh.png" alt="國際海纜" title="國際海纜"><br>即時查詢的地圖 <a href="https://www.submarinecablemap.com/" rel="external nofollow noopener noreferrer" target="_blank">Submarine Cable Map</a></p><h1 id="資料："><a href="#資料：" class="headerlink" title="資料："></a>資料：</h1><p>來源<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p><h2 id="我國現況"><a href="#我國現況" class="headerlink" title="我國現況"></a>我國現況</h2><p>我國目前有四個海纜登陸站，分別為頭城、淡水、八里、枋山，經由此四個海纜登陸站的光纖海纜電路。<br><img src="https://i.imgur.com/OG34cWe.png" alt="台灣海纜登陸點" title="台灣海纜登陸點"></p><h3 id="海纜登陸站資料"><a href="#海纜登陸站資料" class="headerlink" title="海纜登陸站資料"></a>海纜登陸站資料</h3><p>四個海纜登陸站之基本資料表如附表，顯示個登陸站之所有權人、中繼網路提供商(backhaul providers)、海纜系統名稱，備註中包括登陸站位置等資訊。頭城、枋山為中華電信獨資興建，淡水由中華電信與新世紀資通(遠傳)合建，八里由新世紀資通(NCIC) / 全球光網( Pacnet)合建。各海纜光纖線路登陸至哪一個登陸站，須事先與各登陸站的業主協商同意。例如FASTER選擇與遠傳新世紀資通合作，以淡水為登陸站。PLCN則選擇與中華電信合作，以頭城為登陸站。</p><table><thead><tr><th>名稱</th><th>Station Owner</th><th>Submarine Cable Systems</th><th>備註</th></tr></thead><tbody><tr><td>淡水</td><td>中華電信<br> 新世紀資通(NCIC)</td><td>APCN-2<br>TPE<br>EAC-C2C<br>TSE-1<br>FASTER</td><td>淡水海纜登陸站有兩個海纜登陸站<br>其中一個為中華電信所有，另一個為新世紀資通</td></tr><tr><td>八里</td><td>新世紀資通(NCIC)/全球光網 Pacnet</td><td>EAC-C2C</td></tr><tr><td>頭城</td><td>中華電信</td><td>APCN<br>FNAL/RNAL<br>SMW3<br>NCP<br>PLCN</td></tr><tr><td>枋山</td><td>中華電信</td><td>China-US CN<br>SMW3<br>EAC-C2C</td></tr></tbody></table><h3 id="登陸臺灣之海纜系統"><a href="#登陸臺灣之海纜系統" class="headerlink" title="登陸臺灣之海纜系統"></a>登陸臺灣之海纜系統</h3><p>總計有12條海纜登陸，其中1條僅約21km，1條約260km。<br>其中登陸頭城有5條，登陸淡水有5條，登陸八里有1條，登陸枋山有3條。<br>其中包括金門到廈門的金廈海纜(Cross Straits Cable)，全長僅約21km。<br>另一條為淡水到福州的淡福海纜(Taiwan Strait Express-1 -TSE)，全長約260km。SeaMeWe-3同時登錄頭城、枋山，EAC-C2C同時登錄淡水、八里與枋山。</p><p>中華電信有參與投資的海纜計有 SeaMeWe-3、China-US Cable Network、APCN-2、Trans-Pacific Express (TPE)、Cross Straits Cable、Taiwan Strait Express-1 (TSE)、Asia Pacific Gateway (APG)、New Cross Pacific (NCP) Cable等8條，遠傳電信及臺灣大皆僅投資淡福海纜(Taiwan Strait Express-1 -TSE)。</p><p>Google 投資的 FASTER，已於 2016.06 營運。<br>Pacific Light Cable Network (PLCN) 主要由 Google, Facebook投資，預計2018Q4才會營運。</p><h3 id="我國國際海纜電路出租業務業者"><a href="#我國國際海纜電路出租業務業者" class="headerlink" title="我國國際海纜電路出租業務業者"></a>我國國際海纜電路出租業務業者</h3><p>目前我國國際海纜電路出租業務業者核准名單，計有下列四家:</p><p>全球光網電訊股份有限公司(PACNET)、臺灣國際纜網通信股份有限公司(TIGC)、國際環球通訊網路股份有限公司(REACH)、北亞環球光纖通訊網路股份有限公司(FLAG)</p><p>另下列四家具有第1類電信事業之綜合網路業務執照，亦可經營所有固定通信網路業務，包括國際海纜電路出租業務:</p><p>中華電信股份有限公司(CHT)、臺灣固網股份有限公司(TFN)、亞太電信股份有限公司(APTG)、新世紀資通股份有限公司(NCIC)</p><p>上述公司可以將國際海纜業務，向投資興建海纜之業者，批發或自行出租給業者使用。至於從海纜登陸站到主要電信之IDC資料中心的路上光纖電纜，則是以具陸纜鋪設執照的第1類電信業者公司皆可鋪設，但由於須與海纜登陸站介接，所以仍需與海纜登陸站的業主協商同意。</p><h2 id="全球海纜業務概況"><a href="#全球海纜業務概況" class="headerlink" title="全球海纜業務概況"></a>全球海纜業務概況</h2><p>截至2017年初，全世界約有428條、超過110萬公里的海底電纜正在服務中。有些電纜相當短，如英國愛爾蘭之間的131公里CeltixConnect電纜。相比之下，其他則相當長，比如超過2萬公里的China-US Cable Network、SeaMeWe-3。傳統上，海纜係由電信營運商(telecom carriers)擁有，這些電信營運商將組成一個有興趣使用海纜的各方的聯盟(Consortium)。但在二十世紀九十年代後期，網路泡沫化後，湧入的創業公司建立了大量的私人海纜並向用戶銷售產能。聯盟和私有電纜(Private Cable)之模型今天仍然存在，但是過去幾年中最大的變化之一是涉及建造電纜的公司類型。</p><p>另舉聯盟運作為例，根據JUPITER聯盟，Amazon已經參與了JUPITER聯盟，建立了新的大容量跨太平洋海底電纜系統，跨越約14,000公里的JUPITER電纜系統，連接菲律賓、日本和美國。JUPITER聯盟包括Amazon、Facebook、NTT Communications、PCCW Global、PLDT和SoftBank。這是亞馬遜第一次在國際海底電纜聯盟中佔有一席之地。包括Google、Facebook、Microsoft、Amazon在內的OTT巨頭已經成為全球海底光纜系統的主要投資者。阿里巴巴會成為下一個參加海底電纜聯盟的嗎？ 私人網路營運商（如這些內容提供商）部署的容量，近年來已經超過了網際網路骨幹營運商。面對持續大量頻寬增長的前景，擁有新的海底電纜對這些公司來說，是有其經營戰略意義的。用TeleGeography的託管研究總監Jon Hjembo的話說：「 內容正在推動著一切，這是我們現在正在觀察的最大的趨勢之一」。</p><p>與以前的海底光纜建設熱潮不同，像Amazon、Google、Facebook和Microsoft這樣的內容提供商，在最近的這個激增中扮演著更積極的角色。這些公司單獨擁有資料中心流量的這種令人難以置信的需求，因此他們正在推動建構海底電纜的專案。</p><p>在2012年到2016年間，Google、Facebook、Microsoft和Amazon等公司部署的國際容量增長13倍，達到了179Tbps，國際內容業者國際海纜容量成長如圖3所示。（相比之下，所有其他營運商部署的國際容量僅增長了三倍，達到272Tbps）</p><p>海纜容量差別很大。通常情況下，較新的海纜能夠比15年前鋪設的電纜承載更多的資料。計畫中的MAREA海纜將能夠承載160 Tbps。通常有兩種測量電纜容量的主要方法:</p><ol><li>潛在容量(Potential Capacity): 是電纜所有者在電纜末端安裝了所有可用設備的情況下可能的總容量。 這是媒體最常引用的指標。</li><li>點亮容量(Lit Capacity): 是實際通過電纜運行的容量。這個數字只是提供另一個容量指標。電纜擁有者很少購買和安裝傳輸設備，從一開始就充分實現電纜的潛力。由於這種設備價格昂貴，因此業主傾向於根據客戶的需求逐步升級電纜。</li></ol><p>在亞太地區，泰國政府為發展ICT基礎設施提供強有力的支援，並製定了泰國國家寬頻政策，2021年數位孟加拉國願景，2020年柬埔寨ICT總體規劃和緬甸電子化政府ICT總體規劃等計畫。在南太平洋地區，各國政府正在為ICT發展投入更多資金。印尼政府計畫在未來五年向資訊通訊技術行業投資230億美元，用於在印尼建設海洋樞紐和南太平洋區域中心等專案。</p><h2 id="我國海纜維運概況"><a href="#我國海纜維運概況" class="headerlink" title="我國海纜維運概況"></a>我國海纜維運概況</h2><h3 id="一-2006恆春大地震海纜故障案例"><a href="#一-2006恆春大地震海纜故障案例" class="headerlink" title="(一) 2006恆春大地震海纜故障案例"></a>(一) 2006恆春大地震海纜故障案例</h3><p>2006年恆春地震，發生在2006.12.26UTC12時25分。震央位於北緯21.89度、東經120.56度、即臺灣中央氣象局屏東恆春地震站西偏南方22.89公里的呂宋海峽海域錄得芮氏規模6.7、深度21.9公里的地震。</p><p>震央附近發生大規模海底山崩(如圖5所示)，該地區為海底電纜路徑之密集處，導致這次地震在臺灣造成輕微的人命傷亡和建築物損毀，但嚴重的災情在於造成多條海底電纜中斷，導致東亞區內網際網路、國際電話服務受阻。聯合國國際減災策略署（ISDR）主任布里斯諾形容此次地震損害海底電纜為現代新型態災難，對經濟及社會的衝擊極為沉重，並表示將與國際電信聯盟（ITU）全面提升海底電纜的抗震標準。</p><p>這次地震發生的呂宋海峽是多條國際海底電纜的樞紐，距離枋山的海纜登陸站不遠。因此這場地震和繼後的餘震造成了海底電纜故障，影響了臺灣、日本、中國中國及韓國之間的電信服務以及這些地區連到美國、英國的電信服務。這次通訊中斷，亦導致跨國金融服務公司無法連接海外電子交易系統，銀行間外匯交易無法進行，造成難以估算的經濟損失。受影響的海底電纜(如圖6所示)包括：</p><ol><li><p>中美海纜於臺灣時間12月26日20時25分距離臺灣枋山登陸站在9.7公里左右中斷；</p></li><li><p>法新歐亞三號海纜（SEA-ME-WE 3）於12月26日20時25分距離臺灣枋山登陸站於9.7公里左右中斷；</p></li><li><p>亞太海纜二號（APCN 2）S7於12月27日00時06分距離臺灣淡水登陸站904公里左右中斷；</p></li><li><p>亞太海纜二號S3於12月27日02時00分距離崇明登陸站2100公里左右（靠近臺灣處）中斷；</p></li><li><p>環球海底光纜（FLAG）亞太系統於12月26日20時43分在韓國到香港段中斷；</p></li><li><p>環球海底光纜亞歐段於12月27日04時56分在香港到上海段中斷；</p></li></ol><p>亞太海纜一號（APCN 1）FNAL海纜以及多條國際海底通訊光纖電纜在臺灣以南15公里的海域發生中斷。當時僅有亞太光纜二號（APCN 2）及法新歐亞三號（SEA-ME-WE 3）北段尚可繼續通訊。至於不足的語音電話及長途電話等，則暫以中新一號衛星支援。</p><p>中華電信表示，受到地震影響，臺灣南部沿岸的海底電纜受到破壞，因此臺灣通往中國中國及東南亞部份國家的長途電話服務均受影響。經過搶修以及與各國協調後，中華電信於2006.12.27UTC時間6時修復部份語音通話系統功能；中國中國、加拿大及美洲近乎正常（詳細數值待公佈），日本則由同日3時的11%提升至30%。此外，堪用的電纜只剩亞太光纜二號及法新歐亞三號往北線路。12月28日，已經修復15%的電纜，預計要需時3星期才會完全修復完畢。與美國的IDD接通成功率已由40%提升到70%、日本由30%提升至70%、中國中國由10%提升至55%，香港30%，歐洲國家也提升至60%以上。影響最嚴重的東南亞國家，新加坡已達55%、泰國40%、印尼、馬來西亞22%，中華電信將持續調度路由改善。資料電路部分，經與國外電信業者聯繫調度，當地時間28日中午以前所有到香港、新加坡及主要的東南亞國家的資料電路都已支援完畢。</p><p><img src="https://i.imgur.com/UwNNgCY.png" alt="恆春大地震海底土石流區域圖" title="恆春大地震海底土石流區域圖"></p><h3 id="二-例行性海纜維護，造成連線品質影響"><a href="#二-例行性海纜維護，造成連線品質影響" class="headerlink" title="(二) 例行性海纜維護，造成連線品質影響"></a>(二) 例行性海纜維護，造成連線品質影響</h3><p>海纜維護時，通常ISP會對其受海纜維護之影響公告讓客戶知悉，以下以HiNet為例之公告。通常此類之影響較為輕微，影響時間約幾個小時至數天，ISP會要求海纜租用公司緊急調度備用，並確保仍在一定服務品質水準下，提供連線服務。</p><h4 id="因APG海纜維護影響HiNet客戶連線日本及中國部份網站之連線品質"><a href="#因APG海纜維護影響HiNet客戶連線日本及中國部份網站之連線品質" class="headerlink" title="因APG海纜維護影響HiNet客戶連線日本及中國部份網站之連線品質"></a>因APG海纜維護影響HiNet客戶連線日本及中國部份網站之連線品質</h4><ul><li>起訖日期：2017–11–04~2017–11–05</li><li>時間： 15:00 ~ 23:00</li><li>範圍：詳如說明</li><li>說明：因2017.11.4至2017.11.5進行APG海纜維護，經本公司緊急調度支援後，客戶連線日本及中國部份網站於一般時段不會受到影響，僅於尖峰時段可能造成部分連線有少許延遲現象，待維護完成後，即可恢復正常，所造成之不便，敬請見諒。</li></ul><h4 id="因TPE海纜維護影響HiNet客戶連線歐美、中國、日本及韓國部份網站之連線品質"><a href="#因TPE海纜維護影響HiNet客戶連線歐美、中國、日本及韓國部份網站之連線品質" class="headerlink" title="因TPE海纜維護影響HiNet客戶連線歐美、中國、日本及韓國部份網站之連線品質"></a>因TPE海纜維護影響HiNet客戶連線歐美、中國、日本及韓國部份網站之連線品質</h4><ul><li>起訖日期：2017–10–03~2017–10–11</li><li>時間： 00:00 ~ 07:30</li><li>範圍：詳如說明</li><li>說明：因2017.10.3 至2017.10.11進行TPE海纜維護，經本公司緊急調度支援後，客戶連線歐美、中國、日本及韓國部份網站於一般時段不會受到影響，僅於尖峰時段可能造成部分連線有少許延遲現象，待維護完成後，即可恢復正常，所造成之不便，敬請見諒。</li></ul><h3 id="三-海纜障礙造成連線品質影響"><a href="#三-海纜障礙造成連線品質影響" class="headerlink" title="(三) 海纜障礙造成連線品質影響"></a>(三) 海纜障礙造成連線品質影響</h3><p>海纜障礙亦為經常發生事項，海纜故障之修護，是其損壞程度，嚴重者修護通常需時數個月，對ISP提供服務產生較嚴重影響。海纜租用公司之調度，因為時間較長，成本甚高，其備用回覆程度，端視與海纜租用公司之合約內容而定。</p><h4 id="因APCN2海纜障礙影響HiNet客戶連線歐美、日本部份網站之連線品質"><a href="#因APCN2海纜障礙影響HiNet客戶連線歐美、日本部份網站之連線品質" class="headerlink" title="因APCN2海纜障礙影響HiNet客戶連線歐美、日本部份網站之連線品質"></a>因APCN2海纜障礙影響HiNet客戶連線歐美、日本部份網站之連線品質</h4><ul><li>起訖日期：2017–04–22~2017–05–08</li><li>時間：2017.5.813:15修復</li><li>範圍：詳如說明</li><li>說明：因2017.4.22發生APCN2海纜障礙，經本公司緊急調度支援後，客戶連線歐美及日本部份網站會有少許延遲現象，待搶修完成後，即可恢復正常，所造成之不便，敬請見諒。</li></ul><h2 id="四、-我國海纜備援機制"><a href="#四、-我國海纜備援機制" class="headerlink" title="四、 我國海纜備援機制"></a>四、 我國海纜備援機制</h2><p>目前我國4個海纜登陸站，北3南1，中華興建3座(2座獨建，1座與新世紀資通合建)，新世紀資通2座(分別與中華電信、全球光網電訊合建)。中華投資興建海纜8條，遠傳電信及臺灣大皆僅投資淡福海纜(Taiwan Strait Express-1 -TSE)。我國各主要固網業者之海纜利用，中華電信係以參與投資的海纜為主，並與聯盟會員簽屬互換(SWAP)合約，如非參與投資部分之調度，須配合IRU（Indefeasible rights of use法律上不可取消的權利，通常為15年）或租用（如少於5年）方式，估算可能緊急調度之因應方式。</p><h3 id="一-一般固網海纜之調度模式"><a href="#一-一般固網海纜之調度模式" class="headerlink" title="(一) 一般固網海纜之調度模式"></a>(一) 一般固網海纜之調度模式</h3><p>以中華電信為例: 現行參與投資興建部分之海纜有SeaMeWe-3、China-US Cable Network、APCN-2、Trans-Pacific Express (TPE)、Cross Straits Cable、Taiwan Strait Express-1 (TSE)、Asia Pacific Gateway (APG)、New Cross Pacific (NCP) Cable等8條。台美主要集中JUCN、TPE及Unity三條海纜，Unity及JUCN係以APG海纜銜接，將通信流量串接至美國，而TPE所佔正常頻寬比重超過51%，對美預估2017年初出現頻寬供給缺口後，可能採之中長期因應方式包括，積極參與籌建NCP，待NCP完工後，和其他海纜互換(SWAP)頻寬資源。另亦將積極參與TPE與JUCN擴建，及向其他海纜業者採購IRU，以分散路由風險，及時提供更多的路由選擇彈性。</p><p>因為臺灣大、遠傳及其他固網業者，參與興建海纜數量甚少，正常海纜訊務接採購置IRU（Indefeasible rights of use法律上不可取消的權利，通常為15年）或租用（如少於5年）方式，其緊急調度時之彈性，其備援率則依其備援容量政策而定(此大都為商業營運機密)，通常這些調度如上述以HiNet為例之公告一般例行海纜維護，或海纜故障維護之調度，大都仍屬較輕微影響，如上述所述: 「經本公司緊急調度支援後，客戶連線歐美、中國、日本及韓國部份網站於一般時段不會受到影響，僅於尖峰時段可能造成部分連線有少許延遲現象，待維護完成後，即可恢復正常」。</p><h3 id="二-重大事故之海纜之調度模式"><a href="#二-重大事故之海纜之調度模式" class="headerlink" title="(二) 重大事故之海纜之調度模式"></a>(二) 重大事故之海纜之調度模式</h3><p>因海纜通常是一段接續另一段，一段故障後，需有其他繞道設計，方能避免其影響。目前僅有SeaMeWe-3同時登錄頭城、訪山，EAC-C2C同時登錄淡水、八里與枋山。我國目前海纜出口示意圖如圖7所示。大部分海纜出口集中於頭城與淡水。以2006年恆春大地震為例，震央及海底土石流位於呂宋海峽附近，是多條國際海底電纜的樞紐，距離枋山的海纜登陸站不遠，如圖4所示，很多未登陸枋山登陸站，或途經但登陸北部登陸站的海纜亦受波及，導致一連串的相互影響效應，而不只我國受害，包括鄰近的中國、日本、韓國、香港、新加坡之海纜通訊訊務皆受到影響。</p><p>圖7 臺灣海纜出口示意圖<br>由圖7顯示四個海纜登陸點及海纜所經路線，都將會是我國網路通信的關鍵基礎設施。不僅是我國如此，全球海底電纜目前都呈現非常脆弱現象，對大規模軍事攻擊，防禦能力脆弱。四個海纜登陸站是最容易受到攻擊的地點，也是我國對外網路通訊的致命弱點。如純依商業角度出發，目前頭城進線最為熱門，因鄰近海域較為深廣，較不易受到人為破壞。枋山因鄰近呂宋海峽，雖附近火山斷層活躍，如2006年恆春大地震，但因呂宋海峽東接太平洋，西通南海，全寬約250公里，不但是重要的航運通道，也是東亞各國通往北美洲的海底光纜密集之處。目前枋山海纜登陸站為中華電信所有，僅有3條海纜進線，且目前仍有些南北不平衡現象，雖南北本來網路訊務需求即有很大差異，但可透過環島路上光纖將南北訊務串連，對全台灣整體國內外網路備援，應該還是值得之思考的可能方案之一。</p><p>如北臺灣發生大地震或南臺灣發生大地震，致鄰近外海之海纜大規模受創(本島陸地亦遭遇大停電或斷線等事故)時，是否海纜有足夠備援調度措施? 目前觀之，可以下列事項來強化重大事故備援調度之韌性(resilience):</p><ol><li><p>四個海纜登陸站目前皆為民營電信公司所有，國家遇緊急事故，NCC依電信管理法要求，應能有一快速調度或互相支援之因應措施。政府亦可考慮規劃第五、或第六海纜登陸站之可行性，包括於中部地區設立之可行性。</p></li><li><p>目前我國國土辦公室已將海纜登陸站，列為我國關鍵基礎設施通訊傳播類一級關鍵基礎設施，並定期實施防護演練。但演練僅以是否易遭受一般潛入破壞，未對大規模或嚴重破壞事件，進行預防及備援演練，建議可增加海纜更多演練案例，以強化海纜站的防護效果。</p></li><li><p>因為臺灣大、遠傳等業者，參與興建海纜數量甚少，正常海纜訊務接採購置IRU或租用（如少於5年）方式，其緊急調度時之彈性，其備援率則依其備援容量政策而定，此備援率之提高時會導致成本增加，我國固網業者往往不重視此備援率之需要性。因此未來在檢視固網業者網路設施關鍵基礎設施時，建議將固網海底電纜購置或租用之備援率，列入檢視，如必要時NCC亦可要求海纜調度備援率，應為正常海纜訊務量一定比率以上。</p></li><li><p>除中華電信外，其他固網參與投資興建海纜者甚少，建議應適時政策引導主要固網業者應增加海纜投資，以提升海纜通訊容量及提高海纜自我調度之彈性。</p></li><li><p>海纜站及進線海纜仍有南、北不平衡現象(枋山海纜登陸站為中華電信所有，僅有3條海纜進線)，雖南北本來網路訊務需求即有很大差異，如能透過環島路上光纖將南北訊務串連，並鼓勵新海纜興建時，以枋山或南部為登陸點，一方面分線環繞臺灣周圍之海纜線路，一方面可平衡海纜站進線之海纜數量，可策略上對對全台灣整體國內外網路備援能力及韌性，多提供一分保障。</p></li><li><p>運用自動辨識系統(AIS)精準定位海纜損壞位置，監控海底電纜線路安全，可避免電纜維修延誤。由於大部分海纜系統都橫跨多個國家，此AIS系統需要透過跨國多邊合作機制，才能達到預期效果。AIS網路監控中心可以24 * 7遠端監控所有的海上活動。中華電信所參與投資的電纜系統，都應適時建置此類系統，並參與多國共同自動監測計畫，以減少海纜維修延誤及無法提供訊務時間。其他固網購置IRU或租用海纜電路部分，亦可同樣要求類似自動辨識系統(AIS)即時監測之服務。</p></li></ol><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://medium.com/@vincent.wschen/%E5%8F%B0%E7%81%A3%E6%B5%B7%E7%BA%9C-submarine-cable-%E6%A6%82%E6%B3%81%E5%8F%8A%E5%82%99%E6%8F%B4%E6%A9%9F%E5%88%B6-3e47ea550fd6" rel="external nofollow noopener noreferrer" target="_blank">臺灣海纜 Taiwan Submarine Cable 概況及備援機制</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;看到相關的圖才發現自已對此沒有了解過，記錄一下。&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
  </entry>
  
  <entry>
    <title>CentOS NTP 設定</title>
    <link href="https://ppundsh.github.io/posts/7007/"/>
    <id>https://ppundsh.github.io/posts/7007/</id>
    <published>2018-04-25T17:19:50.000Z</published>
    <updated>2018-04-25T17:23:00.279Z</updated>
    
    <content type="html"><![CDATA[<p>剛好遇到，記錄一下<br><a id="more"></a><br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">yum install ntp</div><div class="line">chkconfig ntpd on</div><div class="line">ntpdate time.stdtime.gov.tw</div><div class="line">service ntpd start</div></pre></div></div></figure></p><p>可以用以下指令檢查時間<br><code>date</code></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;剛好遇到，記錄一下&lt;br&gt;
    
    </summary>
    
    
      <category term="Linux" scheme="https://ppundsh.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Console 解鎖網頁右鍵功能</title>
    <link href="https://ppundsh.github.io/posts/2e00/"/>
    <id>https://ppundsh.github.io/posts/2e00/</id>
    <published>2018-04-24T21:25:53.000Z</published>
    <updated>2018-04-24T21:58:44.253Z</updated>
    
    <content type="html"><![CDATA[<p>了解原理就不用特地裝外掛了<br><a id="more"></a></p><h1 id="Console"><a href="#Console" class="headerlink" title="Console"></a>Console</h1><p>在網頁上按 F12 叫出開發者工具，點選 console 分頁，輸入以下指令</p><p>右鍵選單<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">$(&quot;body&quot;).attr(&quot;oncontextmenu&quot;,true)</div><div class="line">或等於</div><div class="line">document.body.oncontextmenu = function() &#123; return true; &#125;</div></pre></div></div></figure></p><p>文字選取功能<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">$(&quot;body&quot;).attr(&quot;onselectstart&quot;,true)</div><div class="line">或等於</div><div class="line">document.body.onselectstart = function() &#123; return true; &#125;</div></pre></div></div></figure></p><p>抓取文字功能</p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">$(&quot;body&quot;).attr(&quot;ondragstart&quot;,true)</div><div class="line">或等於</div><div class="line">document.body.ondragstart = function() &#123; return true; &#125;</div></pre></div></div></figure><p>複製功能<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">document.oncopy = function()&#123; return false; &#125;;</div></pre></div></div></figure></p><p>剪下功能<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">document.oncut = function()&#123; return false; &#125;;</div></pre></div></div></figure></p><p>貼上功能<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">document.onpaste = function()&#123; return false; &#125;;</div></pre></div></div></figure></p><p>直接編輯網頁 來源<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup><br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">document.designMode = &apos;on&apos;</div></pre></div></div></figure></p><h1 id="禁止-JavaScript"><a href="#禁止-JavaScript" class="headerlink" title="禁止 JavaScript"></a>禁止 JavaScript</h1><p>來源<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br>按下F12彈出開發者工具，再按下F1彈出設置，勾選Disable JavaScript<br>如果此時仍無法選擇文字，找到你要複製文字的地方，看看是不是添加了-webkit-user-select: none的樣式，如果有，將其去掉即可：</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://dotblogs.com.tw/brooke/2014/10/27/147106" rel="external nofollow noopener noreferrer" target="_blank">https://dotblogs.com.tw/brooke/2014/10/27/147106</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="http://blog.haoji.me/disable-html-copy-and-paste.html?from=xa" rel="external nofollow noopener noreferrer" target="_blank">http://blog.haoji.me/disable-html-copy-and-paste.html?from=xa</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://pjchender.blogspot.com/2017/06/chrome-dev-tools.html" rel="external nofollow noopener noreferrer" target="_blank">https://pjchender.blogspot.com/2017/06/chrome-dev-tools.html</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;了解原理就不用特地裝外掛了&lt;br&gt;
    
    </summary>
    
    
      <category term="Brower" scheme="https://ppundsh.github.io/tags/Brower/"/>
    
  </entry>
  
  <entry>
    <title>CISCO Router 筆記</title>
    <link href="https://ppundsh.github.io/posts/f4f2/"/>
    <id>https://ppundsh.github.io/posts/f4f2/</id>
    <published>2018-04-24T16:01:20.000Z</published>
    <updated>2018-04-26T09:56:06.160Z</updated>
    
    <content type="html"><![CDATA[<p>記一下容易忘記的<br><a id="more"></a></p><h1 id="Default-Route"><a href="#Default-Route" class="headerlink" title="Default Route"></a>Default Route</h1><pre><code>route 0.0.0.0 0.0.0.0 192.168.1.2</code></pre><p>RIP Default Route</p><pre><code>R1(config)#router ripR1(config-router)#version 2R1(config-router)#no auto-summaryR1(config-router)#network 192.168.12.0R1(config-router)#network 192.168.13.0R1(config-router)#default-information originate</code></pre><p>EIGRP Default Route <sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p><pre><code>R1(config)#ip route 0.0.0.0 0.0.0.0 loopback 0 ## 先設定 靜態預設路由R1(config)#router eigrp 1R1(config-router)#redistribute static ## 將 靜態路由 redistribute to EIGRP</code></pre><h1 id="AD-FD"><a href="#AD-FD" class="headerlink" title="AD/FD"></a>AD/FD</h1><p> Administrative Distance <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup></p><table><thead><tr><th>Route Source</th><th>Default Distance Values</th><th>符號</th></tr></thead><tbody><tr><td>Connected interface</td><td>0</td></tr><tr><td>Static route</td><td>1</td></tr><tr><td>Enhanced Interior Gateway Routing Protocol (EIGRP) summary route</td><td>5</td></tr><tr><td>External Border Gateway Protocol (BGP)</td><td>20</td></tr><tr><td>Internal EIGRP</td><td>90</td><td>D</td></tr><tr><td>IGRP</td><td>100</td></tr><tr><td>OSPF</td><td>10</td></tr><tr><td>Intermediate System-to-Intermediate System (IS-IS)</td><td>115</td></tr><tr><td>Routing Information Protocol (RIP)</td><td>120</td></tr><tr><td>Exterior Gateway Protocol (EGP)</td><td>140</td></tr><tr><td>On Demand Routing (ODR)</td><td>160</td></tr><tr><td>External EIGRP</td><td>170</td><td>DEX</td></tr><tr><td>Internal BGP</td><td>200</td></tr><tr><td>Unknown*</td><td>255</td></tr></tbody></table><p>Advertised Distance / Reporting distance<br>到目的地的 Metric</p><h1 id="K-值"><a href="#K-值" class="headerlink" title="K 值"></a>K 值</h1><p>K1：帶寬 Bandwidth，=1<br>K2：負載 Load ，=0<br>K3：延遲 Delay，=1<br>K4：可靠 Reliability，=0<br>K5：MTU，=0</p><p>metric=[K1<em>bandwidth+(K2</em>bandwidth)/(256–load)+K3<em>delay]</em>[K5/(reliability+K4)]  （默認K5為0時，後半部分不參與計算，後半部分是[K5/(reliability+K4)]）</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://ithelp.ithome.com.tw/articles/10157168" rel="external nofollow noopener noreferrer" target="_blank">https://ithelp.ithome.com.tw/articles/10157168</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.cisco.com/c/en/us/support/docs/ip/border-gateway-protocol-bgp/15986-admin-distance.html" rel="external nofollow noopener noreferrer" target="_blank">https://www.cisco.com/c/en/us/support/docs/ip/border-gateway-protocol-bgp/15986-admin-distance.html</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.pluralsight.com/blog/it-ops/eigrp-overview" rel="external nofollow noopener noreferrer" target="_blank">https://www.pluralsight.com/blog/it-ops/eigrp-overview</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;"><a href="https://nkongkimo.wordpress.com/2009/06/05/ccnp-bsci-module-02-eigrp/" rel="external nofollow noopener noreferrer" target="_blank">https://nkongkimo.wordpress.com/2009/06/05/ccnp-bsci-module-02-eigrp/</a></span><a href="#fnref:4" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;記一下容易忘記的&lt;br&gt;
    
    </summary>
    
    
      <category term="RIP" scheme="https://ppundsh.github.io/tags/RIP/"/>
    
      <category term="EIGRP" scheme="https://ppundsh.github.io/tags/EIGRP/"/>
    
  </entry>
  
  <entry>
    <title>Hexo編緝方式筆記</title>
    <link href="https://ppundsh.github.io/posts/2c27/"/>
    <id>https://ppundsh.github.io/posts/2c27/</id>
    <published>2018-04-18T09:30:24.000Z</published>
    <updated>2018-04-24T20:54:29.204Z</updated>
    
    <content type="html"><![CDATA[<p>不止是 Markdown 就是了。記錄一下，供查詢用。<br><a id="more"></a><br>來源<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></p><h2 id="一般常用"><a href="#一般常用" class="headerlink" title="一般常用"></a>一般常用</h2><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line"># 標題(有分隔線)</div><div class="line">## 標題</div><div class="line">&gt;引言</div><div class="line">- 清單</div><div class="line">- 清單</div><div class="line">1. 有序清單</div><div class="line">2. 有序清單</div></pre></div></div></figure><p>連結<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">[an example](http://example.com/ &quot;Title&quot;)</div></pre></div></div></figure></p><p>或</p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">This is [an example] [id] reference-style link.</div><div class="line">[id]: http://example.com/  &quot;Optional Title Here&quot;</div></pre></div></div></figure><p>**粗體**<br>*斜線*<br>~刪除線~</p><p>行內的`程式碼`</p><p>圖片</p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">![Alt text](/path/to/img.jpg &quot;Optional title&quot;)</div></pre></div></div></figure><h2 id="插入影片"><a href="#插入影片" class="headerlink" title="插入影片"></a>插入影片</h2><p>作者<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup></p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">&lt;script src=&quot;/js/youtube-autoresizer.js&quot;&gt;&lt;/script&gt;</div><div class="line"></div><div class="line">&lt;iframe width=&quot;640&quot; height=&quot;360&quot; src=&quot;https://www.youtube.com/embed/HfElOZSEqn4&quot; frameborder=&quot;0&quot; allowfullscreen&gt;&lt;/iframe&gt;</div></pre></div></div></figure><p>表格</p><p>| 控制分列，- 控制分行，: 控制對齊方式。</p><p>| Item     | Value     | Qty   |<br>| :——- | ——–: | :—: |<br>| Computer | 1600 USD  | 5     |<br>| Phone    | 12 USD    | 12    |<br>| Pipe     | 1 USD     | 234   |</p><h2 id="工作清單"><a href="#工作清單" class="headerlink" title="工作清單"></a>工作清單</h2><p>作者<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup></p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">- [ ] Eat</div><div class="line">- [x] Code</div><div class="line">  - [x] HTML</div><div class="line">  - [x] CSS</div><div class="line">  - [x] JavaScript</div><div class="line">- [ ] Sleep</div></pre></div></div></figure><p>效果</p><ul><li style="list-style: none"><input type="checkbox"> Eat</li><li style="list-style: none"><input type="checkbox" checked> Code<ul><li style="list-style: none"><input type="checkbox" checked> HTML</li><li style="list-style: none"><input type="checkbox" checked> CSS</li><li style="list-style: none"><input type="checkbox" checked> JavaScript</li></ul></li><li style="list-style: none"><input type="checkbox"> Sleep</li></ul><h2 id="內文跳轉"><a href="#內文跳轉" class="headerlink" title="內文跳轉"></a>內文跳轉</h2><p>來源<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup></p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line"># 第一章</div><div class="line">## 第一節</div></pre></div></div></figure><p>相對應的跳轉方式就是<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">[第一章](#第一章)</div><div class="line">[第一節](#第一節)</div></pre></div></div></figure></p><h2 id="置中-Next"><a href="#置中-Next" class="headerlink" title="置中(Next)"></a>置中(Next)</h2><p>來源<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">&#123;% centerquote %&#125;內文&#123;% endcenterquote %&#125;</div></pre></div></div></figure></p><p>或<br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">&#123;% cq %&#125; 內文 &#123;% endcq %&#125;</div></pre></div></div></figure></p><h2 id="Bootstrap-Callout-Next"><a href="#Bootstrap-Callout-Next" class="headerlink" title="Bootstrap Callout(Next)"></a>Bootstrap Callout(Next)</h2><p>來源<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">&#123;% note class_name %&#125; 內文 &#123;% endnote %&#125;</div></pre></div></div></figure></p><p>效果</p><div class="note default"><p>內文 </p></div><p><code>class_name</code> 可以是以下值</p><pre><code>defaultprimarysuccessinfowarningdanger</code></pre><h2 id="代碼折疊"><a href="#代碼折疊" class="headerlink" title="代碼折疊"></a>代碼折疊</h2><p>來源<sup id="fnref:6"><a href="#fn:6" rel="footnote">6</a></sup><br>效果</p><div><div class="fold_hider"><div class="close hider_title">點擊顯/隱內容</div></div><div class="fold"><p>something you want to fold, include code block.</p></div></div><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">&#123;% fold 點擊顯/隱內容 %&#125;</div><div class="line">something you want to fold, include code block.</div><div class="line">&#123;% endfold %&#125;</div></pre></div></div></figure><h2 id="不渲染"><a href="#不渲染" class="headerlink" title="不渲染"></a>不渲染</h2><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">&#123;% raw %&#125;</div><div class="line">&#123;% endraw %&#125;</div></pre></div></div></figure><p>\的用法需在符號之前</p><h2 id="代碼塊語法"><a href="#代碼塊語法" class="headerlink" title="代碼塊語法"></a>代碼塊語法</h2><p>作者<sup id="fnref:7"><a href="#fn:7" rel="footnote">7</a></sup></p><figure class="highlight plain"><div class="figcode"><div class="code"><pre><div class="line">```[language] [:title] [lang:language] [line_number:(true|false)] [first_line:number] [mark:#,#-#] [diff:true|false] [url:http...]</div><div class="line">code snippet</div><div class="line">`` `</div></pre></div></div></figure><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://charlottehong.blogspot.com/2017/07/markdown-hackmd-github.html" rel="external nofollow noopener noreferrer" target="_blank">Markdown HackMD Github 同一頁文內跳轉</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="http://theme-next.iissnan.com/tag-plugins.html" rel="external nofollow noopener noreferrer" target="_blank">Next 內置標籤</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="http://markdown.tw/" rel="external nofollow noopener noreferrer" target="_blank">Markdown 文件</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;"><a href="https://hyxxsfwy.github.io/2016/01/15/Hexo-Markdown-%E7%AE%80%E6%98%8E%E8%AF%AD%E6%B3%95%E6%89%8B%E5%86%8C/" rel="external nofollow noopener noreferrer" target="_blank">Hexo Markdown 簡明語法手冊</a></span><a href="#fnref:4" rev="footnote"> ↩</a></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">5.</span><span style="display: inline-block; vertical-align: top;"><a href="http://xianbai.me/learn-md/article/extension/task-list.html" rel="external nofollow noopener noreferrer" target="_blank">Task list</a></span><a href="#fnref:5" rev="footnote"> ↩</a></li><li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">6.</span><span style="display: inline-block; vertical-align: top;"><a href="https://blog.rmiao.top/hexo-fold-block/" rel="external nofollow noopener noreferrer" target="_blank">Hexo next博客添加摺疊塊功能添加摺疊代碼塊</a></span><a href="#fnref:6" rev="footnote"> ↩</a></li><li id="fn:7"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">7.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.ofind.cn/blog/HEXO/HEXO%E4%B8%8B%E7%9A%84%E8%AF%AD%E6%B3%95%E9%AB%98%E4%BA%AE%E6%8B%93%E5%B1%95%E4%BF%AE%E6%94%B9.html" rel="external nofollow noopener noreferrer" target="_blank">HEXO下的語法高亮拓展修改</a></span><a href="#fnref:7" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;不止是 Markdown 就是了。記錄一下，供查詢用。&lt;br&gt;
    
    </summary>
    
    
      <category term="Hexo" scheme="https://ppundsh.github.io/tags/Hexo/"/>
    
  </entry>
  
  <entry>
    <title>利用映像劫持替換預設系統程式</title>
    <link href="https://ppundsh.github.io/posts/f6ff/"/>
    <id>https://ppundsh.github.io/posts/f6ff/</id>
    <published>2018-04-17T18:57:21.000Z</published>
    <updated>2018-04-24T22:14:20.578Z</updated>
    
    <content type="html"><![CDATA[<p>在不暴力替換下，將預設開啟程式(如 notepad)替換並記錄何為映像劫持(IFEO)。<br><a id="more"></a><br>實測後 Emeditor 仍會開啟 notepad，VS Code 則能正常替換，唯 UNC 路徑下的檔案編輯時仍會把目錄傳人，這點個人無解</p><hr><h2 id="文件關聯"><a href="#文件關聯" class="headerlink" title="文件關聯"></a>文件關聯</h2><p>作者<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>我們可能都遇到過需要更改系統默認文件關聯的情況。比如想用我們心愛的編輯器打開所有文本類型的文件。這就需要瞭解 Windows 的文件關聯。</p><p>簡單解釋一下，Windows 的資源管理器識別文件類型是由副檔名決定的（而並不是文件頭決定文件類型）。首先副檔名會對應一種文件類型，這種文件類型的不同操作再對應到不同的具體命令。</p><pre><code>比如： .txt --&gt; txtfile --&gt; { &quot;open&quot;: &quot;notepad.exe %1&quot;, &quot;edit&quot;: &quot;notepad.exe %1&quot;, ... }</code></pre><p>這些對應關係保存於註冊表的HKEY_CLASSES_ROOT項，由 Explorer 讀取後，決定文件該用什麼命令處理。</p><p>文件副檔名與文件類型的對應關係，可以通過assoc命令查看或修改。</p><p>例如：<br>查看後綴關聯：</p><pre><code>assoc .txt.txt=txtfile</code></pre><p>新增 / 更改關聯：</p><pre><code>assoc .json=txtfile.jpg=txtfile</code></pre><p>刪除關聯：<br>    assoc .json=<br>    (無返回內容)</p><p>文件類型與 open command 的對應關係，可以通過ftype命令查看或修改。用法與assoc類似，使用%1表示目標文件，%2等表示其他參數，%*代表所有參數。 例如：</p><pre><code>ftype txtfiletxtfile=%SystemRoot%\system32\NOTEPAD.EXE %1</code></pre><p>進而，文件副檔名就與相應程式關聯上了。</p><p>以上的命令只改變副檔名對應的打開方式，文件類型的其他相關資訊不受影響。</p><h2 id="使用-IFEO-Image-File-Execution-Options"><a href="#使用-IFEO-Image-File-Execution-Options" class="headerlink" title="使用 IFEO (Image File Execution Options)"></a>使用 IFEO (Image File Execution Options)</h2><p>我們發現，想使用指定程式打開特定後綴的文件，只需 assoc 和 ftype 就可以搞定了。</p><pre><code>assoc .json=txtfileftype txtfile=MY_FAVOURITE_EDITOR.exe %1</code></pre><p>不過這種方案只能更改 open command。比如. bat 後綴的批處理文件，右鍵點擊編輯，還是用回（很挫的）notepad 打開了。</p><p>於是很自然想到另一個方案，乾脆用我們的編輯器替換掉 notepad.exe 算了。不過這樣做的缺陷也顯而易見。何況 XP 系統還可能觸發系統文件保護機制。</p><p>因此，更好的辦法是使用 IFEO，以載入 “調試器” 的形式，在運行時 “替換” 掉系統默認程式。這樣既不會產生新文件（符號鏈結），也不會改動系統文件。</p><h2 id="詳細操作"><a href="#詳細操作" class="headerlink" title="詳細操作"></a>詳細操作</h2><p>使用 IFEO 很簡單。註冊表定位到</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe</code></pre><p>（注意其中的 Windows NT）</p><p>創建 Debugger 字串值 (REG_SZ)，更改其值為 D:\Apps\VSCode\Sublimetext.exe -z</p><p>就可以了。</p><p>這裡的 “-z” 參數表示跳過後面的參數，如果不加這個參數，Sublime Text 就會同時打開 notepad.exe 本身，因為後者是作為被調試的程式傳參傳入 Sublime Text 的。</p><p>“-z” 參數適用於 Sublime Text。如果使用 Notepad2，則 “-z” 參數要改為 “/z”.</p><p>至於 Notepad++, 暫時無解，可以嘗試用 AutoHotKey 實現該功能。</p><p>至此，使用 IFEO 替換默認編輯器就已經完成了。快去開心地擼代碼吧！</p><hr><p>另，也可將以下內容修改後存成 <code>.reg</code> 再執行亦可<br><figure class="highlight plain"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe]</div><div class="line">&quot;Debugger&quot;=&quot;\&quot;D:\\Apps\\VSCode\\Code.exe\&quot; -z&quot;</div></pre></div></div></figure></p><h2 id="何謂映射劫持-IFEO"><a href="#何謂映射劫持-IFEO" class="headerlink" title="何謂映射劫持(IFEO)"></a>何謂映射劫持(IFEO)</h2><p><a href="https://jay-fva.blogspot.com/2010/02/ifeo.html" rel="external nofollow noopener noreferrer" target="_blank">文章來源</a></p><h3 id="一、原理"><a href="#一、原理" class="headerlink" title="一、原理"></a>一、原理</h3><p>所謂的映射劫持(IFEO)就是Image File Execution Options，它位於註冊表的</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</code></pre><p>鍵值下。由於這個項主要是用來調試程式用的，對一般用戶意義不大，默認是只有管理員和 local system 有權讀寫修改。<br>比如我想運行 QQ.exe，結果運行的卻是 FlashGet.exe，這種情況下，QQ 程式被 FLASHGET 給劫持了，即你想運行的程式被另外一個程式代替了。</p><h3 id="二、被劫持"><a href="#二、被劫持" class="headerlink" title="二、被劫持"></a>二、被劫持</h3><p>雖然映射劫持是係統自帶的功能，對一般用戶來說根本沒什麼用的必要，但是就有一些病毒通過映射劫持來做文章，表面上看起來是運行了一個正常的程式，實際上病毒已經在後台運行了。<br>大部分的病毒和木馬都是通過載入係統啓動項來運行的，也有一些是註冊成為係統服務來啓動，他們主要通過修改註冊表來實現這個目的，主要有以下幾個鍵值：</p><pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsCurrent\Version\RunHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows\AppInit_DLLsHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\NotifyHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\WindowsCurrent\Version\RunOnceHKEY_LOCAL_MACHINE\Software\Microsoft\WindowsCurrent\Version\RunServicesOnce</code></pre><p>但是與一般的木馬，病毒不同的是，就有一些病毒偏偏不通過這些來載入自己，不隨著係統的啓動運行。木馬病毒的作者抓住了一些用戶的心理，等到用戶運行某個特定的程式的時候它才運行。因為一般的用戶，只要發覺自己的機子中了病毒，首先要察看的就是係統的載入項，很少有人會想到映射劫持，這也是這種病毒高明的地方。</p><p>映射劫持病毒主要通過修改註冊表中的<br>    HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</p><p>項來劫持正常的程式，比如有一個病毒 vires.exe 要劫持qq程式，它會在上面註冊表的位置新建一個qq.exe項，再在這個項下面新建一個字串的鍵　debugger把其值改為<code>C:\WINDOWS \SYSTEM32\VIRES.EXE</code>(這裡是病毒藏身的目錄)即可。</p><h3 id="三、玩劫持"><a href="#三、玩劫持" class="headerlink" title="三、玩劫持"></a>三、玩劫持</h3><h4 id="1、禁止某些程式的運行"><a href="#1、禁止某些程式的運行" class="headerlink" title="1、禁止某些程式的運行"></a>1、禁止某些程式的運行</h4><figure class="highlight plain"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\qq.exe]</div><div class="line">Debugger=123.exe</div></pre></div></div></figure><p>把上面的代碼保存為norun_qq.reg，雙擊導入註冊表，每次雙擊運行QQ的時候，係統都會彈出一個框提示說找不到QQ，原因就QQ被重定向了。如果要讓QQ繼續運行的話，把123.exe改為其安裝目錄就可以了。</p><h4 id="2、偷樑換柱惡作劇"><a href="#2、偷樑換柱惡作劇" class="headerlink" title="2、偷樑換柱惡作劇"></a>2、偷樑換柱惡作劇</h4><p>每次我們按下CTRL+ALT+DEL鍵時，都會彈出任務管理器，想不想在我們按下這些鍵的時候讓它彈出命令提示符視窗，下面就教你怎麼玩：</p><figure class="highlight plain"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\taskmgr.exe]</div><div class="line">Debugger=D:\WINDOWS\pchealth\helpctr\binaries\mconfig.exe</div></pre></div></div></figure><p>將上面的代碼另存為 task_cmd.reg，雙擊導入註冊表。按下那三個鍵打開了”係統配置實用程式”。</p><h4 id="3、讓病毒迷失自我"><a href="#3、讓病毒迷失自我" class="headerlink" title="3、讓病毒迷失自我"></a>3、讓病毒迷失自我</h4><p>同上面的道理一樣，如果我們把病毒程式給重定向了，是不是病毒就不能運行了，答案是肯定的。</p><figure class="highlight plain"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\sppoolsv.exe]</div><div class="line">Debugger=123.exe</div><div class="line"></div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\logo_1.exe]</div><div class="line">Debugger=123.exe</div></pre></div></div></figure><p>上面的代碼是以金豬病毒和威金病毒為例，這樣即使這些病毒在係統啓動項裡面，即使隨係統運行了，但是由於映像劫持的重定向作用，還是會被係統提示無法找到病毒文件(這裡是logo_1.exe和sppoolsv.exe)。</p><h3 id="四、防劫持"><a href="#四、防劫持" class="headerlink" title="四、防劫持"></a>四、防劫持</h3><h4 id="1、權限限制法"><a href="#1、權限限制法" class="headerlink" title="1、權限限制法"></a>1、權限限制法</h4><p>打開註冊表編輯器，定位到</p><pre><code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\</code></pre><p>，選中該項，右鍵→權限→高級，取消 administrator 和 system 用戶的寫權限即可。</p><h4 id="2、快刀斬亂麻法"><a href="#2、快刀斬亂麻法" class="headerlink" title="2、快刀斬亂麻法"></a>2、快刀斬亂麻法</h4><p>打開註冊表編輯器，定位到</p><pre><code>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\</code></pre><p>，把”Image File Execution Options”項刪除即可。</p><p>總結：以上關於映射劫持的解析與利用但願對於大家查殺木馬病毒有所幫助，也希望大家能夠挖掘更多更實用的功能。</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://github.com/wings27/blogs/blob/master/%E5%88%A9%E7%94%A8Windows%E6%98%A0%E5%83%8F%E5%8A%AB%E6%8C%81%E5%AE%9E%E7%8E%B0%E9%BB%98%E8%AE%A4%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9B%BF%E6%8D%A2.md" rel="external nofollow noopener noreferrer" target="_blank">利用 Windows 映像劫持实现默认程序的替换</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="https://msdn.microsoft.com/en-us/library/a329t4ed%28VS.71%29.aspx" rel="external nofollow noopener noreferrer" target="_blank">Launching the Debugger Automatically - MSDN</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在不暴力替換下，將預設開啟程式(如 notepad)替換並記錄何為映像劫持(IFEO)。&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
      <category term="crack" scheme="https://ppundsh.github.io/tags/crack/"/>
    
      <category term="VScode" scheme="https://ppundsh.github.io/tags/VScode/"/>
    
  </entry>
  
  <entry>
    <title>翻牆歷史</title>
    <link href="https://ppundsh.github.io/posts/ffce/"/>
    <id>https://ppundsh.github.io/posts/ffce/</id>
    <published>2018-04-17T17:04:38.000Z</published>
    <updated>2018-04-18T13:18:47.291Z</updated>
    
    <content type="html"><![CDATA[<p>看到令人懷念的文章，感謝此文作者，後續有機會我會再編輯下去。<br><a id="more"></a></p><p>來源：<a href="https://blog.yandere.moe/moe/gfw-vs-proxy/97.html" rel="external nofollow noopener noreferrer" target="_blank">牆與梯的較量——那些年我們一起用過的翻牆手段</a></p><p>在某個 Telegram 群討論到了現在很多 10 多歲的年輕人都學會翻牆了，想起我小的時候，大概也是在 10 歲左右第一次翻牆。作為經歷過多次牆與梯的升級的網蟲，把這個寫下來也算是一個對童年的回憶了……</p><p>HTTP 代理 &amp; SOCKS 代理年代：</p><p>早期的牆遮罩網站是通過 IP 位址和 DNS 污染進行定點遮罩，那時候被遮罩的網站也沒像現在這麼多。大部分被遮罩的都是法輪功的網站，一般人也用不到。那個時候可以很容易的通過 HTTP 代理進行審查規避。那個時候有一款瀏覽器不知道大家聽說過沒，叫 MyIE，有一個很方便的切換代理功能，由於作者是法輪功成員，他開發的瀏覽器的主頁也有提供很多 HTTP 代理來翻牆用（BTW：根據網路上的傳言，作者已經死於 2002.5.13。）不過根據這個軟件開發的日期以及維基百科，可能在上個世紀 90 年代就已經有牆了。不過我第一次上網是 2004 年，比這更之前的我是不知道了，歡迎有更老網齡的網蟲在評論區回憶一下？</p><p>早期的翻牆軟件——代理獵手（Proxy Hunter）：</p><p>確切地說這個並不能被稱為翻牆軟件，這只是一個幫助你搜索可用 HTTP 代理的軟件，利用搜索出來的 HTTP 代理來完成翻牆操作。</p><p>網頁代理：</p><p>相信這個大家也用過，一個網站，把網址輸入進去就能透過代理訪問被遮罩的網站了。</p><p>現在情況：</p><p>在不知道哪次的 GFW 升級過程中，HTTP 代理和 SOCKS 代理已經完全可以被檢測（畢竟沒有加密）並阻斷，於是這種翻牆手段只能留在我們的回憶中了。。。</p><p>至於網頁代理，聰明的開發者想到了一個方法——在發送資料包之前將網頁內容 BASE64 編碼了一下，這樣 GFW 就無法探測被封鎖的關鍵字了，這個方法在 GFW 的又一次升級之後而成為了歷史…</p><p>修改 DNS 時代：</p><p>同樣是在牆的早期階段，GFW 還沒有解析 DNS 資料包的能力，而且那時候 ISP 也比較流氓。比如在你訪問一個不存在的域名的時候，（北京地區）聯通會把你劫持到 “北京寬帶網 BBN” 這個網站的一個廣告頁面，然後展示給你一些很黃很暴力的廣告。那時候就有人提議修改 DNS，不再使用 ISP 提供的 DNS。</p><p>208.67.222.222 / 208.67.220.220</p><p>8.8.8.8 / 8.8.4.4</p><p>這兩組神聖的 IP 還有人記得麼？修改用境外的 DNS 之後也起到了一定的翻牆效果。</p><p>現在情況：</p><p>GFW 的某次升級之後可以解析並篡改 DNS 包了，於是此方法失效，淡出了人們的視線中…</p><p>自由門 &amp; 無界瀏覽時代：</p><p>之後不知道從什麼時候開始，各位的郵箱裡就經常收到一個名為《退 X 保平安》的郵件，裡面附帶了一個自由門軟件。於是自由門這個翻牆軟件開始流行了起來。（題外話：是不是你的第一次翻牆就是用的自由門？）</p><p>無界瀏覽和自由門一樣，都是法輪功組織開發的</p><p>當然這個軟件不僅僅只有中國用戶在使用，在其他國家如：伊朗、敘利亞、阿聯酋等有網路審查國家的用戶也有在用。</p><p>現在情況：</p><p>仍然處於活躍開發過程中，但是身邊用的人基本沒有了，這個軟件自帶內牆（遮罩法輪功組織不喜歡的網站、色情網站等）、不開源、連接不穩定而飽受詬病而漸漸的消失在了人們的記憶中…</p><p>HTTPS 代理年代：</p><p>HTTPS 代理，比 HTTP 代理多了個 S，代表的東西可就大不同了。那時候的 GFW 是無法識別 SSL 流量的，所以網頁代理以及 HTTP 代理都在這個 S 的光環下復活了。</p><p>現在情況：</p><p>仍然可用，比如石斑魚的翻牆軟件就是利用 squid 產生一個 HTTPS 代理進行翻牆的，網頁代理也藏在加密的 HTTPS 之後，這對 GFW 的維護工作產生了不利的影響，因為不像 HTTP 那樣可以直接獲取到內容。不過在某次的 GFW 升級之後，特徵比較明顯的 HTTPS 代理被 active probe 檢測到而遮罩，只剩下那些藏在子目錄的網頁代理以及增加了認證（不管是證書認證還是密碼認證）的 HTTPS 代理可用…</p><p>修改 hosts 文件年代：</p><p>在上面提到的修改 DNS 規避審查的方法已經無效了，又有別有用心的群眾找到了一些網站可用的 IP，並修改到 hosts 文件進行翻牆。這種方法實際是鑽了個 GFW 沒有發現這些 IP 的空子。</p><p>現在情況：</p><p>事實上這個方法輝煌了 2 次，第一次是把網站的 IP 放到 hosts 裡然後通過 HTTPS 訪問，之後 GFW 以主動收集 IP 並遮罩的方法廢掉了此方法。第二次是 CDN 的普及，很多網站用了如 CloudFlare 的 CDN，一個 IP 被封了，可以 hosts 到另一個 CloudFlare 的 IP 然後以 HTTPS 繼續訪問。隨後在 GFW 的某次升級後可以檢測到證書 SNI 並阻斷之後淡出了人們的視線…</p><p>PPTP 年代：</p><p>Windows 和 iOS 等系統自帶支援的 VPN 協定——PPTP。可以說是最便捷的方式了，不用下載額外的軟件，只需要一個 IP、用戶名、密碼就可以翻牆。不過這麼便捷的翻牆軟件朝廷肯定是看不下去的啦。。。</p><p>現在情況：</p><p>PPTP 已經徹底被干擾，無論你怎麼設置都是連接不上的哦，PPTP 實在是死的不能再死了，而且加密強度也不高，而漸漸的被人們所遺忘…</p><p>SSH 翻牆年代：</p><p>不知道從什麼時候開始，各路折騰 VPS 的折騰黨就猛然發現：SSH 可不僅僅是安全管理伺服器的工具，更可以用於翻牆。</p><p>於是 SSH 翻牆的方法在一瞬間火了起來。</p><p>ssh -qTfnN -D 7070 <a href="mailto:fq@blog.yandere.moe" rel="external nofollow noopener noreferrer" target="_blank">fq@blog.yandere.moe</a> &lt;– 這是我學會的第一句比較長的 linux 命令</p><p>現在情況：</p><p>在某次的 GFW 升級後，可以根據流量大小識別你是在管理伺服器還是在翻牆。之後，那時候還各種百度谷歌搜索免費 SSH 賬號和國外的提供免費空間 + SSH 的平台，翻牆圈子裡互相幫助共用 SSH 賬號的場景就一去不復返了…</p><p>賽風年代：</p><p>賽風是多倫多大學公民實驗室開發的一款開源翻牆軟件，基本原理就是利用打了混淆補丁的 SSH 進行翻牆。發郵件給賽風的郵箱或者去官網下載就能獲得該軟件了。</p><p>(圖為舊版賽風)</p><p>支援很多國家的伺服器</p><p>現在情況：</p><p>仍然可用，速度一般，比較穩定，身邊很多人在用這個免費且開源的翻牆軟件。客官不妨下一份留作備用？</p><p>西廂計畫：</p><p>這個可以說是真正的翻牆軟件而非代理軟件，因為這款軟件並沒有使用任何代理伺服器進行翻牆。相反，這個軟件的開發人員發現了牆在編寫的時候的一些漏洞，並利用這個漏洞翻牆。</p><p>現在情況：</p><p>由於西廂計畫宗旨是說明這個漏洞，而不是一款可以大規模使用的翻牆軟件，所以使用的人很少，而且需要懂一些 Linux 才可以使它工作。在某次的 GFW 核心模組升級之後失效。</p><p>GoAgent、XXNET 翻牆：</p><p>GoAgent 是一個可以運行在雲平台上的代理軟件，大多數用在 Google Appspot 上，也是很老牌的。那時候 Google 還沒有被遮罩，很多人申請一堆 appspot 然後 GoAgent 負載均衡翻牆，然後小圈子裡共用高速的 IP 位址。然後有了另一個 fork 叫 XXNET，自帶掃瞄 IP 的功能以及集成了好心人提供的節點，也是基於 GoAgent 的。</p><p>現在情況：</p><p>隨著 Google 所有 IP 被 GFW 河蟹，這種方法也消失在了歷史的長河中。</p><p>Lantern、FireFly、Meek 年代：</p><p>自從很多大型服務上了 CDN 業務（Amazon、Azure 等），一群充滿研究精神的人發明了一個新的方法 “依附的自由（Collateral Freedom）”，通過將目標位址放入 CDN 服務的 Host 頭中，GFW 只能檢測到訪問了 CDN，而無法檢測到真正的目標位址。而很多網站都在使用 CDN，無法將所有的 CDN 都牆了。</p><p>目前使用本方法的：Lantern、FireFly、Tor Browser – Meek</p><p>fqrouter 翻牆：</p><p>fqrouter，顧名思義 翻牆路由器。是一個在 Android 平台的翻牆軟件，使用 GoAgent 進行翻牆。就連人民日報記者都在用這款軟件。</p><p>現在情況：</p><p>其作者在 Twitter 上宣佈停止開發 fqrouter 了。感謝 fqrouter 作者為翻牆事業作出的貢獻：）</p><p>OpenVPN 年代：</p><p>牆再怎麼升級也擋不住嚮往自由的人們，於是開源軟件 OpenVPN 又成為翻牆的主力軍。OpenVPN 支援高強度的加密，不過就是特徵太明顯了，你看，又被遮罩了。。。</p><p>現在情況：</p><p>差不多已經沒辦法用了，因為特徵是在太明顯了，GFW 很輕鬆就會探測到 OpenVPN 伺服器然後加以封鎖。不過通過修改配置文件或加混淆補丁等方法還是可以用的。</p><p>Cisco AnyConnect 年代：</p><p>雖然 AnyConnect 和 OpenVPN 一樣，有著很明顯的特徵，但是 AnyConnect 被很多跨國大公司所使用，所以 GFW 也不敢那麼草率的遮罩掉 AnyConnect。也是一種 “依附的自由”</p><p>現在情況：</p><p>截至目前仍然可用，不過配置起來太麻煩。少數技術流會用這個翻牆…</p><p>VPNGate 年代：</p><p>說到 VPNGate，不得不提到 SoftEther VPN，很早之前這個 SoftEther 提供一個日本的學術 VPN，當然在天朝就是用於翻牆了。可能是受到了 SoftEther 的啟發，VPNGate 這個軟件被日本築波大學開發了出來，準確地說 VPNGate 是 SoftEther VPN 的一個插件，用了 SoftEther VPN 的 HTTPS 流量模仿。</p><p>現在情況：</p><p>在時斷時續中仍然堅挺，可以作為備用使用。不過要記得更新為最新版本哦。</p><p>後起之秀——Shadowsocks、V2Ray、ShadowsocksR、ShadowsocksRR…</p><p>Shadowsocks：相信大家都不陌生，作者 clowwindy 是全國首例因為開發翻牆軟件被喝茶的。之後專案交由另外的人維護。（向 clowwindy 致敬）</p><p>V2Ray：在 Shadowsocks 作者被喝茶之後由一名在國外的華裔程式員開發，目的是翻越防火長城，是一個定製性很高的翻牆軟件，算是一個 “翻牆框架”。基於這個框架你可以開發出屬於自己的翻牆協定。目前支援 VMess 協定以及 Shadowsocks 協定、支援流量混淆、支援 KCP。就是配置起來麻煩點，但是配置好之後很好用。</p><p>ShadowsocksR(R)：是一個 Shadowsocks 的 fork，作者說 ShadowsocksR 的目的是在於加強混淆以應對 QoS。ShadowsocksRR 是在 ShadowsocksR 作者停止更新之後的另一個 fork，目前觀望中…</p><p>結尾：</p><p>如果有發現有缺少的在記憶中的翻牆軟件可以留言補充哦。</p><p>翻牆的時候不要忘記那些曾經為了自由的網路而默默付出的人們</p><p>即使再高的牆也阻止不了追求自由的人們，希望我們能看到真正的互聯網。</p><p>Across the Great Wall we can reach every corner in the world.</p><p>1.HTTPS 代理也曾很流行，直到 GFW 能是別 SNI 之後才消停。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;看到令人懷念的文章，感謝此文作者，後續有機會我會再編輯下去。&lt;br&gt;
    
    </summary>
    
    
      <category term="GFW" scheme="https://ppundsh.github.io/tags/GFW/"/>
    
  </entry>
  
  <entry>
    <title>微軟開發的工具</title>
    <link href="https://ppundsh.github.io/posts/1bae/"/>
    <id>https://ppundsh.github.io/posts/1bae/</id>
    <published>2018-04-17T17:04:38.000Z</published>
    <updated>2018-04-20T07:11:21.225Z</updated>
    
    <content type="html"><![CDATA[<p>微軟自身常常有一些很好用的工具們，開一篇獨立記錄。<br>主要來自 <a href="https://docs.microsoft.com/zh-tw/sysinternals/" rel="external nofollow noopener noreferrer" target="_blank">Windows Sysinternals 的介紹網站</a>, 再多補充一些自已有在用的。</p><p><a href="https://docs.microsoft.com/zh-tw/sysinternals/learn/troubleshooting-book" rel="external nofollow noopener noreferrer" target="_blank">Troubleshooting with the Windows Sysinternals Tools</a> 微軟的書<br><a id="more"></a></p><h1 id="Sysinternals"><a href="#Sysinternals" class="headerlink" title="Sysinternals"></a>Sysinternals</h1><p>Process Explorer</p><h2 id="process-thread-viewer"><a href="#process-thread-viewer" class="headerlink" title="process/thread viewer"></a>process/thread viewer</h2><p><a href="https://docs.microsoft.com/zh-tw/sysinternals/downloads/process-explorer" rel="external nofollow noopener noreferrer" target="_blank">管方</a><br>更強大的工作管理員，可以查看程式樹、Dll 載入狀況、不明程式的 PID 、該程式開啟的檔案、開啟方式、註冊的機碼等。<br>可以取代系統原先工作管理員<br>Options→Configure Symbols 1<br>srv”c:\symbols\publics*<a href="https://msdl.microsoft.com/download/symbols" rel="external nofollow noopener noreferrer" target="_blank">https://msdl.microsoft.com/download/symbols</a></p><h2 id="Process-Minitor"><a href="#Process-Minitor" class="headerlink" title="Process Minitor"></a>Process Minitor</h2><p>file/registry/process/thread tracing<br><a href="https://docs.microsoft.com/zh-tw/sysinternals/downloads/procmon" rel="external nofollow noopener noreferrer" target="_blank">官網</a><br>即時顯示監控 registry 、文件和線程活動</p><h2 id="Autoruns"><a href="#Autoruns" class="headerlink" title="Autoruns"></a>Autoruns</h2><p>顯示所有自動運行的程式<br><a href="https://docs.microsoft.com/zh-tw/sysinternals/downloads/autoruns" rel="external nofollow noopener noreferrer" target="_blank">官網</a></p><h2 id="SigCheck"><a href="#SigCheck" class="headerlink" title="SigCheck"></a>SigCheck</h2><p>顯示檔案的版本訊息<br>官網</p><h2 id="PsExec"><a href="#PsExec" class="headerlink" title="PsExec"></a>PsExec</h2><p>execute processes remotely or in the system account<br>官網</p><h2 id="Psping"><a href="#Psping" class="headerlink" title="Psping"></a>Psping</h2><p>execute processes remotely or in the system account<br>官網</p><h2 id="TcpView"><a href="#TcpView" class="headerlink" title="TcpView"></a>TcpView</h2><p>顯示 TCP/IP endpoints<br>官網</p><h2 id="Strings"><a href="#Strings" class="headerlink" title="Strings"></a>Strings</h2><p>dumps printable strings in any file<br>官網</p><h2 id="ADInsight"><a href="#ADInsight" class="headerlink" title="ADInsight"></a>ADInsight</h2><p>real time LDAP (Active Directory) monitor<br>官網</p><h2 id="Zoomit"><a href="#Zoomit" class="headerlink" title="Zoomit"></a>Zoomit</h2><p><a href="https://docs.microsoft.com/en-us/sysinternals/downloads/zoomit" rel="external nofollow noopener noreferrer" target="_blank">官方</a><br>可隨時放大、縮小螢幕</p><h2 id="PsKill"><a href="#PsKill" class="headerlink" title="PsKill"></a>PsKill</h2><p>官方<br>可以遠端關閉程式</p><h1 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h1><h2 id="Kernrate"><a href="#Kernrate" class="headerlink" title="Kernrate"></a>Kernrate</h2><p>sample-based system profiler<br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=24853" rel="external nofollow noopener noreferrer" target="_blank">官網</a>，參考 <sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br>直接執行後就會開始記錄 CPU 使用率，跑一段時間後用 ctrl-c 就會停止執行並印出它所記錄的 CPU 使用率<br>官網只有 x86 和 IA64 ，不能在 x64 運行</p><h2 id="Device-Console"><a href="#Device-Console" class="headerlink" title="Device Console"></a>Device Console</h2><p><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/devcon" rel="external nofollow noopener noreferrer" target="_blank">官網</a>，<a href="https://biosengineer.blogspot.com/2018/01/devconexe-device-manager.html" rel="external nofollow noopener noreferrer" target="_blank">作者</a><br>命令列版的裝置管理員。<br>一些基本的指令操作:</p><p>先找你要開關的 Device 的 HWID(我是存到一個文字檔慢慢找):<br>    devcon hwids * &gt; D:\hwids.txt<br>使用底下指令去 disable , 記得在 HW ID 前面加 @<br>    devcon /r disable “@ACPI\DELL0812\3&amp;31FF937C&amp;0”<br>使用底下指令去 enable, 記得在 HW ID 前面加 @，然後 HWID 要用 “ “ 包起來.<br>    devcon /r enable “@ACPI\DELL0812\3&amp;31FF937C&amp;0”<br>使用底下指令去重新 scan hardware<br>    devcon rescan<br>使用底下指令可以做重新開機動作<br>    devcon reboot<br>停用網卡範例</p><p>開啟命令提示字元，輸入： DevCon find PCI*<br>記下您要停用的網路卡的識別碼，例如底下<br>    PCI\VEN_14E4&amp;DEV_4319&amp;SUBSYS_00051028&amp;REV_02\4&amp;2FA23535&amp;0&amp;18F0<br>您只要記住 DEV_4319<br>輸入：<br>    DevCon disable DEV_4319<br>按下 Enter, 會出現底下訊息<br>    PCI\VEN_14E4&amp;DEV_4319&amp;SUBSYS_00051028&amp;REV_02\4&amp;2FA23535&amp;0&amp;18F0: Disabled<br>    1 device(s) disabled.<br>啟用則輸入：<br>    DevCon enable DEV_4319<br>按下 Enter, 會出現底下訊息<br>    PCI\VEN_14E4&amp;DEV_4319&amp;SUBSYS_00051028&amp;REV_02\4&amp;2FA23535&amp;0&amp;18F0: Enabled<br>    1 device(s) enabled.</p><h2 id="WinDbg"><a href="#WinDbg" class="headerlink" title="WinDbg"></a>WinDbg</h2><p>Debugging Tools for Windows<br><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/" rel="external nofollow noopener noreferrer" target="_blank">官網</a><br>會獨立一篇</p><h2 id="Mouse-Without-Borders"><a href="#Mouse-Without-Borders" class="headerlink" title="Mouse Without Borders"></a>Mouse Without Borders</h2><p><a href="https://www.microsoft.com/en-us/download/details.aspx?id=35460" rel="external nofollow noopener noreferrer" target="_blank">官方</a><br>可以讓多台電腦在可連通的網路環境下共用滑鼠、剪貼簿等，常用情境是自已的筆電帶到公司時。<br>有時會失效就是了，可能和我用的網路環境有關。</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/symbol-path" rel="external nofollow noopener noreferrer" target="_blank">https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/symbol-path</a> ↩</span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;">查詢 kernel module CPU 使用率的好幫手 – Kernrate ↩</span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="http://eeepage.info/windbg-analyze/" rel="external nofollow noopener noreferrer" target="_blank">http://eeepage.info/windbg-analyze/</a> ↩</span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;">藍屏分析】Debugging Tools for Windows 10 - 讓你從此看到藍屏不再害怕 ↩</span><a href="#fnref:4" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;微軟自身常常有一些很好用的工具們，開一篇獨立記錄。&lt;br&gt;主要來自 &lt;a href=&quot;https://docs.microsoft.com/zh-tw/sysinternals/&quot; rel=&quot;external nofollow noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Windows Sysinternals 的介紹網站&lt;/a&gt;, 再多補充一些自已有在用的。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/zh-tw/sysinternals/learn/troubleshooting-book&quot; rel=&quot;external nofollow noopener noreferrer&quot; target=&quot;_blank&quot;&gt;Troubleshooting with the Windows Sysinternals Tools&lt;/a&gt; 微軟的書&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
  </entry>
  
  <entry>
    <title>CISCO 考試備忘</title>
    <link href="https://ppundsh.github.io/posts/c7f3/"/>
    <id>https://ppundsh.github.io/posts/c7f3/</id>
    <published>2018-04-17T17:04:38.000Z</published>
    <updated>2018-04-24T22:24:36.846Z</updated>
    
    <content type="html"><![CDATA[<p>主要記錄一些背誦性的網路知識<br><a id="more"></a></p><hr><table><thead><tr><th>名稱</th><th style="text-align:center">IP</th><th style="text-align:center">種類</th><th style="text-align:center">Port號</th></tr></thead><tbody><tr><td>GLBP</td><td style="text-align:center">無</td><td style="text-align:center">UDP</td><td style="text-align:center">3222</td></tr><tr><td>HSRP</td><td style="text-align:center">224.0.0.2</td><td style="text-align:center">UDP</td><td style="text-align:center">1985</td></tr><tr><td>VRRP</td><td style="text-align:center">224.0.0.18</td><td style="text-align:center">UDP</td><td style="text-align:center">112</td></tr><tr><td>GLBP</td><td style="text-align:center">224.0.0.102</td><td style="text-align:center">UDP</td><td style="text-align:center">3222</td></tr><tr><td>EIGRP</td><td style="text-align:center">224.0.0.10</td><td style="text-align:center">directly</td><td style="text-align:center">88</td></tr><tr><td>RADIUS</td><td style="text-align:center">無</td><td style="text-align:center">UDP</td><td style="text-align:center">1812</td></tr><tr><td>RIPv1</td><td style="text-align:center">224.0.0.9</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>RIPv2</td><td style="text-align:center">224.0.0.5</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td>OSPF</td><td style="text-align:center">224.0.0.6</td><td style="text-align:center"></td></tr></tbody></table><hr><table><thead><tr><th>協定</th><th>maximum</th><th>minimum</th></tr></thead><tbody><tr><td>802.1Q</td><td>1522bytes</td><td>68bytes</td></tr></tbody></table><hr><table><thead><tr><th>PAgP Channel Mode</th><th>On</th><th>Auto</th><th>Desirable</th></tr></thead><tbody><tr><td>On</td><td>O</td><td>X</td><td>X</td></tr><tr><td>Auto</td><td>X</td><td>X</td><td>O</td></tr><tr><td>Desirable</td><td>X</td><td>O</td><td>O</td></tr></tbody></table><hr><table><thead><tr><th>LACP Channel Mode</th><th>On</th><th>Passive</th><th>Active</th></tr></thead><tbody><tr><td>On</td><td>O</td><td>X</td><td>X</td></tr><tr><td>Passive</td><td>X</td><td>X</td><td>O</td></tr><tr><td>Active</td><td>X</td><td>O</td><td>O</td></tr></tbody></table><hr><p>Open System Interconnection</p><table><thead><tr><th>OSI 七層</th><th>對應協議</th><th>功能</th><th>資料</th></tr></thead><tbody><tr><td>應用層 Application Layer</td><td>HTTP、SMTP、SNMP、FTP、Telnet、SIP、SSH、NFS、RTSP、XMPP、Whois、ENRP</td><td>檔安傳輸、Email</td><td>Data</td></tr><tr><td>表現層 Presentation Layer</td><td>TIFF、GIF、JPEG、PICT、ASCII、EBCDIC、encryption、MPEG、MIDI、HTML、XDR、ASN.1、SMB、AFP、NCP</td><td>資料格式化、代碼轉換</td><td>Data</td></tr><tr><td>會議層 Session Layer</td><td>SQL、NFS、SCP、ASP、ASAP、SSH、ISO 8327 / CCITT X.225、RPC、NetBIOS、ASP、IGMP、Winsock、BSD sockets</td><td>解除或建立與別的接點的聯線</td><td>Data</td></tr><tr><td>傳輸層 Transport Layer</td><td>TCP、UDP、TLS、RTP、SCRP、SPX、ATP、IL</td><td>提供端對端的接口</td><td>資料段 Segment</td></tr><tr><td>網路層 Network Layer</td><td>IP、ICMP、RIP、OSPF、BGP、IGMP、IP SEC、OpenFlow</td><td>為封包選擇路由</td><td>封包 Packet</td></tr><tr><td>資料連結層 Data Link Layer</td><td>乙太網、權杖環、 HDLC、 訊框中繼、 ISDN、ATM、IEEE 802.11、FDDI、SLIP、CSLIP、PPP、ARP、RARP、MTU、PPTP、L2TP</td><td>傳輸有目地的訊框與錯誤檢測</td><td>訊框 Frame</td></tr><tr><td>實體層 Physical Layer</td><td>線路、無線電、光纖</td><td>以二進制資料在物理媒界上傳輸</td><td>訊框 Frame</td></tr></tbody></table><hr><table><thead><tr><th>Protocol</th><th>ID</th></tr></thead><tbody><tr><td>TCP</td><td>6</td></tr><tr><td>UDP</td><td>17</td></tr><tr><td>ICMP</td><td>1</td></tr><tr><td>EIGRP</td><td>88</td></tr><tr><td>OSPF</td><td>89</td></tr><tr><td>GRI</td><td>47</td></tr></tbody></table><hr><p><a href="https://www.techbang.com/posts/15856-network-architecture-arpanet-history-and-introduction-to-mac-ip-dns-concepts-review" rel="external nofollow noopener noreferrer" target="_blank">網路架構大概論 1－ARPANet 歷史與 MAC、IP、DNS 概念篇</a><br><a href="https://www.techbang.com/posts/15859-network-architecture-2-arpanet-history-and-introduction-to-mac-ip-dns-concepts-review" rel="external nofollow noopener noreferrer" target="_blank">網路架構大概論 2－網路模型、封包架構、解析 OSI 7 層作用</a><br><a href="https://www.techbang.com/posts/15861-3-ip-introduction-to-network-architecture-concept-classification-and-the-subnet-mask" rel="external nofollow noopener noreferrer" target="_blank">網路架構大概論 3－IP 概念、分級與子網路遮罩</a><br><a href="https://www.techbang.com/posts/15880-4-introduction-to-network-architecture-networks-underlying-frame-relay-rule" rel="external nofollow noopener noreferrer" target="_blank">網路架構大概論 4－ 網路底層的訊框傳送法則</a><br><a href="https://www.techbang.com/posts/15863-introduction-to-network-infrastructure-5-80211-and-80211a" rel="external nofollow noopener noreferrer" target="_blank">網路架構大概論 5－802.11 與 802.11a</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;主要記錄一些背誦性的網路知識&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
  </entry>
  
  <entry>
    <title>Windows 重灌後安裝的軟體</title>
    <link href="https://ppundsh.github.io/posts/8fab/"/>
    <id>https://ppundsh.github.io/posts/8fab/</id>
    <published>2018-04-17T13:16:16.000Z</published>
    <updated>2018-04-20T07:36:02.930Z</updated>
    
    <content type="html"><![CDATA[<p>記錄一下<br><a id="more"></a></p><h1 id="Adobe"><a href="#Adobe" class="headerlink" title="Adobe"></a>Adobe</h1><p><a href="https://coby17.deviantart.com/art/Elegants-Swirls-and-Flowers-90198319" rel="external nofollow noopener noreferrer" target="_blank">Elegants Swirls 筆刷</a></p><h1 id="Font"><a href="#Font" class="headerlink" title="Font"></a>Font</h1><p><a href="https://github.com/tonsky/FiraCode" rel="external nofollow noopener noreferrer" target="_blank">FiraCode</a><br><a href="https://www.google.com/get/noto/help/cjk/" rel="external nofollow noopener noreferrer" target="_blank">NotoSansCJK</a></p><h1 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h1><h1 id="Internet"><a href="#Internet" class="headerlink" title="Internet"></a>Internet</h1><p><a href="https://anydesk.com/remote-desktop" rel="external nofollow noopener noreferrer" target="_blank">AnyDesk</a><br><a href="https://www.google.com/chrome/" rel="external nofollow noopener noreferrer" target="_blank">Chrome</a><br><a href="https://simplednscrypt.org/" rel="external nofollow noopener noreferrer" target="_blank">SimpleDNSCrypt</a><br><a href="https://vivaldi.com/?lang=zh_TW" rel="external nofollow noopener noreferrer" target="_blank">Vivaldi</a><br><a href="https://www.4kdownload.com/zh-tw/" rel="external nofollow noopener noreferrer" target="_blank">4K Video Downloader</a><br><a href="https://syncthing.net/" rel="external nofollow noopener noreferrer" target="_blank">syncthing</a></p><h1 id="Media"><a href="#Media" class="headerlink" title="Media"></a>Media</h1><p><a href="http://madvr.com/" rel="external nofollow noopener noreferrer" target="_blank">madVR</a><br><a href="https://github.com/Nevcairiel/LAVFilters/releases" rel="external nofollow noopener noreferrer" target="_blank">LAVFilters</a><br><a href="https://www.svp-team.com/wiki/Download" rel="external nofollow noopener noreferrer" target="_blank">svp4</a><br><a href="https://github.com/Cyberbeing/xy-VSFilter/releases" rel="external nofollow noopener noreferrer" target="_blank">XySubFilter</a><br><a href="https://sourceforge.net/projects/mpcbe/" rel="external nofollow noopener noreferrer" target="_blank">mpc-be</a><br><a href="http://www.babelsoft.net/products/mediapreview.htm" rel="external nofollow noopener noreferrer" target="_blank">MediaPreview</a></p><h1 id="Profession"><a href="#Profession" class="headerlink" title="Profession"></a>Profession</h1><p><a href="https://displaycal.net/" rel="external nofollow noopener noreferrer" target="_blank">dispcalGUI</a><br><a href="https://anaconda.org/" rel="external nofollow noopener noreferrer" target="_blank">Anaconda</a><br><a href="https://www.bluestacks.com/" rel="external nofollow noopener noreferrer" target="_blank">BlueStacks</a><br><a href="https://nodejs.org/en/" rel="external nofollow noopener noreferrer" target="_blank">node.js</a><br><a href="https://www.screenpresso.com/" rel="external nofollow noopener noreferrer" target="_blank">Screenpresso</a><br><a href="https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html" rel="external nofollow noopener noreferrer" target="_blank">VMware</a><br><a href="https://www.sketchup.com/zh-TW" rel="external nofollow noopener noreferrer" target="_blank">Sketchup</a><br><a href="https://www.chaosgroup.com/" rel="external nofollow noopener noreferrer" target="_blank">vray</a><br><a href="https://winscp.net/eng/docs/lang:cht" rel="external nofollow noopener noreferrer" target="_blank">WinSCP</a></p><h2 id="Git-About"><a href="#Git-About" class="headerlink" title="Git About"></a>Git About</h2><p><a href="https://git-scm.com/" rel="external nofollow noopener noreferrer" target="_blank">Git</a><br><a href="https://desktop.github.com/" rel="external nofollow noopener noreferrer" target="_blank">GitHubDesktop</a><br><a href="https://www.sourcetreeapp.com/" rel="external nofollow noopener noreferrer" target="_blank">Sourcetree</a></p><h1 id="System"><a href="#System" class="headerlink" title="System"></a>System</h1><p><a href="http://www.alcpu.com/CoreTemp/" rel="external nofollow noopener noreferrer" target="_blank">Core-Temp</a><br><a href="https://www.iobit.com/en/driver-booster.php" rel="external nofollow noopener noreferrer" target="_blank">Driver booster</a><br><a href="https://cdburnerxp.se/" rel="external nofollow noopener noreferrer" target="_blank">CDBurnerXP</a><br><a href="https://www.easeus.com/partition-manager/" rel="external nofollow noopener noreferrer" target="_blank">EaseUS Partition Master</a><br><a href="https://downloadcenter.intel.com/product/66427/Intel-Extreme-Tuning-Utility-Intel-XTU-" rel="external nofollow noopener noreferrer" target="_blank">Intel XTU</a><br><a href="https://www.techpowerup.com/download/techpowerup-throttlestop/" rel="external nofollow noopener noreferrer" target="_blank">ThrottleStop</a></p><h2 id="Enhancement-amp-Cleaner"><a href="#Enhancement-amp-Cleaner" class="headerlink" title="Enhancement &amp; Cleaner"></a>Enhancement &amp; Cleaner</h2><p><a href="http://qttabbar.wikidot.com/" rel="external nofollow noopener noreferrer" target="_blank">QTTabBar</a><br><a href="https://www.iobit.com/en/advancedsystemcarefree.php" rel="external nofollow noopener noreferrer" target="_blank">Advanced SystemCare</a><br><a href="https://www.petges.lu/" rel="external nofollow noopener noreferrer" target="_blank">Attribute Changer</a><br><a href="http://www.softpointer.com/AudioShell.htm" rel="external nofollow noopener noreferrer" target="_blank">AudioShell</a><br><a href="https://autohotkey.com/" rel="external nofollow noopener noreferrer" target="_blank">AutoHotkey</a><br><a href="https://github.com/10se1ucgo/DisableWinTracking" rel="external nofollow noopener noreferrer" target="_blank">DisableWinTracking</a><br><a href="https://www.voidtools.com/" rel="external nofollow noopener noreferrer" target="_blank">Everything</a><br><a href="http://implbits.com/products/hashtab/" rel="external nofollow noopener noreferrer" target="_blank">HashTab</a><br><a href="http://keyboard-leds.com/" rel="external nofollow noopener noreferrer" target="_blank">keyboard-leds</a><br><a href="https://bitsum.com/" rel="external nofollow noopener noreferrer" target="_blank">Process Lasso</a><br><a href="https://www.codesector.com/teracopy" rel="external nofollow noopener noreferrer" target="_blank">teracopy</a><br><a href="https://www.veracrypt.fr/" rel="external nofollow noopener noreferrer" target="_blank">VeraCrypt</a><br><a href="http://antibody-software.com/web/software/software/wizmouse-makes-your-mouse-wheel-work-on-the-window-under-the-mouse/" rel="external nofollow noopener noreferrer" target="_blank">wizmouse</a></p><h2 id="更新、DotNet、DirectX"><a href="#更新、DotNet、DirectX" class="headerlink" title="更新、DotNet、DirectX"></a>更新、DotNet、DirectX</h2><p><a href="https://www.microsoft.com/zh-tw/download/details.aspx?id=25150" rel="external nofollow noopener noreferrer" target="_blank">Microsoft .NET Framework 3,5</a><br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=30653" rel="external nofollow noopener noreferrer" target="_blank">Microsoft .NET Framework 4.5</a><br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=35" rel="external nofollow noopener noreferrer" target="_blank">DirectX</a></p><h2 id="Compression"><a href="#Compression" class="headerlink" title="Compression"></a>Compression</h2><p><a href="https://www.7-zip.org/" rel="external nofollow noopener noreferrer" target="_blank">7zip</a><br><a href="http://free-sk.t-com.hr/T800soft/software/CBXShell.html" rel="external nofollow noopener noreferrer" target="_blank">CBXshell</a><br><a href="http://www.7ztm.de/" rel="external nofollow noopener noreferrer" target="_blank">7-Zip Theme Manager</a></p><h2 id="Input-methods"><a href="#Input-methods" class="headerlink" title="Input methods"></a>Input methods</h2><p><a href="D:\GitHub\Hexo\ppundsh.github.io\source\_posts\Windows-重灌後安裝的軟體.md" target="_blank" rel="noopener">Locale Emulator</a><br>語系轉換 </p><p><a href="https://github.com/EasyIME/PIME/releases/" rel="external nofollow noopener noreferrer" target="_blank">PIME</a><br>新酷音輸入法，支援蝦米輸入</p><h1 id="美化"><a href="#美化" class="headerlink" title="美化"></a>美化</h1><p><a href="https://www.rainmeter.net/" rel="external nofollow noopener noreferrer" target="_blank">Rainmeter</a><br><a href="http://www.mactype.net/" rel="external nofollow noopener noreferrer" target="_blank">MacType</a></p><h2 id="更改OEM訊息"><a href="#更改OEM訊息" class="headerlink" title="更改OEM訊息"></a>更改OEM訊息</h2><p>以下內容存成 .reg 後執行</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line"></div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\OEMInformation]</div><div class="line"><span class="string">"Manufacturer"</span>=<span class="string">"廠商"</span></div><div class="line"><span class="string">"Model"</span>=<span class="string">"型號"</span></div><div class="line"><span class="string">"SupportHours"</span>=<span class="string">"電話"</span></div><div class="line"><span class="string">"SupportURL"</span>=<span class="string">"網站"</span></div><div class="line"><span class="string">"logo"</span>=<span class="string">"D:\\Photo\\OEM.bmp"</span></div></pre></div></div></figure><h1 id="Office"><a href="#Office" class="headerlink" title="Office"></a>Office</h1><p>註冊 Emeditor 右鍵</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line">[HKEY_CLASSES_ROOT\*\shell\EmEditor]</div><div class="line"><span class="string">"Icon"</span>=<span class="string">"%SystemRoot%\\notepad.exe,0"</span></div><div class="line">[HKEY_CLASSES_ROOT\*\shell\EmEditor\Command]</div><div class="line">@=<span class="string">"D:\\Apps\\EmEditor\\EmEditor.exe %1"</span></div></pre></div></div></figure><p>註冊 VScode 右鍵<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line"></div><div class="line">[HKEY_CLASSES_ROOT\*\shell\Open with VS Code]</div><div class="line">@=<span class="string">"Edit with VS Code"</span></div><div class="line"><span class="string">"Icon"</span>=<span class="string">"D:\\Apps\\VSCode\\Code.exe,0"</span></div><div class="line"></div><div class="line">[HKEY_CLASSES_ROOT\*\shell\Open with VS Code\<span class="built_in">command</span>]</div><div class="line">@=<span class="string">"\"D:\\Apps\\VSCode\\Code.exe\" \"%1\""</span></div><div class="line"></div><div class="line">[HKEY_CLASSES_ROOT\Directory\shell\vscode]</div><div class="line">@=<span class="string">"Open Folder as VS Code Project"</span></div><div class="line"><span class="string">"Icon"</span>=<span class="string">"\"D:\\Apps\\VSCode\\Code.exe\",0"</span></div><div class="line"></div><div class="line">[HKEY_CLASSES_ROOT\Directory\shell\vscode\<span class="built_in">command</span>]</div><div class="line">@=<span class="string">"\"D:\\Apps\\VSCode\\Code.exe\" \"%1\""</span></div><div class="line"></div><div class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\vscode]</div><div class="line">@=<span class="string">"Open Folder as VS Code Project"</span></div><div class="line"><span class="string">"Icon"</span>=<span class="string">"\"D:\\Apps\\VSCode\\Code.exe\",0"</span></div><div class="line"></div><div class="line">[HKEY_CLASSES_ROOT\Directory\Background\shell\vscode\<span class="built_in">command</span>]</div><div class="line">@=<span class="string">"\"D:\\Apps\\VSCode\\Code.exe\" \"%V\""</span></div></pre></div></div></figure></p><p>映像劫持<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">Windows Registry Editor Version 5.00</div><div class="line"></div><div class="line">[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe]</div><div class="line"><span class="string">"Debugger"</span>=<span class="string">"\"D:\\Program Files\\Notepad2\\Notepad2.exe\" /z"</span></div></pre></div></div></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;記錄一下&lt;br&gt;
    
    </summary>
    
    
      <category term="APP" scheme="https://ppundsh.github.io/tags/APP/"/>
    
  </entry>
  
  <entry>
    <title>Tor 指令備忘</title>
    <link href="https://ppundsh.github.io/posts/44c2/"/>
    <id>https://ppundsh.github.io/posts/44c2/</id>
    <published>2018-04-16T20:55:45.000Z</published>
    <updated>2018-04-17T13:41:53.306Z</updated>
    
    <content type="html"><![CDATA[<p>以前一直以為 Tor 一定要配合引導，後來看到文章才知道 Tor 可以在指令模式下運作，真該早點看官方文件的…記錄一下常用的指令<br><a id="more"></a><br>安裝服務<br>    tor –service install</p><p>服務執行<br>    tor –service start</p><p>指定設定檔<br>    tor -f</p><p>開啟用批次檔(要用系統管理員權系)，另存成 .bat<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></div><div class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line"><span class="built_in">set</span> Path=TOR.exe所在的路徑</div><div class="line">::<span class="built_in">set</span> Path=%~dp0</div><div class="line"><span class="built_in">echo</span> %Path%</div><div class="line">%Path%\Tor\tor.exe --service start --defaults-torrc %Path%\Data\Tor\torrc-defaults -f %Path%\Data\Tor\torrc </div><div class="line">pause</div></pre></div></div></figure></p><p>資料來源<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>，先簡易用 Google 翻譯，有機會再調整。</p><p>COMMAND-LINE OPTIONS</p><pre><code>-h, -help    Display a short help message and exit.    幫助，可查看可用指令-f FILE    Specify a new configuration file to contain further Tor configuration options OR pass - to make Tor read its configuration from standard input. (Default: @CONFDIR@/torrc, or $HOME/.torrc if that file is not found)    指定設定檔，預設會找尋 @CONFDIR@/torrc, or $HOME/.torrc--allow-missing-torrc    Do not require that configuration file specified by -f exist if default torrc can be accessed.    如果存在預設設定檔，就忽略 -f 參數--defaults-torrc FILE    Specify a file in which to find default values for Tor options. The contents of this file are overridden by those in the regular configuration file, and by those on the command line. (Default: @CONFDIR@/torrc-defaults.)    指定一個檔案，在其中查找 Tor 選項的預設值。該檔案的內容會被常規設定檔中的內容以及命令行中的內容覆蓋。 （預設：@ CONFDIR @ / torrc-defaults。）--ignore-missing-torrc    Specifies that Tor should treat a missing torrc file as though it were empty. Ordinarily, Tor does this for missing default torrc files, but not for those specified on the command line.    指定 Tor 應該將丟失的 torrc 文件視為空文件。通常，Tor 會為缺少的預設 torrc 文件執行此操作，但不會在命令行中指定。--hash-password PASSWORD    Generates a hashed password for control port access.    為控制端口訪問生成散列密碼。--list-fingerprint    Generate your keys and output your nickname and fingerprint.    生成您的密鑰並輸出您的暱稱和指紋。--verify-config    Verify the configuration file is valid.    驗證設定檔是否有效。--service install [--options command-line options]    Install an instance of Tor as a Windows service, with the provided command-line options. Current instructions can be found at https://www.torproject.org/docs/faq#NTService    使用提供的命令行選項，將 Tor 的實例安裝為 Windows 服務。--service remove|start|stop    Remove, start, or stop a configured Tor Windows service.    刪除，啟動或停止配置的 Tor Windows 服務。--nt-service    Used internally to implement a Windows service.    在內部用於實現 Windows 服務。--list-torrc-options    List all valid options.    列出所有有效的選項。--list-deprecated-options    List all valid options that are scheduled to become obsolete in a future version. (This is a warning, not a promise.)    列出將來版本中計劃廢棄的所有有效選項。 （這是提前警告，不是保證。）--version    Display Tor version and exit.    顯示 Tor 版本並退出。--quiet|--hush    Override the default console log. By default, Tor starts out logging messages at level &quot;notice&quot; and higher to the console. It stops doing so after it parses its configuration, if the configuration tells it to log anywhere else. You can override this behavior with the --hush option, which tells Tor to only send warnings and errors to the console, or with the --quietoption, which tells Tor not to log to the console at all.    覆蓋預設控制台日誌。預設情況下，Tor 在 “通知” 級別開始記錄消息並將其發送到控制台。它在解析其配置後會停止，如果配置告訴它在其他地方記錄。您可以使用 --hush 選項覆蓋此行為，該選項告訴 Tor 僅向控制台發送警告和錯誤，或者使用 --quiet 選項，它告訴 Tor 根本不登錄控制台。--keygen [--newpass]    Running &quot;tor --keygen&quot; creates a new ed25519 master identity key for a relay, or only a fresh temporary signing key and certificate, if you already have a master key. Optionally you can encrypt the master identity key with a passphrase: Tor will ask you for one. If you don&apos;t want to encrypt the master key, just don&apos;t enter any passphrase when asked.    The --newpass option should be used with --keygen only when you need to add, change, or remove a passphrase on an existing ed25519 master identity key. You will be prompted for the old passphase (if any), and the new passphrase (if any).    When generating a master key, you will probably want to use --DataDirectory to control where the keys and certificates will be stored, and --SigningKeyLifetime to control their lifetimes. Their behavior is as documented in the server options section below. (You must have write access to the specified DataDirectory.)    To use the generated files, you must copy them to the DataDirectory/keys directory of your Tor daemon, and make sure that they are owned by the user actually running the Tor daemon on your system.    運行 “tor -keygen” 將為中繼創建一個新的 ed25519 主身份密鑰，或者只有新的臨時簽名密鑰和證書（如果您已有主密鑰）。或者，您可以使用密碼加密主身份識別碼：Tor 會要求您輸入密碼。如果您不想加密主密鑰，請在輸入密碼時不要輸入密碼。    只有在需要添加，更改或刪除現有 ed25519 主身份密鑰上的密碼時， - newpass 選項才應與 --keygen 一起使用。系統會提示您輸入舊的 passphase（如果有）和新的密碼（如果有的話）。    在生成主密鑰時，您可能需要使用 --DataDirectory 來控制密鑰和證書的存儲位置，以及 --SigningKeyLifetime 來控制它們的生命週期。它們的行為如下面的服務器選項部分所述。 （您必須具有對指定 DataDirectory 的寫入權限。）    要使用生成的文件，必須將它們複製到 Tor 守護程序的 DataDirectory/keys 目錄中，並確保它們由實際在系統上運行 Tor 守護程序的用戶擁有。--passphrase-fd FILEDES    Filedescriptor to read the passphrase from. Note that unlike with the tor-gencert program, the entire file contents are read and used as the passphrase, including any trailing newlines. Default: read from the terminal.    Filedescriptor 從中讀取密碼。請注意，與 tor-gencert 程序不同，整個文件內容都被讀取並用作密碼，包括任何尾隨的換行符。預設：從終端讀取。--key-expiration [purpose]    The purpose specifies which type of key certificate to determine the expiration of. The only currently recognised purpose is &quot;sign&quot;.    目的是指定哪種類型的密鑰證書來確定過期。目前唯一認可的目的是 “符號”。    Running &quot;tor --key-expiration sign&quot; will attempt to find your signing key certificate and will output, both in the logs as well as to stdout, the signing key certificates expiration time in ISO-8601 format. For example, the output sent to stdout will be of the form: &quot;signing-cert-expiry: 2017-07-25 08:30:15 UTC&quot;    運行 “tor -key-expiration sign” 將嘗試查找您的簽名密鑰證書，並且將在日誌以及 stdout 中輸出 ISO-8601 格式的簽名密鑰證書過期時間。例如，發送到 stdout 的輸出將採用以下格式：“signing-cert-expiry：2017-07-25 08:30:15 UTC”</code></pre><p>Other options can be specified on the command-line in the format “–option value”, in the format”option value”, or in a configuration file. For instance, you can tell Tor to start listening for SOCKS connections on port 9999 by passing –SocksPort 9999 or SocksPort 9999 to it on the command         line, or by putting “SocksPort 9999” in the configuration file. You will need to quote options with spaces in them: if you want Tor to log all debugging messages to debug.log, you will probably need to say –Log debug file debug.log.<br>其他選項可以在命令行中以 “- 選項值” 格式，“選項值” 格式或在設定檔中指定。例如，您可以通過在命令行上傳遞 –SocksPort9999 或 SocksPort 9999，或通過在設定檔中放入 “SocksPort 9999” 來指示 Tor 開始監聽端口 9999 上的 SOCKS 連接。你需引用帶有空格的選項：如果你想 Tor 把所有的調試信息記錄到 debug.log，你可能需要說 –Log 調試文件         debug.log。</p><hr><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.torproject.org/docs/tor-manual.html.en" rel="external nofollow noopener noreferrer" target="_blank">https://www.torproject.org/docs/tor-manual.html.en</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以前一直以為 Tor 一定要配合引導，後來看到文章才知道 Tor 可以在指令模式下運作，真該早點看官方文件的…記錄一下常用的指令&lt;br&gt;
    
    </summary>
    
    
      <category term="Tor" scheme="https://ppundsh.github.io/tags/Tor/"/>
    
      <category term="GFW" scheme="https://ppundsh.github.io/tags/GFW/"/>
    
  </entry>
  
  <entry>
    <title>Vim 指令</title>
    <link href="https://ppundsh.github.io/posts/6edb/"/>
    <id>https://ppundsh.github.io/posts/6edb/</id>
    <published>2018-04-16T01:21:50.000Z</published>
    <updated>2018-04-17T13:29:55.312Z</updated>
    
    <content type="html"><![CDATA[<p>記錄一下<br><a id="more"></a></p><p>顯示行數<br>    set number</p><p>隱藏行數<br>    set nonumber</p><p>刪除一行：dd</p><p>刪除一個單詞 / 游標之後的單詞剩餘部分：dw</p><p>刪除當前字符：x</p><p>游標之後的該行部分：d$</p><p>文本刪除</p><p>dd 刪除一行</p><p>d$ 刪除以當前字符開始的一行字符</p><p>ndd 刪除以當前行開始的 n 行</p><p>dw 刪除以當前字符開始的一個字</p><p>ndw 刪除以當前字符開始的 n 個字</p><p>D 與 d$ 同義</p><p>d) 刪除到下一句的開始</p><p>d} 刪除到下一段的開始</p><p>d 回車 刪除 2 行</p><p>ndw 或 ndW 刪除游標處開始及其後的 n-1 個字符。<br>d0 刪至行首。<br>d$ 刪至行尾。<br>ndd 刪除當前行及其後 n-1 行。<br>x 或 X 刪除一個字符。<br>Ctrl+u 刪除輸入方式下所輸入的文本。<br>^R 恢復 u 的操作<br>J 把下一行合併到當前行尾<br>V 選擇一行<br>^V 按下 ^V 後即可進行矩形的選擇了<br>aw 選擇單詞<br>iw 內部單詞 (無空格)<br>as 選擇句子<br>is 選擇句子 (無空格)<br>ap 選擇段落<br>ip 選擇段落 (無空格)<br>D 刪除到行尾<br>x,y 刪除與複製包含高亮區</p><p>dl 刪除當前字符（與 x 命令功能相同）<br>d0 刪除到某一行的開始位置<br>d^ 刪除到某一行的第一個字符位置（不包括空格或 TAB 字符）<br>dw 刪除到某個單詞的結尾位置<br>d3w 刪除到第三個單詞的結尾位置<br>db 刪除到某個單詞的開始位置<br>dW 刪除到某個以空格作為分隔符的單詞的結尾位置<br>dB 刪除到某個以空格作為分隔符的單詞的開始位置<br>d7B 刪除到前面 7 個以空格作為分隔符的單詞的開始位置<br>d） 刪除到某個語句的結尾位置<br>d4） 刪除到第四個語句的結尾位置<br>d（ 刪除到某個語句的開始位置<br>d） 刪除到某個段落的結尾位置<br>d{ 刪除到某個段落的開始位置<br>d7{ 刪除到當前段落起始位置之前的第 7 個段落位置<br>dd 刪除當前行<br>d/text 刪除從文本中出現 “text” 中所指定字樣的位置，<br>一直向前直到下一個該字樣所出現的位置（但不包括該字樣）之間的內容<br>dfc 刪除從文本中出現字符 “c” 的位置，一直向前直到下一個該字符所出現的位置（包括該字符）之間的內容<br>dtc 刪除當前行直到下一個字符 “c” 所出現位置之間的內容<br>D 刪除到某一行的結尾<br>d$ 刪除到某一行的結尾<br>5dd 刪除從當前行所開始的 5 行內容<br>dL 刪除直到螢幕上最後一行的內容<br>dH 刪除直到螢幕上第一行的內容<br>dG 刪除直到工作緩存區結尾的內容<br>d1G 刪除直到工作緩存區開始的內容</p><p>在 Vi 中移動游標<br>  k        上<br>h   l    左  右<br>  j        下</p><p>^        移動到該行第一個非空格的字符處<br>w        向前移動一個單詞，將符號或標點當作單詞處理<br>W        向前移動一個單詞，不把符號或標點當作單詞處理<br>b        向後移動一個單詞，把符號或標點當作單詞處理<br>B        向後移動一個單詞，不把符號或標點當作單詞處理<br>(        游標移至句首<br>)        游標移至句尾<br>{        游標移至段落開頭<br>}        游標移至段落結尾<br>H        游標移至螢幕頂行<br>M        游標移至螢幕中間行<br>L        游標移至螢幕最後行<br>0        到行首<br>$        到行尾<br>gg       到頁首<br>G        到頁末<br>行號+G   跳轉到指定行<br>n+       游標下移n行<br>n-       游標上移n行<br>Ctrl+g   查詢當前行資訊和當前文件資訊</p><p>fx       向右跳到本行字符x處（x可以是任何字符）<br>Fx       向左跳到本行字符x處（x可以是任何字符）</p><p>tx       和fx相同，區別是跳到字符x前<br>Tx       和Fx相同，區別是跳到字符x後</p><p>C-b      向上滾動一屏<br>C-f      向下滾動一屏<br>C-u      向上滾動半屏<br>C-d      向下滾動半屏<br>C-y      向上滾動一行<br>C-e      向下滾動一行</p><p>nz       將第n行滾至螢幕頂部，不指定n時將當前行滾至螢幕頂部。<br>進入和退出 Vi 命令<br>vi filename               打開或新建文件，並將游標置於第一行首<br>vi +n filename            打開文件，並將游標置於第n行首<br>vi + filename             打開文件，並將游標置於最後一行首<br>vi +/pattern filename     打開文件，並將游標置於第一個與pattern匹配的串處<br>vi -r filename            在上次正用vi編輯時發生系統崩潰，恢復filename<br>vi filename … filename  打開多個文件，依次進行編輯 </p><p>ZZ                        退出vi並保存<br>:q!                       退出vi，不保存<br>:wq                       退出vi並保存<br>重複操作<br>.        重複上一次操作<br>自動補齊<br>C-n      匹配下一個關鍵字<br>C-p      匹配上一個關鍵字<br>插入<br>o        在游標下方新開一行並將游標置於新行行首，進入插入模式。<br>O        同上，在游標上方。</p><p>a        在游標之後進入插入模式。<br>A        同上，在游標之前。</p><p>R        進入替換模式，直到按下Esc<br>set xxx  設置XXX選項。<br>行合併<br>J        把下面一行合併到本行後面<br>Vi 中查找及替換命令<br>/pattern         從游標開始處向文件尾搜索pattern<br>?pattern         從游標開始處向文件首搜索pattern<br>n                在同一方向重複上一次搜索命令<br>N                在反方向上重複上一次搜索命令<br>%                查找配對的括弧<br>:s/p1/p2/g       將當前行中所有p1均用p2替代，若要每個替換都向用戶詢問則應該用gc選項<br>:n1,n2s/p1/p2/g  將第n1至n2行中所有p1均用p2替代<br>:g/p1/s//p2/g    將文件中所有p1均用p2替換</p><p>.*[]^%~$ 在Vi中具有特殊含義，若需要查找則應該加上轉義字符”\”<br>查找的一些選項<br>設置高亮<br>:set hlsearch    設置高亮<br>:set nohlsearch  關閉高亮<br>:nohlsearch      關閉當前已經設置的高亮<br>增量查找<br>:set incsearch   設置增量查找<br>:set noincsearch 關閉增量查找<br>在 Vi 中刪除<br>x        刪除當前游標下的字符<br>dw       刪除游標之後的單詞剩餘部分。<br>d$       刪除游標之後的該行剩餘部分。<br>dd       刪除當前行。</p><p>c        功能和d相同，區別在於完成刪除操作後進入INSERT MODE<br>cc       也是刪除當前行，然後進入INSERT MODE</p><p>更改字符<br>rx       將當前游標下的字符更改為x（x為任意字符）<br>~        更改當前游標下的字符的大小寫 </p><p>鍵盤宏操作<br>qcharacter  開始錄製宏，character為a到z的任意字符<br>q           終止錄製宏<br>@character  調用先前錄製的宏</p><p>恢復誤操作<br>u        撤銷最後執行的命令<br>U        修正之前對該行的操作<br>Ctrl+R   Redo<br>在 Vi 中操作 Frame<br>c-w c-n  增加frame<br>c-w c-c  減少frame<br>c-w c-w  切換frame<br>c-w c-r  交換兩個frame<br>VIM 中的塊操作<br>Vim 支援多達 26 個剪貼板</p><p>  選塊   先用v，C-v，V選擇一塊，然後用y複製，再用p粘貼。<br>  yy     複製當前整行<br>  nyy    複製當前行開始的n行內容<br>  ?nyy   將游標當前行及其下n行的內容保存到寄存器?中，其中?為一個字母，n為一個數字<br>  ?nyw   將游標當前行及其下n個詞保存到寄存器?中，其中?為一個字母，n為一個數字<br>  ?nyl   將游標當前行及其下n個字符保存到寄存器?中，其中?為一個字母，n為一個數字<br>  ?p     將寄存器?中的內容粘貼到游標位置之後。如果?是用yy複製的完整行，<br>         則粘貼在游標所在行下面。這裡?可以是一個字母，也可以是一個數字<br>  ?P     將寄存器a中的內容粘貼到游標位置之前。如果?是用yy複製的完整行，<br>         則粘貼在游標所在行上面。這裡?可以是一個字母，也可以是一個數字<br>  ay[motion]<br>            ay$    複製游標位置到行末並保存在寄存器a中<br>            ayft   複製游標位置到當前行第一個字母t並保存在寄存器a中<br>以上指令皆可去掉 a 工作，則 y,p 對未命名寄存器工作（所有 d,c,x,y 的對象都被保存在這裡）。</p><p>剪切 / 複製 / 粘貼<br>所有刪除的內容自動被保存，可以用 p 鍵粘貼</p><p>Vi 的選項設置<br>all         列出所有選項設置情況<br>term        設置終端類型<br>ignorance   在搜索中忽略大小寫<br>list        顯示製表位(Ctrl+I)和行尾標誌($)<br>number      顯示行號<br>report      顯示由面向行的命令修改過的數目<br>terse       顯示簡短的警告資訊<br>warn        在轉到別的文件時若沒保存當前文件則顯示NO write資訊<br>nomagic     允許在搜索模式中，使用前面不帶“\”的特殊字符<br>nowrapscan  禁止vi在搜索到達文件兩端時，又從另一端開始<br>mesg        允許vi顯示其他用戶用write寫到自己終端上的資訊<br>tips<br>對代碼自動格式化 gg=G</p><p>在 vi/vim 中，跳到文件首尾快捷鍵:</p><p>文件開始: shift + g</p><p>文件結束: g g</p><p>from:<a href="http://lxs647.iteye.com/blog/1245948" rel="external nofollow noopener noreferrer" target="_blank">http://lxs647.iteye.com/blog/1245948</a></p><p>from:<a href="http://dsec.pku.edu.cn/~jinlong/vi/Vi.html" rel="external nofollow noopener noreferrer" target="_blank">http://dsec.pku.edu.cn/~jinlong/vi/Vi.html</a></p><p>from:<a href="http://www.caole.net/diary/vim.html#sec-1" rel="external nofollow noopener noreferrer" target="_blank">http://www.caole.net/diary/vim.html#sec-1</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;記錄一下&lt;br&gt;
    
    </summary>
    
    
      <category term="Vim" scheme="https://ppundsh.github.io/tags/Vim/"/>
    
  </entry>
  
  <entry>
    <title>Windows Subsystem Linux 筆記</title>
    <link href="https://ppundsh.github.io/posts/4037/"/>
    <id>https://ppundsh.github.io/posts/4037/</id>
    <published>2018-04-15T19:02:36.000Z</published>
    <updated>2018-04-20T04:40:05.120Z</updated>
    
    <content type="html"><![CDATA[<p>先記錄安裝後要裝的<br><a id="more"></a></p><p>WLS 安裝部份參考<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br>PowerShell 先以系統管理員執行：<br>    Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</p><p>##安裝 zsh </p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></div><div class="code"><pre><div class="line">$ sudo apt-get update</div><div class="line">$ sudo apt-get install zsh</div><div class="line">$ <span class="built_in">which</span> zsh</div><div class="line">/usr/bin/zsh</div><div class="line">$ chsh -s /usr/bin/zsh</div></pre></div></div></figure><p>另外，也推薦一併安裝 Oh My Zsh 以及幾個方便的套件 (zsh-completions、zsh-autosuggestions、zsh-syntax-highlighting) 來達到類似 fish shell 的命令列功能。</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">$ sh -c <span class="string">"<span class="variable">$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)</span>"</span></div><div class="line">$ git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-completions ~/.oh-my-zsh/custom/plugins/zsh-completions</div><div class="line">$ git <span class="built_in">clone</span> git://github.com/zsh-users/zsh-autosuggestions <span class="variable">$ZSH_CUSTOM</span>/plugins/zsh-autosuggestions</div><div class="line">$ git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-syntax-highlighting.git <span class="variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-syntax-highlighting</div></pre></div></div></figure><p>使用 vim 編輯 .zshrc 以啟用 plugin。同時，也建議更換 zsh 佈景主題，因為某些主題疑似因為 Powerline <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>字體所以會讓 Console Emulator 沒辦法正常顯示游標位置，至於有哪些主題是沒有問題的可以自行嘗試，這邊將以 bira 為例。</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">ZSH_THEME=<span class="string">"bira"</span></div><div class="line">......</div><div class="line">plugins=(… zsh-completions zsh-autosuggestions zsh-syntax-highlighting)</div></pre></div></div></figure><p>重新開啟 shell 後，此時我們可以透過 lsb_release -a 或是 screenfetch（安裝指令如下，可參考這篇<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>文章）驗明正身，確認這真的是一個 Ubuntu Linux 環境。</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">sudo add-apt-repository ppa:djcj/screenfetch; \</div><div class="line">sudo apt-get update; \</div><div class="line">sudo apt-get install screenfetch</div></pre></div></div></figure><p>WSL 環境下還可以直接執行 Windows 程式，甚至可以透過 pipe 做溝通。例如以下的指令會將 Linux Kernel 的版本資訊複製到 Windows 環境的剪貼簿（即 clip.exe）：<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div></pre></div><div class="code"><pre><div class="line">$ uname -a | clip.exe</div></pre></div></div></figure></p><h2 id="Cmder-設定"><a href="#Cmder-設定" class="headerlink" title="Cmder 設定"></a>Cmder 設定</h2><p>字形選用打過 Powerline patch 的字型，<a href="https://github.com/powerline/fonts/tree/master/Meslo%20Slashed" rel="external nofollow noopener noreferrer" target="_blank">Meslo LG M Regular for Powerline</a> 字型或 <a href="https://github.com/tonsky/FiraCode" rel="external nofollow noopener noreferrer" target="_blank">Fira Code</a> <sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> 都可以</p><p>[Startup] &gt; [Tasks] 頁面，新增一個 kali 的 Task。其中，-cur_console:p 參數是為了讓方向鍵能正常運作。<br>    kali.exe -cur_console:p</p><h2 id="設定-distro"><a href="#設定-distro" class="headerlink" title="設定 distro"></a>設定 distro</h2><p>在最新版本的 Windows 10 中，由於 WSL 支援多種 distro，並且這些 distro 是可以同時執行的，所以也多提供了一個工具 wslconfig.exe 可以查詢目前可用的 distro 以及設定預設的 distro。以下示範使用 wslconfig.exe /list 指令列出目前系統上所有安裝的 Linux distro。若需要修改預設設定，可以使用 /setdefault 參數。</p><p>為了支援多種 distro，有別於過去的版本只有一個 bash.exe 存在系統中，最新版本的 WSL 又做了一些改變。首先，透過 where 指令（類似 Linux 中的 which）可以看到以下這些執行檔的存放位置。其中，因為目前 Linux distro 是以 Windows App 的型式透過市集發佈的，所以 Ubuntu 與 openSUSE 會各自有一個執行檔存放在 WindowsApps資料夾底下，也是它們各自的進入點。</p><p>而這幾個執行檔又有以下的差別：</p><pre><code>bash.exe: 進入預設 Linux distro 的 bash shellwsl.exe: 進入預設 Linux distro 的 default shellubuntu.exe: 進入 Ubuntu 的 default shellopensuse-42.exe: 進入 openSUSE 的 default shell</code></pre><p>在 Ubuntu 執行的同時，於新的命令列介面執行 opensuse-42.exe 便可同時運行一個 openSUSE 環境。</p><h2 id="Powerline-安裝"><a href="#Powerline-安裝" class="headerlink" title="Powerline 安裝"></a>Powerline 安裝</h2><h3 id="Python-amp-pip"><a href="#Python-amp-pip" class="headerlink" title="Python &amp; pip"></a>Python &amp; pip</h3><p>待</p><p>參考資料：<br>-<div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://medium.com/hungys-blog/windows-subsystem-for-linux-configuration-caf2f47d0dfb" rel="external nofollow noopener noreferrer" target="_blank">Windows Subsystem for Linux 環境配置 (最新 1709 版)</a><br>-</span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="http://note.drx.tw/2016/01/screenfetch-cli.html" rel="external nofollow noopener noreferrer" target="_blank">screenfetch - 命令列 (cli) 裡的檢視系統工具 </a><br>-</span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://mogeko.github.io/2017/09/16/Fira-Code-%E4%B8%BA%E5%86%99%E7%A8%8B%E5%BA%8F%E8%80%8C%E7%94%9F%E7%9A%84%E5%AD%97%E4%BD%93/" rel="external nofollow noopener noreferrer" target="_blank">Fira Code | 為寫程序而生的字體</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;先記錄安裝後要裝的&lt;br&gt;
    
    </summary>
    
    
      <category term="CMD" scheme="https://ppundsh.github.io/tags/CMD/"/>
    
      <category term="Kali" scheme="https://ppundsh.github.io/tags/Kali/"/>
    
  </entry>
  
  <entry>
    <title>V2Ray 記錄</title>
    <link href="https://ppundsh.github.io/posts/e457/"/>
    <id>https://ppundsh.github.io/posts/e457/</id>
    <published>2018-04-15T10:52:53.000Z</published>
    <updated>2018-04-18T07:26:37.935Z</updated>
    
    <content type="html"><![CDATA[<p>本文記錄自<a href="https://toutyrater.github.io/" rel="external nofollow noopener noreferrer" target="_blank">V2Ray配置指南</a>，加上一些些個人註解，非常感謝此文的作者。<br><a id="more"></a></p><h2 id="常用-Linux-指令"><a href="#常用-Linux-指令" class="headerlink" title="常用 Linux 指令"></a>常用 Linux 指令</h2><p>查看時間<br>    date -R</p><p>更改時區<br>    cp /usr/share/zoneinfo/Asia/Taipei /etc/localtime</p><p>查看 CentOS 版本<br>    cat /etc/redhat-release</p><p>查看源<br>    cat /etc/apt/sources.list</p><p>查看自已的 ip<br>    ifconfig.me</p><hr><h2 id="常用-v2ray-指令"><a href="#常用-v2ray-指令" class="headerlink" title="常用 v2ray 指令"></a>常用 v2ray 指令</h2><p>編緝設定檔<br>    vi /etc/v2ray/config.json </p><p>控制<br>    service v2ray start|stop|status|reload|restart|force-reload</p><p>測試設定檔<br>    /usr/bin/v2ray/v2ray -test -config /etc/v2ray/config.json</p><hr><h2 id="常用-Nginx-指令"><a href="#常用-Nginx-指令" class="headerlink" title="常用 Nginx 指令"></a>常用 Nginx 指令</h2><pre><code>vi /etc/nginx/nginx.confnginx -tsystemctl reload nginxless /var/log/nginx/access.log</code></pre><p>參考[^12}</p><hr><h2 id="CentOS-7-安裝-V2Ray"><a href="#CentOS-7-安裝-V2Ray" class="headerlink" title="CentOS 7 安裝 V2Ray"></a>CentOS 7 安裝 V2Ray</h2><p>一行結束<br>    bash &lt;(curl -L -s <a href="https://install.direct/go.sh" rel="external nofollow noopener noreferrer" target="_blank">https://install.direct/go.sh</a>)</p><p>此脚本会自动安装以下文件：</p><pre><code>/usr/bin/v2ray/v2ray：V2Ray 程序；/usr/bin/v2ray/v2ctl：V2Ray 工具；/etc/v2ray/config.json：配置文件；/usr/bin/v2ray/geoip.dat：IP 数据文件/usr/bin/v2ray/geosite.dat：域名数据文件</code></pre><p>此脚本会配置自动运行脚本。自动运行脚本会在系统重启之后，自动运行 V2Ray。目前自动运行脚本只支持带有 Systemd 的系统，以及 Debian / Ubuntu 全系列。</p><p>运行脚本位于系统的以下位置：</p><pre><code>/etc/systemd/system/v2ray.service: Systemd/etc/init.d/v2ray: SysV</code></pre><p>脚本运行完成后，你需要：</p><p>编辑 /etc/v2ray/config.json 文件来配置你需要的代理方式；<br>运行 service v2ray start 来启动 V2Ray 进程；<br>之后可以使用 service v2ray start|stop|status|reload|restart|force-reload 控制 V2Ray 的运行。</p><p>將 Clinet 端貼上預設設定即可：<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    "port": 1080,  // SOCKS 代理端口，在浏览器中需配置代理并指向这个端口</div><div class="line">    "listen": "127.0.0.1",</div><div class="line">    "protocol": "socks",</div><div class="line">    "domainOverride": ["tls","http"], // “識別相應協定的流量，並根據流量內容重置所請求的目標”，簡單說這東西就是從網路流量中識別出域名。手機用戶無法使用 chinasites 時使用。</div><div class="line">    "settings": &#123;</div><div class="line">      "auth": "noauth",  //socks的認證設置，noauth 代表不認證，由於 socks 通常在客戶端使用，所以這裡不認證</div><div class="line">      "udp": true</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "vmess",</div><div class="line">    "settings": &#123;</div><div class="line">      "vnext": [&#123;</div><div class="line">        "address": "我是SERVER IP", // 服务器地址，请修改为你自己的服务器 ip 或域名</div><div class="line">        "port": 我是端口,  // 服务器端口</div><div class="line">        "users": [</div><div class="line">          &#123;</div><div class="line">            "id": "我是UUID", // 用戶 ID，必須與伺服器端配置相同</div><div class="line">            "alterID": 64 // 此處的值也應當與伺服器相同，認證用值越大會使用 V2Ray 佔用更多的記憶體。對於一般用戶來說，alterId 的值設為 30 到 100 之間應該是比較合適的。</div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;]</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outboundDetour": [&#123;</div><div class="line">    "protocol": "freedom",</div><div class="line">    "tag": "direct", //如果要使用路由，這個 tag 是一定要有的，在這裡 direct 就是 freedom 的一個標號，在路由中說 direct V2Ray 就知道是這裡的 freedom 了</div><div class="line">    "settings": &#123;&#125;</div><div class="line">  &#125;],</div><div class="line">  "routing": &#123;</div><div class="line">    "strategy": "rules",</div><div class="line">    "settings": &#123;</div><div class="line">      "domainStrategy": "IPOnDemand",</div><div class="line">      "rules": [&#123;</div><div class="line">        "type": "field",</div><div class="line">        "ip": [</div><div class="line">          "0.0.0.0/8",</div><div class="line">          "10.0.0.0/8",</div><div class="line">          "100.64.0.0/10",</div><div class="line">          "127.0.0.0/8",</div><div class="line">          "169.254.0.0/16",</div><div class="line">          "172.16.0.0/12",</div><div class="line">          "192.0.0.0/24",</div><div class="line">          "192.0.2.0/24",</div><div class="line">          "192.168.0.0/16",</div><div class="line">          "198.18.0.0/15",</div><div class="line">          "198.51.100.0/24",</div><div class="line">          "203.0.113.0/24",</div><div class="line">          "::1/128",</div><div class="line">          "fc00::/7",</div><div class="line">          <span class="string">"fe80::/10"</span></div><div class="line">        ],</div><div class="line">        "outboundTag": "direct"</div><div class="line">      &#125;]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>Sever 端<br><figure class="highlight json"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"log"</span> : &#123;</div><div class="line">    <span class="attr">"access"</span>: <span class="string">"/var/log/v2ray/access.log"</span>,</div><div class="line">    <span class="attr">"error"</span>: <span class="string">"/var/log/v2ray/error.log"</span>,</div><div class="line">    <span class="attr">"loglevel"</span>: <span class="string">"warning"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">15674</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"clients"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"12713195-43cd-4cce-8dd6-739c8244a519"</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"freedom"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;&#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outboundDetour"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"blackhole"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"blocked"</span></div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  <span class="attr">"routing"</span>: &#123;</div><div class="line">    <span class="attr">"strategy"</span>: <span class="string">"rules"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"rules"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"field"</span>,</div><div class="line">          <span class="attr">"ip"</span>: [</div><div class="line">            <span class="string">"0.0.0.0/8"</span>,</div><div class="line">            <span class="string">"10.0.0.0/8"</span>,</div><div class="line">            <span class="string">"100.64.0.0/10"</span>,</div><div class="line">            <span class="string">"127.0.0.0/8"</span>,</div><div class="line">            <span class="string">"169.254.0.0/16"</span>,</div><div class="line">            <span class="string">"172.16.0.0/12"</span>,</div><div class="line">            <span class="string">"192.0.0.0/24"</span>,</div><div class="line">            <span class="string">"192.0.2.0/24"</span>,</div><div class="line">            <span class="string">"192.168.0.0/16"</span>,</div><div class="line">            <span class="string">"198.18.0.0/15"</span>,</div><div class="line">            <span class="string">"198.51.100.0/24"</span>,</div><div class="line">            <span class="string">"203.0.113.0/24"</span>,</div><div class="line">            <span class="string">"::1/128"</span>,</div><div class="line">            <span class="string">"fc00::/7"</span>,</div><div class="line">            <span class="string">"fe80::/10"</span></div><div class="line">          ],</div><div class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"blocked"</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>UUID<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup> 生成指令<br>    cat /proc/sys/kernel/random/uuid </p><p>多IP<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">"clients": [</div><div class="line">  &#123;"id": "xxxx", "alterId": 64&#125;,</div><div class="line">  &#123;<span class="attr">"id"</span>: <span class="string">"yyyy"</span>, <span class="attr">"alterId"</span>: <span class="number">64</span>&#125;</div><div class="line">]</div></pre></div></div></figure></p><hr><h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><p>作者<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup><br>JSON 所有標點符號都要用半角符號（英文符號）<br>所有字串都要加雙引號 “ “，鍵是字串，所以鍵也要加雙引號，數字不用加雙引號<br>布爾類型也不用加雙引號，布爾值只有兩個就是 true 和 false，意思就是真和假<br>對象沒有順序，即大括弧 {} 括起來的內容順序是怎麼樣都沒關係</p><hr><h3 id="中國地區不翻牆"><a href="#中國地區不翻牆" class="headerlink" title="中國地區不翻牆"></a>中國地區不翻牆</h3><p>Client 端的 Route 改為<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></div><div class="code"><pre><div class="line">"routing": &#123;</div><div class="line">  "strategy": "rules",  //固定格式</div><div class="line">  "settings": &#123;</div><div class="line">    "domainStrategy": "IPIfNonMatch",</div><div class="line">    "rules": [</div><div class="line">      &#123;</div><div class="line">        "type": "chinasites",  //中國的網站域名</div><div class="line">        "outboundTag": "direct"</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">        "type": "chinaip",  //中國的IP</div><div class="line">        "outboundTag": "direct"</div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><hr><h3 id="廣告過濾"><a href="#廣告過濾" class="headerlink" title="廣告過濾"></a>廣告過濾</h3><p>Client 端<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></div><div class="code"><pre><div class="line">"routing": &#123;</div><div class="line">   "strategy": "rules",</div><div class="line">   "settings": &#123;</div><div class="line">     "domainStrategy": "IPIfNonMatch",</div><div class="line">     "rules": [</div><div class="line">       &#123;</div><div class="line">         <span class="attr">"domain"</span>: [</div><div class="line">           <span class="string">"tanx.com"</span>,</div><div class="line">           <span class="string">"googeadsserving.cn"</span>,</div><div class="line">           <span class="string">"baidu.com"</span></div><div class="line">         ],</div><div class="line">         <span class="attr">"type"</span>: <span class="string">"field"</span>,</div><div class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"adblock"</span>       </div><div class="line">       &#125;,</div><div class="line">       &#123;</div><div class="line">         <span class="attr">"domain"</span>: [</div><div class="line">           <span class="string">"amazon.com"</span>,</div><div class="line">           <span class="string">"microsoft.com"</span>,</div><div class="line">           <span class="string">"jd.com"</span>,</div><div class="line">           <span class="string">"youku.com"</span>,</div><div class="line">           <span class="string">"baidu.com"</span></div><div class="line">         ],</div><div class="line">         <span class="attr">"type"</span>: <span class="string">"field"</span>,</div><div class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></div><div class="line">       &#125;,</div><div class="line">       &#123;</div><div class="line">         <span class="attr">"type"</span>: <span class="string">"chinasites"</span>,</div><div class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></div><div class="line">       &#125;,</div><div class="line">       &#123;</div><div class="line">         <span class="attr">"type"</span>: <span class="string">"chinaip"</span>,</div><div class="line">         <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></div><div class="line">       &#125;</div><div class="line">     ]</div><div class="line">   &#125;</div><div class="line"> &#125;</div></pre></div></div></figure></p><p>在第一個規則中，域名包含有 tanx.com 或 baidu.com 的就會被阻止連接。在第二個規則當中，域名中包含有 amazon.com 或 microsoft.com 或 youku.com 或 baidu.com 的會直連。有一個問題大家發現沒有，兩個規則都有 baidu.com ，那麼會執行哪個呢？答案是只會執行第一個，原因是：</p><ol><li>規則是放在 routing.settings.rules 這個陣列當中，陣列的內容是有順序的，也就是說在這裡規則是有順序的，匹配規則時是從上往下匹配</li><li>當路由匹配到一個規則時就會跳出匹配而不會對之後的規則進行匹配</li></ol><hr><h3 id="inbound-outbound-和-inboundDetour-outboundDetour-的區別"><a href="#inbound-outbound-和-inboundDetour-outboundDetour-的區別" class="headerlink" title="inbound / outbound 和 inboundDetour / outboundDetour 的區別"></a>inbound / outbound 和 inboundDetour / outboundDetour 的區別</h3><p>inbound 和 inboundDetour 的格式形如：<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></div><div class="code"><pre><div class="line">"inbound": &#123;</div><div class="line">  "port": 1080,</div><div class="line">  "listen": "127.0.0.1",</div><div class="line">  "protocol": "協定名稱",</div><div class="line">  "settings": &#123;&#125;,</div><div class="line">  "streamSettings": &#123;&#125;,</div><div class="line">  "allowPassive": false,</div><div class="line">  "tag": "標識"</div><div class="line">&#125;,</div><div class="line">"inboundDetour": [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">2080</span>,</div><div class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"allowPassive"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</div><div class="line">    <span class="attr">"allocate"</span>: &#123;</div><div class="line">      <span class="attr">"strategy"</span>: <span class="string">"always"</span>,</div><div class="line">      <span class="attr">"refresh"</span>: <span class="number">5</span>,</div><div class="line">      <span class="attr">"concurrency"</span>: <span class="number">3</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">3080</span>,</div><div class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"allowPassive"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</div><div class="line">    <span class="attr">"allocate"</span>: &#123;</div><div class="line">      <span class="attr">"strategy"</span>: <span class="string">"always"</span>,</div><div class="line">      <span class="attr">"refresh"</span>: <span class="number">5</span>,</div><div class="line">      <span class="attr">"concurrency"</span>: <span class="number">3</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></div></div></figure></p><p>可以很明顯地看出來，inbound 和 inboundDetour 基本是一樣的，只不過 inboundDetour 是 inbound 的集合。還有一點不同的是 inboundDetour 多了一個 allocate 參數，這是只有在動態端口才會用到的參數，如果不配置動態端口 inboundDetour 和 inbound 無異。</p><p>即有兩點不同：</p><p>配置中 inbound 只能並且必須設置一個傳入的配置，而 inboundDetour 可以設置任意多個傳入配置<br>inboundDetour 的傳入配置多了一個給動態端口用的 allocate 參數<br>接著是傳出，outbound 和 outboundDetour 格式形如:<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></div><div class="code"><pre><div class="line">"outbound": &#123;</div><div class="line">  "sendThrough": "0.0.0.0",</div><div class="line">  "protocol": "協定名稱",</div><div class="line">  "settings": &#123;&#125;,</div><div class="line">  "tag": "標識",</div><div class="line">  "streamSettings": &#123;&#125;,</div><div class="line">  "proxySettings": &#123;</div><div class="line">    "tag": "another-outbound-tag"</div><div class="line">  &#125;  </div><div class="line">&#125;,</div><div class="line">"outboundDetour": [</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"sendThrough"</span>: <span class="string">"0.0.0.0"</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"proxySettings"</span>: &#123;</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"another-outbound-tag"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"sendThrough"</span>: <span class="string">"0.0.0.0"</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"協定名稱"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"tag"</span>: <span class="string">"標識"</span>,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;&#125;,</div><div class="line">    <span class="attr">"proxySettings"</span>: &#123;</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"another-outbound-tag"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">]</div></pre></div></div></figure></p><p>單純從配置格式來看，outbound 和 outboundDetour 沒有任何區別。但是實際上 outbound 和 outboundDetour 也有兩點不同：</p><p>配置中 outbound 只能並且必須設置一個傳出的配置，而 outboundDetour 可以設置任意多個傳出配置（實際上不可能任意多）<br>當沒有配置路由規則或者路由沒有匹配的情況下，默認由 outbound 將資料包發出去。<br>在上面給出的傳入和傳出配置格式當中，有一些參數不曾提到過，主要是因為一般情況下使用 V2Ray 默認設置即可</p><hr><h2 id="V2Ray-高級設置"><a href="#V2Ray-高級設置" class="headerlink" title="V2Ray 高級設置"></a>V2Ray 高級設置</h2><p>V2Ray 的相比其他工具有一大優點是可以自行選擇傳輸層<sup id="fnref:6"><a href="#fn:6" rel="footnote">6</a></sup>的形式，也就是說 V2Ray 伺服器和客戶端之間的傳輸的流量格式我們是可以選擇的。如我們可以選擇偽裝成 HTTP(TCP) 流量，如果使用了 mKCP 也可以偽裝成 BT 下載、視頻通話、微信視頻通話。也可以選擇使用 WebSokcs 或者 TLS。以上這個都是傳輸層的配置決定的。</p><p>V2Ray 中傳輸層配置在 transport 裡設定，也可以在各個 inbound/outbound 中的 streamSettings 設定。這兩者的區別是 inbound/outbound 的 streamSettings 只對當前的 inbound/outbound 有效 (分連接配置)，不影響其他的 inbound/outbound 的傳輸層配置，而 transport 是全局的，對整個配置所有的 inbound 和 outbound 都有效 (全局配置)，如果一個 inbound/outbound 中設定了 streamSettings，transport 的設定不會影響這個 inbound/outbound。</p><p>在本篇當中，大部分內容都涉及到了傳輸層，關於這部分內容使用的是 inbound/outbound 的 streamSettings(分連接配置)，同時也建議大家使用分連接配置。因為如果你在全局配置中開啟了偽裝功能，會導致瀏覽器或者其他軟件無法與 V2Ray 通信！這不是 bug，只是因為你設置不當。</p><hr><h3 id="Mux-多路復用-multiplexing"><a href="#Mux-多路復用-multiplexing" class="headerlink" title="Mux 多路復用 (multiplexing)"></a>Mux 多路復用 (multiplexing)</h3><p>將多個 TCP 連線合併為一條，可節省資源，提高並發能力。</p><p>Mux 只需在客戶端開啟，伺服器會自動識別，所以只給客戶端的配置。只要在 outbound 或 outboundDetour 加入 “mux”: {“enabled”: true} 即可：<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    "port": 1080, // 監聽端口</div><div class="line">    "protocol": "socks", // 入口協定為 SOCKS 5</div><div class="line">    "domainOverride": ["tls","http"],</div><div class="line">    "settings": &#123;</div><div class="line">      "auth": "noauth"  // 不認證</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "vmess", // 出口協定</div><div class="line">    "settings": &#123;</div><div class="line">      "vnext": [</div><div class="line">        &#123;</div><div class="line">          "address": "serveraddr.com", // 伺服器位址，請修改為你自己的伺服器 ip 或域名</div><div class="line">          "port": 16823,  // 伺服器端口</div><div class="line">          "users": [</div><div class="line">            &#123;</div><div class="line">              "id": "b831381d-6324-4d53-ad4f-8cda48b30811",  // 用戶 ID，必須與伺服器端配置相同</div><div class="line">              "alterId": 64 // 此處的值也應當與伺服器相同</div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "mux": &#123;"enabled": true&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><hr><h3 id="mKCP"><a href="#mKCP" class="headerlink" title="mKCP"></a>mKCP</h3><p>V2Ray 引入了 KCP 傳輸協定，稱為 mKCP，相對於常規的 TCP 來說，mKCP 在某些網路環境下具有更大的優勢，但是 mKCP 有一個很明顯的缺點就是會比 TCP 耗費更多的流量，所以請酌情使用。要瞭解的一點是，mKCP 與 KCPTUN 同樣是 KCP 協定，但兩者並不相容。<br><a href="#KCP介紹">KCP</a> 後文會再作介紹</p><p>1.1. 配置<br>mKCP 的配置比較簡單，只需在伺服器的 inbound 和 客戶端的 outbound 添加一個 streamSettings 並設置成 mkcp 即可。</p><p>1.1.1. 伺服器配置<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">16823</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"clients"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      "network": "mkcp", //此處的 mkcp 也可寫成 kcp，兩種寫法是起同樣的效果</div><div class="line">      "kcpSettings": &#123; //包含一些關於 mKCP 設置的參數</div><div class="line">        "mtu": 1350,</div><div class="line">        "tti": 20,</div><div class="line">        "uplinkCapacity": 5, //上行鏈路容量，將決定 V2Ray 向外發送資料包的速率。單位為 MB</div><div class="line">        "downlinkCapacity": 100,  //下行鏈路容量，將決定 V2Ray 接收資料包的速率。單位同樣是 MB</div><div class="line">        "congestion": false,</div><div class="line">        "readBufferSize": 1,</div><div class="line">        "writeBufferSize": 1,</div><div class="line">        "header": &#123; //對於資料包的偽裝</div><div class="line">          "type": "none" //要偽裝成的資料包類型， 可以設置成 utp、srtp、wechat-video 或者 none，這四個可以分別將 mKCP 資料偽裝成 BT 下載、視頻通話、微信視頻通話以及不進行偽裝。這裡的 type 參數，客戶端與伺服器要一致</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "freedom",</div><div class="line">    "settings": &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.2. 客戶端配置<br><figure class="highlight json"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</div><div class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"vnext"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"serveraddr.com"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">16823</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      <span class="attr">"network"</span>: <span class="string">"mkcp"</span>,</div><div class="line">      <span class="attr">"kcpSettings"</span>: &#123;</div><div class="line">        <span class="attr">"mtu"</span>: <span class="number">1350</span>,</div><div class="line">        <span class="attr">"tti"</span>: <span class="number">20</span>,</div><div class="line">        <span class="attr">"uplinkCapacity"</span>: <span class="number">5</span>,</div><div class="line">        <span class="attr">"downlinkCapacity"</span>: <span class="number">100</span>,</div><div class="line">        <span class="attr">"congestion"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">"readBufferSize"</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">"writeBufferSize"</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">"header"</span>: &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"none"</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.3. 說明<br>在上面的配置當中，與之前相比主要的變化在於多了一個 streamSettings</p><p>客戶端的上行對於伺服器來說是下行，同樣地客戶端的下行是伺服器的上行，mKCP 設置當中伺服器和客戶端都有 uplinkCapacity 和 downlinkCapacity，所以客戶端的上傳速率由伺服器的 downlinkCapacity 和客戶端的 uplinkCapacity 中的最小值決定，客戶端的下載速率也是同樣的道理。因此，建議將伺服器和客戶端的 downlinkCapacity 設成一個很大的值，然後分別修改兩端的 uplinkCapacity 以調整上下行速率。</p><p>還有一個 header 參數可以對 mKCP 進行偽裝，這是 mKCP 的一個優勢。具體的偽裝在 type 參數設置，type 可以設置成 utp、srtp、wechat-video 或者 none，這四個可以分別將 mKCP 資料偽裝成 BT 下載、視頻通話、微信視頻通話以及不進行偽裝。這裡的 type 參數，客戶端與伺服器要一致</p><p>至於上述配置裡有但是我沒有說明的參數，是 V2Ray 的默認值，我個人建議是保持默認。如果你需要瞭解或者修改，請參考手冊。</p><hr><h3 id="動態端口"><a href="#動態端口" class="headerlink" title="動態端口"></a>動態端口</h3><p>V2Ray 提供了一個叫動態端口的功能。顧名思義，就是可以動態變化端口，對於對抗封鎖或許有效</p><p>伺服器 inbound 的端口作為主端口，在 inboundDetour 開動態監聽的端口，客戶端不用額外設定。</p><p>1.1.1. 伺服器配置<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>:&#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">37192</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"clients"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"d17a1af7-efa5-42ca-b7e9-6a35282d737f"</span>,</div><div class="line">          <span class="attr">"level"</span>: <span class="number">1</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ],</div><div class="line">      <span class="attr">"detour"</span>: &#123;        </div><div class="line">        <span class="attr">"to"</span>: <span class="string">"dynamicPort"</span>   </div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"inboundDetour"</span>:[</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">      "port": "10000-20000", // 端口範圍</div><div class="line">      "tag": "dynamicPort",       </div><div class="line">      "settings": &#123;</div><div class="line">        "default": &#123;</div><div class="line">          "level": 1,</div><div class="line">          "alterId": 32</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      "allocate": &#123;            // 分配模式</div><div class="line">        "strategy": "random",  // 隨機開啟</div><div class="line">        "concurrency": 2,      // 同時開放兩個端口</div><div class="line">        "refresh": 3           // 每三分鐘刷新一次</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></div></div></figure></p><hr><h3 id="動態端口使用-mKCP"><a href="#動態端口使用-mKCP" class="headerlink" title="動態端口使用 mKCP"></a>動態端口使用 mKCP</h3><p>同 mKCP 章節，在 inbound 和 inboundDetour 加入 streamSettings 並將 network 設置為 kcp 即可。<br>伺服器配置</p><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">37192</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"clients"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"d17a1af7-efa5-42ca-b7e9-6a35282d737f"</span>,</div><div class="line">          <span class="attr">"level"</span>: <span class="number">1</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ],</div><div class="line">      <span class="attr">"detour"</span>: &#123;        </div><div class="line">        <span class="attr">"to"</span>: <span class="string">"dynamicPort"</span>   </div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      <span class="attr">"network"</span>: <span class="string">"kcp"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"inboundDetour"</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">      "port": "10000-20000", // 端口範圍</div><div class="line">      "tag": "dynamicPort",       </div><div class="line">      "settings": &#123;</div><div class="line">        "default": &#123;</div><div class="line">          "level": 1,</div><div class="line">          "alterId": 32</div><div class="line">        &#125;</div><div class="line">      &#125;,</div><div class="line">      "allocate": &#123;            // 分配模式</div><div class="line">        "strategy": "random",  // 隨機開啟</div><div class="line">        "concurrency": 2,      // 同時開放兩個端口</div><div class="line">        "refresh": 3           // 每三分鐘刷新一次</div><div class="line">      &#125;,</div><div class="line">      "streamSettings": &#123;</div><div class="line">        "network": "kcp"</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></div></div></figure><hr><h3 id="傳出代理"><a href="#傳出代理" class="headerlink" title="傳出代理"></a>傳出代理</h3><p>V2Ray 提供了傳出代理功能，利用它可以實現中轉（在沒有中轉伺服器操作權限的情況下）。</p><p>1.1. 基本傳出代理<br>使用傳出代理可以實現由一個 Shadowsocks 伺服器或者 V2Ray(VMess) 伺服器來中轉你的網路流量，中轉伺服器只能看到你加密的資料而不知道原始的資料是什麼。</p><p>以下面的配置說明，它的工作原理是：</p><ol><li>你在 Twitter 發了個帖子 f**k GFW，由 V2Ray 代理</li><li>V2Ray 客戶端收到瀏覽器發出的 f**k GFW 的帖子後，首先由對其進行加密 (VMess，id: b12614c5-5ca4-4eba-a215-c61d642116ce, 目的伺服器: 1.1.1.1:8888)</li><li>加密後資料包將被轉到 transit 這個 outbound 中，在這裡資料包又會加密一次 (Shadowsocks, password: password, 伺服器: 2.2.2.2:1024)</li><li>兩次加密後的資料包被發送到了 Shadowsocks 伺服器，該伺服器收到後解包後得到仍是加密的資料包（步驟 2 中加密後的資料包），然後將資料包發到 VMess 伺服器。即便這個 Shadowsocks 伺服器的主人是個偷窺狂魔，他也沒辦法看到你的原始資料。</li><li>VMess 伺服器收到 Shadowsocks 伺服器發來的資料包，解密得到原始的資料包，然後把你這個帖子發到 Twitter 的網站中。</li></ol><p>只要第 5 步中的伺服器是自己掌控的就不用擔心別人看到你的上網的內容。</p><p>過程說明：<br>1.我是使用者-&gt;2.我是使用者安裝在系統上的 V2Ray 客戶端，加密成 V2Ray 格式→3.V2Ray 客戶端出口再加密成 SS 格式→4.中轉的 SS server 收到後只能解密一次，就再轉送給下一站→5.V2Ray Server 收到，解密後傳出。</p><p>客戶端：</p><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    "settings": &#123; // settings 的根據實際情況修改</div><div class="line">      "vnext": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"1.1.1.1"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">8888</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span>,</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b12614c5-5ca4-4eba-a215-c61d642116ce"</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "streamSettings": &#123;</div><div class="line">      "network": "tcp"  // 此處不能是 "kcp"，設成 "kcp" 將無法聯網</div><div class="line">    &#125;,</div><div class="line">    "proxySettings": &#123;</div><div class="line">        "tag": "transit"  // 這裡的 tag 必須跟作為代理 VPS 的 tag 一致，這裡設定的是 "transit"</div><div class="line">      &#125;</div><div class="line">  &#125;,</div><div class="line">  "outboundDetour": [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"shadowsocks"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;</div><div class="line">        <span class="attr">"servers"</span>: [</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"address"</span>: <span class="string">"2.2.2.2"</span>,</div><div class="line">            <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</div><div class="line">            <span class="attr">"ota"</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">"password"</span>: <span class="string">"password"</span>,</div><div class="line">            <span class="attr">"port"</span>: <span class="number">1024</span></div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"transit"</span></div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;</div></pre></div></div></figure><p>1.2. 鏈式傳出代理<br>如果你有多個 Shadowsocks 或 VMess 賬戶，那麼你可以這樣:</p><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    "settings": &#123; // settings 的根據實際情況修改</div><div class="line">      "vnext": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"1.1.1.1"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">8888</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span>,</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b12614c5-5ca4-4eba-a215-c61d642116ce"</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "streamSettings": &#123;</div><div class="line">      "network": "tcp"  </div><div class="line">    &#125;,</div><div class="line">    "tag": "DOUS",</div><div class="line">    "proxySettings": &#123;</div><div class="line">        "tag": "DOSG"  </div><div class="line">      &#125;</div><div class="line">  &#125;,</div><div class="line">  "outboundDetour": [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"shadowsocks"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;</div><div class="line">        <span class="attr">"servers"</span>: [</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"address"</span>: <span class="string">"2.2.2.2"</span>,</div><div class="line">            <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</div><div class="line">            <span class="attr">"ota"</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">"password"</span>: <span class="string">"password"</span>,</div><div class="line">            <span class="attr">"port"</span>: <span class="number">1024</span></div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"AliHK"</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"shadowsocks"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;</div><div class="line">        <span class="attr">"servers"</span>: [</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"address"</span>: <span class="string">"3.3.3.3"</span>,</div><div class="line">            <span class="attr">"method"</span>: <span class="string">"aes-256-cfb"</span>,</div><div class="line">            <span class="attr">"ota"</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">"password"</span>: <span class="string">"password"</span>,</div><div class="line">            <span class="attr">"port"</span>: <span class="number">3442</span></div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"AliSG"</span>,</div><div class="line">      <span class="attr">"proxySettings"</span>: &#123;</div><div class="line">          <span class="attr">"tag"</span>: <span class="string">"AliHK"</span>  </div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;</div><div class="line">        <span class="attr">"vnext"</span>: [</div><div class="line">          &#123;</div><div class="line">            <span class="attr">"address"</span>: <span class="string">"4.4.4.4"</span>,</div><div class="line">            <span class="attr">"port"</span>: <span class="number">8462</span>,</div><div class="line">            <span class="attr">"users"</span>: [</div><div class="line">              &#123;</div><div class="line">                <span class="attr">"alterId"</span>: <span class="number">64</span>,</div><div class="line">                <span class="attr">"id"</span>: <span class="string">"b27c24ab-2b5a-433e-902c-33f1168a7902"</span></div><div class="line">              &#125;</div><div class="line">            ]</div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"DOSG"</span>,</div><div class="line">      <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">        <span class="attr">"network"</span>: <span class="string">"tcp"</span>  </div><div class="line">      &#125;,</div><div class="line">      <span class="attr">"proxySettings"</span>: &#123;</div><div class="line">          <span class="attr">"tag"</span>: <span class="string">"AliSG"</span>  </div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">  ]</div><div class="line">&#125;</div></pre></div></div></figure><p>那麼資料包經過的節點依次為： PC -&gt; AliHK -&gt; AliSG -&gt; DOSG -&gt; DOUS -&gt; 目標網站</p><p>這樣的傳出代理形成了一條鏈條，我稱之為鏈式傳出代理。</p><p>注意：如果你打算配置 (動態) 鏈式傳出代理，應當明確幾點：</p><ul><li>性能。鏈式代理使用了多個節點，可能會造成延時、帶寬等網路性能問題，並且客戶端對每一個加解密的次數取決於代理鏈的長度，理論上也會有一定的影響。</li><li>安全。前文提到，傳出代理會一定程度上提高安全性，但安全取決於最弱一環，並不意味著代理鏈越長就會越安全。如果你需要匿名，請考慮成熟的匿名方案。 另外，使用了傳出代理 streamSettings 會失效。</li></ul><hr><h3 id="HTTP-偽裝"><a href="#HTTP-偽裝" class="headerlink" title="HTTP 偽裝"></a>HTTP 偽裝</h3><p>（2018-03-16 註：個人建議不要使用 HTTP 偽裝） V2Ray 自 v2.5 版本開始提供 HTTP 偽裝功能，後經作者不斷完善，到現在已經非常成熟穩定了。V2Ray 的 HTTP 偽裝功能可以可以將 V2Ray 的流量偽裝成正常的 HTTP 協定的。這裡給出一個 HTTP 偽裝的伺服器端與客戶端配置文件示例。</p><p>配置中關於 HTTP 頭欄位的內容及含義，Wikipedia 有簡要的說明，可參閱。</p><p>1.1. 配置</p><p>從 V2Ray 的實現角度來說，使用 HTTP 偽裝的同時完全可以使用動態端口。但我個人並不建議這麼做，因為從實際情況來看，基本上不會有人在一個伺服器上開使用多個端口的 Web 服務。如果你覺得 HTTP 偽裝的配置過於複雜不懂得如何修改，那請直接使用下面的配置即可。</p><p>1.1.1. 伺服器<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"log"</span> : &#123;</div><div class="line">    <span class="attr">"access"</span>: <span class="string">"/var/log/v2ray/access.log"</span>,</div><div class="line">    <span class="attr">"error"</span>: <span class="string">"/var/log/v2ray/error.log"</span>,</div><div class="line">    <span class="attr">"loglevel"</span>: <span class="string">"warning"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    "port": 80, //推薦80端口，更好地迷惑防火牆（好吧實際上並沒有什麼卵用</div><div class="line">    "protocol": "vmess",</div><div class="line">    "settings": &#123;</div><div class="line">      "clients": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">          <span class="attr">"level"</span>: <span class="number">1</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "streamSettings": &#123;</div><div class="line">      "network": "tcp",</div><div class="line">      "tcpSettings": &#123;</div><div class="line">        "header": &#123; // header 這一項是關於資料包偽裝的設置，可自定義合理的內容，但要確保伺服器與客戶端一致</div><div class="line">          "type": "http",</div><div class="line">          "response": &#123;</div><div class="line">            "version": "1.1",</div><div class="line">            "status": "200",</div><div class="line">            "reason": "OK",</div><div class="line">            "headers": &#123;</div><div class="line">              "Content-Type": ["application/octet-stream", "application/x-msdownload", "text/html", "application/x-shockwave-flash"],</div><div class="line">              "Transfer-Encoding": ["chunked"],</div><div class="line">              "Connection": ["keep-alive"],</div><div class="line">              "Pragma": "no-cache"</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "freedom",</div><div class="line">    "settings": &#123;&#125;</div><div class="line">  &#125;,</div><div class="line">  "outboundDetour": [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"blackhole"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"blocked"</span></div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  "routing": &#123;</div><div class="line">    "strategy": "rules",</div><div class="line">    "settings": &#123;</div><div class="line">      "rules": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"field"</span>,</div><div class="line">          <span class="attr">"ip"</span>: [</div><div class="line">            <span class="string">"0.0.0.0/8"</span>,</div><div class="line">            <span class="string">"10.0.0.0/8"</span>,</div><div class="line">            <span class="string">"100.64.0.0/10"</span>,</div><div class="line">            <span class="string">"127.0.0.0/8"</span>,</div><div class="line">            <span class="string">"169.254.0.0/16"</span>,</div><div class="line">            <span class="string">"172.16.0.0/12"</span>,</div><div class="line">            <span class="string">"192.0.0.0/24"</span>,</div><div class="line">            <span class="string">"192.0.2.0/24"</span>,</div><div class="line">            <span class="string">"192.168.0.0/16"</span>,</div><div class="line">            <span class="string">"198.18.0.0/15"</span>,</div><div class="line">            <span class="string">"198.51.100.0/24"</span>,</div><div class="line">            <span class="string">"203.0.113.0/24"</span>,</div><div class="line">            <span class="string">"::1/128"</span>,</div><div class="line">            <span class="string">"fc00::/7"</span>,</div><div class="line">            <span class="string">"fe80::/10"</span></div><div class="line">          ],</div><div class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"blocked"</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.2. 客戶端</p><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"log"</span>: &#123;</div><div class="line">    <span class="attr">"loglevel"</span>: <span class="string">"warning"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</div><div class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"vnext"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"serveraddr.com"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">80</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      <span class="attr">"network"</span>: <span class="string">"tcp"</span>,</div><div class="line">      <span class="attr">"tcpSettings"</span>: &#123;</div><div class="line">        "header": &#123;  //這裡的 header 要與伺服器保持一致</div><div class="line">          "type": "http",</div><div class="line">          "request": &#123;</div><div class="line">            "version": "1.1",</div><div class="line">            "method": "GET",</div><div class="line">            "path": ["/"],</div><div class="line">            "headers": &#123;</div><div class="line">              "Host": ["www.cloudflare.com", "www.amazon.com"],</div><div class="line">              "User-Agent": [</div><div class="line">                "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.75 Safari/537.36",</div><div class="line">                        <span class="string">"Mozilla/5.0 (iPhone; CPU iPhone OS 10_0_2 like Mac OS X) AppleWebKit/601.1 (KHTML, like Gecko) CriOS/53.0.2785.109 Mobile/14A456 Safari/601.1.46"</span></div><div class="line">              ],</div><div class="line">              "Accept-Encoding": ["gzip, deflate"],</div><div class="line">              "Connection": ["keep-alive"],</div><div class="line">              "Pragma": "no-cache"</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outboundDetour": [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">"protocol"</span>: <span class="string">"freedom"</span>,</div><div class="line">      <span class="attr">"settings"</span>: &#123;&#125;,</div><div class="line">      <span class="attr">"tag"</span>: <span class="string">"direct"</span></div><div class="line">    &#125;</div><div class="line">  ],</div><div class="line">  "routing": &#123;</div><div class="line">    "strategy": "rules",</div><div class="line">    "settings": &#123;</div><div class="line">      "domainStrategy": "IPIfNonMatch",</div><div class="line">      "rules": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"field"</span>,</div><div class="line">          <span class="attr">"ip"</span>: [</div><div class="line">            <span class="string">"0.0.0.0/8"</span>,</div><div class="line">            <span class="string">"10.0.0.0/8"</span>,</div><div class="line">            <span class="string">"100.64.0.0/10"</span>,</div><div class="line">            <span class="string">"127.0.0.0/8"</span>,</div><div class="line">            <span class="string">"169.254.0.0/16"</span>,</div><div class="line">            <span class="string">"172.16.0.0/12"</span>,</div><div class="line">            <span class="string">"192.0.0.0/24"</span>,</div><div class="line">            <span class="string">"192.0.2.0/24"</span>,</div><div class="line">            <span class="string">"192.168.0.0/16"</span>,</div><div class="line">            <span class="string">"198.18.0.0/15"</span>,</div><div class="line">            <span class="string">"198.51.100.0/24"</span>,</div><div class="line">            <span class="string">"203.0.113.0/24"</span>,</div><div class="line">            <span class="string">"::1/128"</span>,</div><div class="line">            <span class="string">"fc00::/7"</span>,</div><div class="line">            <span class="string">"fe80::/10"</span></div><div class="line">          ],</div><div class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"chinasites"</span>,</div><div class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"type"</span>: <span class="string">"chinaip"</span>,</div><div class="line">          <span class="attr">"outboundTag"</span>: <span class="string">"direct"</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure><hr><h3 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h3><p>從 v1.19 起引入了 TLS，TLS 中文譯名是傳輸層安全，如果你沒聽說過，請 Google 瞭解一下。以下給出些我認為介紹較好的文章鏈結：</p><p><a href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html" rel="external nofollow noopener noreferrer" target="_blank">SSL/TLS 協定運行機制的概述</a><br><a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E5%8D%94%E8%AD%B0" rel="external nofollow noopener noreferrer" target="_blank">傳輸層安全協定</a></p><h4 id="1-1-註冊一個域名"><a href="#1-1-註冊一個域名" class="headerlink" title="1.1. 註冊一個域名"></a>1.1. 註冊一個域名</h4><p>如果已經註冊有域名了可以跳過。 TLS 需要一個域名，域名有免費的和有付費的，如果你不捨得為一個域名每年花點錢，用個免費域名也可以，但總體來說付費的會優於免費的。為了方便，在本文中我就忽略如何註冊購買域名了。關於如何獲取域名，具體搜索相關文章教程。</p><p>註冊好域名之後務必記得添加一個 A 記錄指向你的 VPS!</p><p>以下假設註冊的域名為 mydomain.me，請將之替換成自己的域名。</p><h4 id="1-2-證書生成"><a href="#1-2-證書生成" class="headerlink" title="1.2. 證書生成"></a>1.2. 證書生成</h4><p>TLS 是證書認證機制，所以使用 TLS 需要證書，證書也有免費付費的，同樣的這裡使用免費證書，證書認證機構為 Let’s Encrypt。 證書的生成有許多方法，這裡使用的是比較簡單的方法：使用 acme.sh 腳本生成，本部分說明部分內容參考於 acme.sh README。</p><p>證書有兩種，一種是 ECC 證書（內置公鑰是 ECDSA 公鑰），一種是 RSA 證書（內置 RSA 公鑰）。簡單來說，同等長度 ECC 比 RSA 更安全, 也就是說在具有同樣安全性的情況下，ECC 的密鑰長度比 RSA 短得多（加密解密會更快）。但問題是 ECC 的相容性會差一些，Android 4.x 以下和 Windows XP 不支援。只要您的設備不是非常老的老古董，強烈建議使用 ECC 證書。</p><p>以下將給出這兩類證書的生成方法，請大家根據自身的情況自行選擇其中一種證書類型。</p><p>證書生成只需在伺服器上操作。</p><h5 id="1-2-1-安裝-acme-sh"><a href="#1-2-1-安裝-acme-sh" class="headerlink" title="1.2.1. 安裝 acme.sh"></a>1.2.1. 安裝 acme.sh</h5><p>安裝 EPEL 軟體擴充資源庫：<br>    yum install epel-release</p><p>Let’s Encrypt 憑證取得方式不同與其他網站是在網頁上手動填寫申請資料的，而是須在 Server 上安裝一個 Client（python 寫的），這種作法所帶來的好處是可全自動化，這裡使用 Let’s Encrypt 官方推薦的 Certbot Client，來自動取得、部署和更新 SSL 憑證：</p><pre><code>yum install certbot</code></pre><p>執行以下命令，acme.sh 會安裝到 ~/.acme.sh 目錄下。<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></div><div class="code"><pre><div class="line">$ curl  https://get.acme.sh | sh</div><div class="line">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</div><div class="line">                               Dload  Upload   Total   Spent    Left  Speed</div><div class="line">100   671  100   671    0     0    680      0 --:--:-- --:--:-- --:--:--   679</div><div class="line">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</div><div class="line">                               Dload  Upload   Total   Spent    Left  Speed</div><div class="line">100  112k  100  112k    0     0   690k      0 --:--:-- --:--:-- --:--:--  693k</div><div class="line">[Fri 30 Dec 01:03:32 GMT 2016] Installing from online archive.</div><div class="line">[Fri 30 Dec 01:03:32 GMT 2016] Downloading https://github.com/Neilpang/acme.sh/archive/master.tar.gz</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Extracting master.tar.gz</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installing to /home/user/.acme.sh</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installed to /home/user/.acme.sh/acme.sh</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installing <span class="built_in">alias</span> to <span class="string">'/home/user/.profile'</span></div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] OK, Close and reopen your terminal to start using acme.sh</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Installing cron job</div><div class="line">no crontab <span class="keyword">for</span> user</div><div class="line">no crontab <span class="keyword">for</span> user</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Good, bash is found, so change the shebang to use bash as preferred.</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] OK</div><div class="line">[Fri 30 Dec 01:03:33 GMT 2016] Install success!</div></pre></div></div></figure></p><p>安裝成功後執行 <code>source ~/.bashrc</code> 以確保腳本所設置的命令別名生效。</p><p>如果安裝報錯，那麼可能是因為系統缺少 acme.sh 所需要的依賴項，acme.sh 的依賴項主要是 netcat(nc)，我們通過以下命令來安裝這些依賴項，然後重新安裝一遍 acme.sh:</p><pre><code>sudo apt-get -y install netcat</code></pre><h5 id="1-2-2-使用-acme-sh-生成證書"><a href="#1-2-2-使用-acme-sh-生成證書" class="headerlink" title="1.2.2. 使用 acme.sh 生成證書"></a>1.2.2. 使用 acme.sh 生成證書</h5><p>證書生成<br>執行以下命令生成證書：</p><p>以下的命令會臨時監聽 80 端口，請確保執行該命令前 80 端口沒有使用<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></div><div class="code"><pre><div class="line">$ sudo ~/.acme.sh/acme.sh --issue -d mydomain.me --standalone -k ec-256</div><div class="line">[Fri Dec 30 08:59:12 HKT 2016] Standalone mode.</div><div class="line">[Fri Dec 30 08:59:12 HKT 2016] Single domain=<span class="string">'mydomain.me'</span></div><div class="line">[Fri Dec 30 08:59:12 HKT 2016] Getting domain auth token <span class="keyword">for</span> each domain</div><div class="line">[Fri Dec 30 08:59:12 HKT 2016] Getting webroot <span class="keyword">for</span> domain=<span class="string">'mydomain.me'</span></div><div class="line">[Fri Dec 30 08:59:12 HKT 2016] _w=<span class="string">'no'</span></div><div class="line">[Fri Dec 30 08:59:12 HKT 2016] Getting new-authz <span class="keyword">for</span> domain=<span class="string">'mydomain.me'</span></div><div class="line">[Fri Dec 30 08:59:14 HKT 2016] The new-authz request is ok.</div><div class="line">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip.</div><div class="line">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</div><div class="line">[Fri Dec 30 08:59:14 HKT 2016] mydomain.me is already verified, skip http-01.</div><div class="line">[Fri Dec 30 08:59:14 HKT 2016] Verify finished, start to sign.</div><div class="line">[Fri Dec 30 08:59:16 HKT 2016] Cert success.</div><div class="line">-----BEGIN CERTIFICATE-----</div><div class="line">MIIEMTCCAxmgAwIBAgISA1+gJF5zwUDjNX/6Xzz5fo3lMA0GCSqGSIb3DQEBCwUA</div><div class="line">MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD</div><div class="line">ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xNjEyMjkyMzU5MDBaFw0x</div><div class="line">NzAzMjkyMzU5MDBaMBcxFTATBgNVBAMTDHdlYWtzYW5kLmNvbTBZMBMGByqGSM49</div><div class="line">****************************************************************</div><div class="line">4p40tm0aMB837XQ9jeAXvXulhVH/7/wWZ8/vkUUvuHSCYHagENiq/3DYj4a85Iw9</div><div class="line">+6u1r7atYHJ2VwqSamiyTGDQuhc5wdXIQxY/YQQqkAmn5tLsTZnnOavc4plANT40</div><div class="line">zweiG8vcIvMVnnkM0TSz8G1yzv1nOkruN3ozQkLMu6YS7lk/ENBN7DBtYVSmJeU2</div><div class="line">VAXE+zgRaP7JFOqK6DrOwhyE2LSgae83Wq/XgXxjfIo1Zmn2UmlE0sbdNKBasnf9</div><div class="line">gPUI45eltrjcv8FCSTOUcT7PWCa3</div><div class="line">-----END CERTIFICATE-----</div><div class="line">[Fri Dec 30 08:59:16 HKT 2016] Your cert is <span class="keyword">in</span>  /root/.acme.sh/mydomain.me_ecc/mydomain.me.cer</div><div class="line">[Fri Dec 30 08:59:16 HKT 2016] Your cert key is <span class="keyword">in</span>  /root/.acme.sh/mydomain.me_ecc/mydomain.me.key</div><div class="line">[Fri Dec 30 08:59:16 HKT 2016] The intermediate CA cert is <span class="keyword">in</span>  /root/.acme.sh/mydomain.me_ecc/ca.cer</div><div class="line">[Fri Dec 30 08:59:16 HKT 2016] And the full chain certs is there:  /root/.acme.sh/mydomain.me_ecc/fullchain.cer</div></pre></div></div></figure></p><p><code>-k</code> 表示密鑰長度，後面的值可以是 <code>ec-256 、ec-384、2048、3072、4096、8192</code>，帶有 <code>ec</code> 表示生成的是 ECC 證書，沒有則是 RSA 證書。在安全性上 256 位的 ECC 證書等同於 3072 位的 RSA 證書。</p><h5 id="證書更新"><a href="#證書更新" class="headerlink" title="證書更新"></a>證書更新</h5><p>由於 Let’s Encrypt 的證書有效期只有 3 個月，因此需要 90 天至少要更新一次證書，acme.sh 腳本會每 60 天自動更新證書。也可以手動更新。</p><p>手動更新 ECC 證書，執行：</p><pre><code>sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force --ecc</code></pre><p>如果是 RSA 證書則執行：</p><pre><code>sudo ~/.acme.sh/acme.sh --renew -d mydomain.com --force</code></pre><p>由於本例中將證書生成到 /etc/v2ray/ 文件夾，更新證書之後還得把新證書生成到 /etc/v2ray。</p><h5 id="1-2-3-安裝證書和密鑰"><a href="#1-2-3-安裝證書和密鑰" class="headerlink" title="1.2.3. 安裝證書和密鑰"></a>1.2.3. 安裝證書和密鑰</h5><p>ECC 證書<br>將證書和密鑰安裝到 /etc/v2ray 中：</p><pre><code>sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key --ecc</code></pre><p>RSA 證書</p><pre><code>sudo ~/.acme.sh/acme.sh --installcert -d mydomain.me --fullchainpath /etc/v2ray/v2ray.crt --keypath /etc/v2ray/v2ray.key</code></pre><p>注意：無論什麼情況，密鑰 (即上面的 v2ray.key) 都不能洩漏，如果你不幸洩漏了密鑰，可以使用 acme.sh 將原證書吊銷，再生成新的證書，吊銷方法請自行參考 acme.sh 的手冊</p><h4 id="1-3-配置-V2Ray"><a href="#1-3-配置-V2Ray" class="headerlink" title="1.3. 配置 V2Ray"></a>1.3. 配置 V2Ray</h4><p>1.3.1. 伺服器<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    "port": 443, // 建議使用 443 端口</div><div class="line">    "protocol": "vmess",    </div><div class="line">    "settings": &#123;</div><div class="line">      "clients": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297"</span>,  </div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "streamSettings": &#123;</div><div class="line">      "network": "tcp",</div><div class="line">      "security": "tls", // security 要設置為 tls 才會啟用 TLS</div><div class="line">      "tlsSettings": &#123;</div><div class="line">        "certificates": [</div><div class="line">          &#123;</div><div class="line">            "certificateFile": "/etc/v2ray/v2ray.crt", // 證書文件</div><div class="line">            "keyFile": "/etc/v2ray/v2ray.key" // 密鑰文件</div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "freedom",</div><div class="line">    "settings": &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.3.2. 客戶端<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</div><div class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"vnext"</span>: [</div><div class="line">        &#123;</div><div class="line">          "address": "mydomain.me", // tls 需要域名，所以這裡應該填自己的域名</div><div class="line">          "port": 443,</div><div class="line">          "users": [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"23ad6b10-8d1a-40f7-8ad0-e3e35cd38297"</span>,</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "streamSettings": &#123;</div><div class="line">      "network": "tcp",</div><div class="line">      "security": "tls" // 客戶端的 security 也要設置為 tls</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><h4 id="1-4-驗證"><a href="#1-4-驗證" class="headerlink" title="1.4. 驗證"></a>1.4. 驗證</h4><p>一般來說，按照以上步驟操作完成，V2Ray 客戶端能夠正常聯網說明 TLS 已經成功啟用。但要是有個可靠的方法來驗證是否正常開啟 TLS 無疑更令人放心。 驗證的方法有很多，我僅介紹一種小白化一點的，便是 Qualys SSL Labs’s SSL Server Test。</p><p>注意：使用 Qualys SSL Labs’s SSL Server Test 要求使用 443 端口，意味著你伺服器配置的 inbound.port 應當是 443</p><p>打開 Qualys SSL Labs’s SSL Server Test，在 Hostname 中輸入你的域名，點提交，過一會結果就出來了。</p><hr><h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><p>WebSocket 的配置其實很簡單，就跟 mKCP 一樣把 network 一改就行了。話不多說，直接上配置。</p><p>1.1. 配置<br>1.1.1. 伺服器配置<br><figure class="highlight json"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">16823</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"clients"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      <span class="attr">"network"</span>:<span class="string">"ws"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"freedom"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.2. 客戶端配置<br><figure class="highlight json"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</div><div class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"vnext"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"serveraddr.com"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">16823</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>:&#123;</div><div class="line">      <span class="attr">"network"</span>:<span class="string">"ws"</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><hr><h3 id="WebSocket-TLS-Web"><a href="#WebSocket-TLS-Web" class="headerlink" title="WebSocket+TLS+Web"></a>WebSocket+TLS+Web</h3><p>前文分別提到過 TLS 和 WebSocket 的配置方法，而本文搭配 Web 服務並同時實現 TLS 和 WebSocket。關於 Web 的軟件本文給出了 Nginx 和 Caddy 兩個例子，二選一即可，也可以選用其他的軟件（如 Apache）。</p><p>很多新手一接觸 V2Ray 就想搞 WebSocket+TLS+Web 或 WebSocket+TLS+Web+CDN，我就想問 ssh 和 vim/nano 用利索了沒，步子這麼大不怕扯到蛋嗎？使用 Nginx/Caddy 是因為 VPS 已經有 Nginx/Caddy 可以將 V2Ray 稍作隱藏，使用 WebSocket 是因為搭配 Nginx/Caddy 只能用 WebSocket，使用 TLS 是因為可以流量加密，看起來更像 HTTPS。 也許 WebSocket+TLS+Web 的配置組合相對較好，但不意味著這樣的配置適合任何人。因為本節涉及 Nginx 和 Caddy，只給出了配置示例而不講具體使用方法，也就是說你在閱讀本節內容前得會使用這兩個軟件的其中之一，如果你還不會，請自行 Google。</p><p>注意: V2Ray 的 Websocket+TLS 配置組合並不依賴 Nginx 或 Caddy，只是能與其搭配使用而已，沒有它們也可以正常使用。</p><p>1.1. 配置<br>這次 TLS 的配置將寫入 Nginx 或者 Caddy 配置中，由這些軟件來監聽 443 端口，然後將其轉發到 V2Ray 的 WebSocket 所監聽的內網端口，V2Ray 伺服器端不需要配置 TLS。</p><p>1.1.1. 伺服器配置<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">10000</span>,</div><div class="line">    "listen":"127.0.0.1",//只監聽 127.0.0.1，避免除本機外的機器探測到開放了 10000 端口</div><div class="line">    "protocol": "vmess",</div><div class="line">    "settings": &#123;</div><div class="line">      "clients": [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    "streamSettings": &#123;</div><div class="line">      "network": "ws",</div><div class="line">      "wsSettings": &#123;</div><div class="line">      "path": "/ray"</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "freedom",</div><div class="line">    "settings": &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.2. Nginx 配置<br>配置中使用的是域名和證書使用 TLS 小節的舉例，請替換成自己的。</p><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></div><div class="code"><pre><div class="line">server &#123;</div><div class="line">  listen  443 ssl;</div><div class="line">  ssl on;</div><div class="line">  ssl_certificate       /etc/v2ray/v2ray.crt;</div><div class="line">  ssl_certificate_key   /etc/v2ray/v2ray.key;</div><div class="line">  ssl_protocols         TLSv1 TLSv1.1 TLSv1.2;</div><div class="line">  ssl_ciphers           HIGH:!aNULL:!MD5;</div><div class="line">  server_name           mydomain.me;</div><div class="line">        location /ray &#123;</div><div class="line">        proxy_redirect off;</div><div class="line">        proxy_pass http://127.0.0.1:10000;#假設WebSocket監聽在環回位址的10000端口上</div><div class="line">        proxy_http_version 1.1;</div><div class="line">        proxy_set_header Upgrade $http_upgrade;</div><div class="line">        proxy_set_header Connection "upgrade";</div><div class="line">        proxy_set_header Host $http_host;</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></div></div></figure><p>1.1.3. Caddy 配置<br>因為 Caddy 會自動申請證書並自動更新，所以使用 Caddy 不用指定證書、密鑰。<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></div><div class="code"><pre><div class="line">mydomain.me</div><div class="line">&#123;</div><div class="line">  log ./caddy.log</div><div class="line">  proxy /ray localhost:10000 &#123;</div><div class="line">    websocket</div><div class="line">    header_upstream -Origin</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.4. 客戶端配置<br><figure class="highlight json"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</div><div class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span>,</div><div class="line">      <span class="attr">"udp"</span>: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"vnext"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"mydomain.me"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">443</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      <span class="attr">"network"</span>: <span class="string">"ws"</span>,</div><div class="line">      <span class="attr">"security"</span>: <span class="string">"tls"</span>,</div><div class="line">      <span class="attr">"wsSettings"</span>: &#123;</div><div class="line">        <span class="attr">"path"</span>: <span class="string">"/ray"</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.5. 注意事項</p><ul><li>較低版本的 nginx 的 location 需要寫為 <code>/ray/</code> 才能正常工作</li><li>如果在設置完成之後不能成功使用，可能是由於 SElinux 機制 (如果你是 CentOS 7 的用戶請特別留意 SElinux 這一機制) 阻止了 Nginx 轉發向內網的資料。如果是這樣的話，在 V2Ray 的日誌裡不會有訪問資訊，在 Nginx 的日誌裡會出現大量的 “Permission Denied” 欄位，要解決這一問題需要在終端下鍵入以下命令：<br>  setsebool -P httpd_can_network_connect 1</li><li>請保持伺服器和客戶端的 wsSettings 嚴格一致，對於 V2Ray，/ray 和 /ray/ 是不一樣的</li></ul><p>1.1.6. 其他的話</p><ol><li>開啟了 TLS 之後 path 參數是被加密的，GFW 看不到；</li><li>主動探測一個 path 產生 Bad request 不能證明是 V2Ray；</li><li>不安全的因素在於人，自己的問題就不要甩鍋，哪怕我把示例中的 path 改成一個 UUID，依然有不少人原封不動地 COPY；</li><li>使用 Header 分流並不比 path 安全， 不要迷信。</li></ol><hr><h3 id="HTTP-2"><a href="#HTTP-2" class="headerlink" title="HTTP/2"></a>HTTP/2</h3><p>簡單地說 HTTP/2 是 HTTP/1.1 的升級版（目前大多數網頁還是 HTTP/1.1），點擊這裡可以直觀地體會到 HTTP/2 相比於 HTTP/1.1 的提升（不代表 V2Ray 中 HTTP/2 相對於 TCP 的提升就是這樣的）。</p><p>在 V2Ray 的手冊中並沒有 HTTP/2 的相關內容，而且 V2Ray 的 HTTP/2 還處於測試階段。</p><p>1.1. 配置<br>最近幾版的 V2Ray 已經開始支援 HTTP/2，可能 v3.12 就支援了，實測 v3.14 能夠使用 HTTP/2 了。與其他的傳輸層協定一樣在 streamSettings 中配置。</p><p>1.1.1. 伺服器配置<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">443</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"clients"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">          <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      "network": "h2", // h2 也可寫成 http，效果一樣</div><div class="line">      "httpSettings": &#123; //此項是關於 HTTP/2 的設置</div><div class="line">        "path": "/ray"</div><div class="line">      &#125;,</div><div class="line">      "security": "tls", // 配置tls</div><div class="line">      "tlsSettings": &#123;</div><div class="line">        "certificates": [</div><div class="line">          &#123;</div><div class="line">            "certificateFile": "/etc/v2ray/v2ray.crt", // 證書文件，詳見 tls 小節</div><div class="line">            "keyFile": "/etc/v2ray/v2ray.key" // 密鑰文件</div><div class="line">          &#125;</div><div class="line">        ]</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  "outbound": &#123;</div><div class="line">    "protocol": "freedom",</div><div class="line">    "settings": &#123;&#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>1.1.2. 客戶端配置<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"inbound"</span>: &#123;</div><div class="line">    <span class="attr">"port"</span>: <span class="number">1080</span>,</div><div class="line">    <span class="attr">"listen"</span>: <span class="string">"127.0.0.1"</span>,</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"socks"</span>,</div><div class="line">    <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"auth"</span>: <span class="string">"noauth"</span>,</div><div class="line">      <span class="attr">"udp"</span>: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">"outbound"</span>: &#123;</div><div class="line">    <span class="attr">"protocol"</span>: <span class="string">"vmess"</span>,</div><div class="line">    <span class="attr">"settings"</span>: &#123;</div><div class="line">      <span class="attr">"vnext"</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">"address"</span>: <span class="string">"mydomain.me"</span>,</div><div class="line">          <span class="attr">"port"</span>: <span class="number">443</span>,</div><div class="line">          <span class="attr">"users"</span>: [</div><div class="line">            &#123;</div><div class="line">              <span class="attr">"id"</span>: <span class="string">"b831381d-6324-4d53-ad4f-8cda48b30811"</span>,</div><div class="line">              <span class="attr">"alterId"</span>: <span class="number">64</span></div><div class="line">            &#125;</div><div class="line">          ]</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"streamSettings"</span>: &#123;</div><div class="line">      <span class="attr">"network"</span>: <span class="string">"h2"</span>,</div><div class="line">      "httpSettings": &#123; //此項是關於 HTTP/2 的設置</div><div class="line">        "path": "/ray"</div><div class="line">      &#125;,</div><div class="line">      "security": "tls"</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><hr><h3 id="不推薦的配置"><a href="#不推薦的配置" class="headerlink" title="不推薦的配置"></a>不推薦的配置</h3><p>也許有一部分朋友發現了，高級篇的內容關於傳輸層的，各種配置的組合，可以搭配出非常多的配置。但是，有一些組合是我認為不值得或者是冗餘的（僅代表個人意見），以下給出。</p><ul><li><p>TLS+KCP<br>這是相當一部分人喜歡的組合，不推薦的原因是 vmess 本身的加密方式已經足夠，加 TLS 只是多消耗設備算力，尤其是移動設備，TLS 也不在最外層，已經失去大部分人使用 TLS 的初衷。</p></li><li><p>TLS+HTTP 偽裝<br>這並沒有什麼卵用，這樣的組合不是 HTTPS。</p></li><li><p>單純使用 Websocket<br>理論上，使用 Websocket 會比 TCP 性能差一些，所以如果不是搭配 CDN、nginx 或者在 PaaS 上使用，那還是使用 TCP 吧。</p></li></ul><hr><h3 id="透明代理"><a href="#透明代理" class="headerlink" title="透明代理"></a>透明代理</h3><p>透明代理是什麼意思請自行 Google，在這兒指使用 V2Ray 做透明代理實現路由器翻牆。然而，我個人認為路由器翻牆的說法並不準確，應該叫閘道翻牆。所以本例實際上是關於閘道翻牆的內容。當然了，單純使用路由器翻牆也是可以的，因為普通的家用路由器本就是一個閘道。使用閘道翻牆可以使局域網內的所有設備都具有直接翻牆的能力，並且能夠全局代理，而不必每台設備都安裝 V2Ray，配置更新時只需在閘道修改配置，用一些網友的話說就是就感覺沒有牆一樣。但是，有意上透明代理的同學請評估一下透明代理是否合適自己，而不要盲目跟風。</p><p>透明代理適用於以下情況：</p><ul><li>局域網設備較多，比如說辦公室、實驗室、子孫滿堂的家庭等；</li><li>設備 (的軟件) 無法 / 不方便設置代理，比如說 chromecast、電視盒子等；</li><li><p>希望設備的所有軟件都走代理。<br>不適用於：</p></li><li><p>隨便拿個垃圾路由器就想上的</p></li></ul><p>1.1. 優點<br>其實，V2Ray 早就可以作透明代理，當時我也研究了好一段時間，最終是折騰出來了。但是由於 DNS 的問題，我用著總感覺不太舒服。雖然有 ChinaDNS 這類的解決方案，但個人主觀上並不喜歡。 不過嘛，現在就不一樣了。就目前來說，使用 V2Ray 透明代理：</p><ol><li>解決了牆外 DNS 污染問題；</li><li>在解決了 1 的情況下國內域名的即能夠解析到國內 CDN；</li><li>不需要外部軟件或自建 DNS 就可決絕 1 和 2 的問題，只要系統支援 V2Ray 和 iptables；</li><li>能夠完美利用 V2Ray 強大而靈活的路由功能，而不必額外維護一個路由表；</li></ol><p>1.2. 軟硬體準備</p><ul><li>一台已經搭建 V2Ray 並能正常使用的 VPS ，本文假設 IP 為 110.231.43.65；</li><li>一台帶 iptables、有 root 權限並且系統為 Linux 的設備，假設位址為 192.168.1.22，已經配置好 V2Ray 作為客戶端。這個設備可以是路由器、開發板、個人電腦、虛擬機和 Android 設備等，更具普適性地稱之為閘道。我個人非常不建議使用 MT7620 系路由器開透明代理，性能太差了，很多固件也沒有開啟 FPU 。要是真不願意出這點錢，用電腦開個虛擬機吧 (我就是這麼幹的)，VirtualBox、Hyper 之類的都可以，但是別忘了網路模式用網橋。</li></ul><p>1.3. 設置步驟</p><p>設置步驟如下，假設使用 root。</p><ol><li><p>閘道開啟 IP 轉發。在 /etc/sysctl.conf 文件添加一行 net.ipv4.ip_forward=1 ，執行下列命令生效：<br> sysctl -p</p></li><li><p>路由器 DHCP 設定閘道位址為閘道設備的 IP，本例為 192.168.1.22，或者電腦手機等設備單獨設置閘道位址，但閘道設備必須指定閘道位址為路由器的 IP，然後電腦 / 手機測試是不是可以正常上網 (這時還不能翻牆)，如果不能上網先去學習一個把這個搞定，否則接下來再怎麼也同樣上不了網。</p></li><li><p>在伺服器和閘道安裝 V2Ray（如果不會就參照前面的教程，由於 GFW 會惡化 GitHub Releases 的流量，閘道直接運行腳本幾乎無法安裝，建議從 <a href="https://v2ray.com/download" rel="external nofollow noopener noreferrer" target="_blank">https://v2ray.com/download</a> 下載然後使用 –local 參數進行安裝），並配置好配置文件。一定要確定搭建的 V2Ray 能夠正常使用。在閘道執行 <code>curl -x socks5://127.0.0.1:1080 google.com</code>測試配置的 V2Ray 是否可以翻牆 (命令中 socks5 指 inbound 為 socks，1080 指該 inbound 端口是 1080)。如果出現類似下面的輸出則可以翻牆，如果沒有出現就說明翻不了，你得仔細檢查以下哪步操作不對或漏了。</p><figure class="highlight html"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></div><div class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">HTML</span>&gt;</span><span class="tag">&lt;<span class="name">HEAD</span>&gt;</span><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">TITLE</span>&gt;</span>301 Moved<span class="tag">&lt;/<span class="name">TITLE</span>&gt;</span><span class="tag">&lt;/<span class="name">HEAD</span>&gt;</span><span class="tag">&lt;<span class="name">BODY</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">H1</span>&gt;</span>301 Moved<span class="tag">&lt;/<span class="name">H1</span>&gt;</span></div><div class="line">The document has moved</div><div class="line"><span class="tag">&lt;<span class="name">A</span> <span class="attr">HREF</span>=<span class="string">"http://www.google.com/"</span>&gt;</span>here<span class="tag">&lt;/<span class="name">A</span>&gt;</span>.</div><div class="line"><span class="tag">&lt;/<span class="name">BODY</span>&gt;</span><span class="tag">&lt;/<span class="name">HTML</span>&gt;</span></div></pre></div></div></figure></li></ol><p>在閘道的配置，添加 dokodemo ，並開啟 domain override（注意不要寫錯配置）。配置形如：<br><figure class="highlight"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></div><div class="code"><pre><div class="line">&#123;</div><div class="line"> "inbound": &#123;...&#125;,</div><div class="line"> "outbound": &#123;...&#125;,</div><div class="line"> "inboundDetour": [</div><div class="line">     &#123;</div><div class="line">         <span class="attr">"domainOverride"</span>: [<span class="string">"tls"</span>,<span class="string">"http"</span>],</div><div class="line">         <span class="attr">"port"</span>: <span class="number">12345</span>,</div><div class="line">         <span class="attr">"protocol"</span>: <span class="string">"dokodemo-door"</span>,</div><div class="line">         <span class="attr">"settings"</span>: &#123;</div><div class="line">             <span class="attr">"network"</span>: <span class="string">"tcp,udp"</span>,</div><div class="line">             <span class="attr">"followRedirect"</span>: <span class="literal">true</span></div><div class="line">         &#125;</div><div class="line">     &#125;,</div><div class="line">     ...</div><div class="line"> ],</div><div class="line"> "outboundDetour": [...],</div><div class="line"> "routing": &#123;...&#125;</div><div class="line">&#125;</div></pre></div></div></figure></p><p>設定 iptables 規則，命令如下<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></div><div class="code"><pre><div class="line">iptables -t nat -N V2RAY</div><div class="line">iptables -t nat -A V2RAY -d 192.168.0.0/16 -j RETURN</div><div class="line">iptables -t nat -A V2RAY -p tcp -j REDIRECT --to-ports 12345</div><div class="line">iptables -t nat -A PREROUTING -p tcp -j V2RAY</div></pre></div></div></figure></p><p>UDP 流量透明代理的 iptables 規則，命令如下<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></div><div class="code"><pre><div class="line">ip rule add fwmark 1 table 100</div><div class="line">ip route add <span class="built_in">local</span> 0.0.0.0/0 dev lo table 100</div><div class="line">iptables -t mangle -N V2RAY_MASK</div><div class="line">iptables -t mangle -A V2RAY_MASK  -d 192.168.0.0/16 -j RETURN</div><div class="line">iptables -t mangle -A V2RAY_MASK -p udp -j TPROXY --on-port 12345 --tproxy-mark 1</div><div class="line">iptables -t mangle -A PREROUTING -p udp -j V2RAY_MASK</div></pre></div></div></figure></p><ol><li><p>使用電腦 / 手機直接訪問被牆網站，這時應當可以訪問的（如果不能，你可能得請教大神手把手指導了）。</p></li><li><p>寫腳本開機載入上述的 iptables，或者使用第三方軟件 (如 iptables-persistent)，否則閘道重啟後 iptables 會失效 (即透明代理會失效)。</p></li></ol><p>1.4. 注意事項</p><ul><li>在上面的設置中，假設訪問了國外網站，如 Google 等，閘道依然會使用的系統 DNS 進行查詢，只不過返回的結果是污染過的，而 V2Ray 提供的 domain override 能夠從流量中提取域名資訊交由 VPS 解析。也就是說，每次打算訪問被牆的網站，DNS 提供商都知道，鑑於國內企業尿性，也許 GFW 也都知道，會不會將這些資料收集喂 AI 也未可知。解決辦法是建一個 DNS，不向上級查詢，直接返回一個錯誤的 IP，反正 V2Ray 能夠解決污染問題。如果有朋友知道有什麼這樣的軟件，請告之 (可以使用 dnsmasq 實現)。</li><li>domain override 目前只能從 TLS 和 HTTP 流量中提取域名，如果上網流量有非這兩種類型的慎用 domain override 解決 DNS 污染。</li><li>由於對 iptables 不熟，我省略掉了對 UDP 流量的透明代理的設置，請精通此道的朋友補充一下 (目前 V2Ray 對 UDP 透明代理的實現有些問題，網路流量有大量 UDP 的網友請慎用)。</li><li>V2Ray 只能代理 TCP/UDP 的流量，ICMP 不支援，即就算透明代理成功了之後 ping Google 這類網站也是不通的。</li><li>最好設定閘道的位址為靜態 IP，否則閘道重啟後換了 IP 上不了網會很尷尬</li><li>上述的 iptables 配置只能使局域網內的其他設備翻牆，閘道本身是無法翻牆的，如果要閘道也能翻牆，要使用 iptables 的 owener 模組直連 V2Ray 發出的流量，然後執行 iptables -t nat -A OUTPUT -p tcp -j V2RAY。</li><li>按照網上的透明代理教程，設置 iptables 肯定要 RETURN 127.0.0.0/8 這類私有位址，但我個人觀點是放到 V2Ray 的路由裡好一些。</li></ul><hr><h2 id="Docker-部署-V2Ray"><a href="#Docker-部署-V2Ray" class="headerlink" title="Docker 部署 V2Ray"></a>Docker 部署 V2Ray</h2><p>Docker 技術是一種新的虛擬化技術，和傳統的虛擬化技術不同。V2Ray 同樣提供 Docker 部署方式，並且通過 Docker 來部署 V2Ray 會非常輕鬆高效。</p><p>Docker 只能部署在 KVM 或者 XEN 架構的 VPS 中</p><p>首先安裝 Docker：</p><pre><code>sudo apt-get install -y docker</code></pre><p>安裝完 Docker 後我們從 <a href="https://toutyrater.github.io/app/https%EF%BC%9A/hub.docker.com" rel="external nofollow noopener noreferrer" target="_blank">DockerHub</a> 通過搜索找到 V2Ray 官方提供的鏡像， <a href="https://toutyrater.github.io/app/https%EF%BC%9A/hub.docker.com/r/v2ray/official" rel="external nofollow noopener noreferrer" target="_blank">鏈結</a>在此. 找到拉取鏡像的的命令並複製下來，在網頁右側我們可以看到命令為 docker pull v2ray/official ，我們將其複製下來回到命令行中粘貼並執行：</p><pre><code>sudo docker pull v2ray/official</code></pre><p>待 V2Ray 的 Docker 鏡像拉取完成後就可以進入下一個部署階段. 在此之前，你需要在 /etc 目錄下新建一個文件夾 v2ray， 並把你的配置寫好後命名為 config.json 放入 v2ray 文件夾內. 待配置文件準備就緒後鍵入以下命令進行部署，部署前請記下配置文件中你所設置的端口號，在部署時需要將其映射到宿主機上. 否則將無法訪問. 此處假設設定的端口號為 8888，需要映射到宿主機的 8888 端口上. 則命令為：</p><pre><code>sudo docker run -d --name v2ray -v /etc/v2ray：/etc/v2ray -p 8888:8888 v2ray/official  v2ray -config=/etc/v2ray/config.json</code></pre><p>鍵入以上命令後，命令行會出現一串字符，代表容器部署成功，可以立即通過客戶端連接並開始使用了. 如果還不放心，鍵入以下命令來查看容器的運行狀態：</p><pre><code>sudo docker container ls</code></pre><p>如果看到輸出的結果中有以下欄位代表容器成功運行：<br><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></div><div class="code"><pre><div class="line">$ docker container ls</div><div class="line">CONTAINER ID        IMAGE                 COMMAND                  CREATED             STATUS              PORTS                     NAMES</div><div class="line">2a7sdo87kdf3        v2ray/official        <span class="string">"v2ray -config=/et..."</span>   3 minutes ago       Up 3 minutes        0.0.0.0：8888-&gt;8888/tcp    v2ray</div></pre></div></div></figure></p><p>通過以下命令來啟動 V2Ray：</p><pre><code>sudo docker container start v2ray</code></pre><p>停止 V2Ray：</p><pre><code>sudo docker container stop v2ray</code></pre><p>重啟 V2Ray：</p><pre><code>sudo docker container restart v2ray</code></pre><p>查看日誌：</p><pre><code>sudo docker container log  v2ray</code></pre><p>更新配置後，需要重新部署容器，命令如下：</p><pre><code>sudo docker container stop v2raysudo docker container rm v2raysudo docker run -d --name v2ray -v /etc/v2ray：/etc/v2ray -p 8888：8888 v2ray/official  v2ray -config=/etc/v2ray/config.json</code></pre><p>假如你的配置換了端口號，那麼相應的端口映射也要更改，假如你在配置文件中把監聽端口改為了 9999，則’-p’參數應該這樣寫：</p><pre><code>-p  9999:9999</code></pre><p>假如你想將容器中的端口映射到本機的端口，則命令應該這樣寫</p><pre><code>-p 127.0.0.1:端口號:端口號</code></pre><p>除非你打算使用 Nginx 來轉發 Websocket 否則不需要映射到本地，直接填寫端口號：端口號的形式即可</p><p>另外，如果開啟了動態端口，-p 標記可以多次使用來綁定多個端口. 具體用法是在指令中再加上多個 -p 標記即可。</p><p>更新 V2Ray 的 Docker 鏡像：</p><pre><code>docker pull v2ray/official</code></pre><p>更新完之後，你需要重新部署容器，方法見上。</p><hr><h2 id="BBR"><a href="#BBR" class="headerlink" title="BBR"></a>BBR</h2><p>需注意此方法無法和 WebSock 轉發併用</p><p>作者<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup><br>網上限定說記憶體需要 1G 大小，最小也需要 128M，經過我的折騰發現，128M 小記憶體 VPS 有時候並不如意，即使安裝好了 UML 也進不去系統，這就很讓人捉急，但是還好有了 LKL，比 UML 更加的方便，今天的教程就是教大家使用小記憶體 VPS 安裝 LKL+v2ray 體驗極速上網。</p><p>開始<br>首先還是一點，你需要 VPS，本次教程環境是 openvz，如果你沒有，那就可以去買個 KVM 框架的 VPS，免去折騰<br>推薦 BBR <a href="https://www.aihoom.com/842.html" rel="external nofollow noopener noreferrer" target="_blank">一鍵安裝</a> + <a href="https://www.aihoom.com/1193.html" rel="external nofollow noopener noreferrer" target="_blank">小白翻牆教程</a><br>服務搭建已經寫在教程中。</p><p>本次教程環境<br>debian8 mini</p><p>128M 記憶體 + 20 端口轉發 NET</p><p>連接 SSH<br>Windows 推薦使用 putty 或者 Xshell，這裡不多贅述。</p><p>安裝 LKL<br>wget –no-check-certificate <a href="https://github.com/91yun/uml/raw/master/lkl/install.sh" rel="external nofollow noopener noreferrer" target="_blank">https://github.com/91yun/uml/raw/master/lkl/install.sh</a> &amp;&amp; bash install.sh</p><p>判斷是否安裝成功</p><p>ping 10.0.0.2 如果能 ping 通就說明安裝成功，否則失敗</p><p>修改轉發端口<br>修改 /root/lkl/run.sh ，查找 9000-9999 ，改成你想要的端口段</p><p>修改 /root/lkl/haproxy.cfg 查找 9000-9999 ，改成你想要的端口段</p><p>重啟 vps</p><p>安裝 v2ray<br>這裡要注意一下，安裝 v2ray 的端口要在 LKL 轉發的端口範圍內，否則安裝 LKL 也無用。</p><hr><h2 id="Nginx-安裝"><a href="#Nginx-安裝" class="headerlink" title="Nginx 安裝"></a>Nginx 安裝</h2><p>參考<sup id="fnref:7"><a href="#fn:7" rel="footnote">7</a></sup><sup id="fnref:8"><a href="#fn:8" rel="footnote">8</a></sup><br>    service httpd stop<br>    yum install epel-release<br>    yum -y install nginx<br>    service nginx start</p><p>設定位置<br>    nano /etc/nginx/nginx.conf</p><pre><code>mkdir -p /var/www/yourdomain.com/public_html</code></pre><p>Let’s create a test index.html in this directory so that we have something to look at when we test the configuration later:</p><pre><code>nano /var/www/yourdomain.com/public_html/index.html</code></pre><p>All we need is a simple line of text to show that the connection is working:</p><pre><code>Hello world!</code></pre><p>Close and save the index.html file.</p><p>We need to set permissions for this folder so that it can be viewed by the outside world:</p><pre><code>chmod 755 /var/www/yourdomain.com/public_html</code></pre><p>更改設定檔中的  location / { 為<br>   /var/www/yourdomain.com/public_html</p><hr><h2 id="Let’s-Encrypt-安裝"><a href="#Let’s-Encrypt-安裝" class="headerlink" title="Let’s Encrypt 安裝"></a>Let’s Encrypt 安裝</h2><p>參考<sup id="fnref:9"><a href="#fn:9" rel="footnote">9</a></sup><sup id="fnref:10"><a href="#fn:10" rel="footnote">10</a></sup><br>    yum install epel-release<br>    yum install certbot<br>    yum -y install yum-utils<br>    yum-config-manager –enable rhui-REGION-rhel-server-extras rhui-REGION-rhel-server-optional<br>    certbot –nginx<br>    certbot –nginx certonly</p><pre><code>certbot renew --dry-run</code></pre><p>證書儲存在：<br>    ssl_certificate: /etc/letsencrypt/live/你的網域/fullchain.pem;<br>    ssl_certificate_key: /etc/letsencrypt/live/你的網域/privkey.pem</p><p>NGINX SSL/TLS 設定：</p><p>可使用 Security/Server Side TLS – MozillaWiki 提供的介面，自動產生 Apache、NGINX HTTP 網頁伺服器的設定檔</p><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></div><div class="code"><pre><div class="line">[root@img ~]<span class="comment"># vi /etc/nginx/conf.d/default.conf</span></div><div class="line">... 以上省略 ...</div><div class="line"> </div><div class="line">server &#123;</div><div class="line">    <span class="comment"># 使用 https 和 http/2 協定</span></div><div class="line">    listen 443 ssl http2;</div><div class="line">    <span class="comment"># 上述的 IPv6 方式</span></div><div class="line">    listen [::]:443 ssl http2;</div><div class="line"> </div><div class="line">    <span class="comment"># 網站網址</span></div><div class="line">    server_name img.yummygo.com.tw;</div><div class="line">    <span class="comment"># 網站根目錄</span></div><div class="line">    root   /var/nginx/html;</div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">#</span></div><div class="line">    <span class="comment"># certs sent to the client in SERVER HELLO are concatenated in ssl_certificate</span></div><div class="line">    <span class="comment">#</span></div><div class="line"> </div><div class="line">    <span class="comment"># SSL 憑證證書路徑</span></div><div class="line">    ssl_certificate /etc/letsencrypt/live/img.yummygo.com.tw/fullchain.pem;</div><div class="line">    <span class="comment"># 私鑰路徑</span></div><div class="line">    ssl_certificate_key /etc/letsencrypt/live/img.yummygo.com.tw/privkey.pem;</div><div class="line">    <span class="comment"># 緩存有效期</span></div><div class="line">    ssl_session_timeout 1d;</div><div class="line">    <span class="comment"># 緩存憑證類型和大小</span></div><div class="line">    ssl_session_cache shared:SSL:50m;</div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">#</span></div><div class="line">    <span class="comment"># intermediate configuration. tweak to your needs.</span></div><div class="line">    <span class="comment">#</span></div><div class="line"> </div><div class="line">    <span class="comment"># 使用的加密協定</span></div><div class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</div><div class="line">    <span class="comment"># 加密演演算法，越前面的優先級越高</span></div><div class="line">    ssl_ciphers <span class="string">'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS'</span>;</div><div class="line">    <span class="comment"># 交握過程使用 Server 的首選加演演算法，這裡使用 Client 為首選</span></div><div class="line">    ssl_prefer_server_ciphers on;</div><div class="line"> </div><div class="line"> </div><div class="line">    <span class="comment">#</span></div><div class="line">    <span class="comment"># HSTS (ngx_http_headers_module is required) (15768000 seconds = 6 months)</span></div><div class="line">    <span class="comment">#</span></div><div class="line"> </div><div class="line">    <span class="comment"># 增加 http header</span></div><div class="line">    add_header Strict-Transport-Security max-age=15768000;</div><div class="line">&#125;</div></pre></div></div></figure><p>重新啟動 NGINX：</p><pre><code>[root@img ~]# systemctl restart nginx</code></pre><h3 id="防火牆設定"><a href="#防火牆設定" class="headerlink" title="防火牆設定"></a>防火牆設定</h3><p>設定 firewall 允許 https service（Posr 443）：<br>    [root@img ~]# firewall-cmd –permanent –add-service=https –zone=public<br>    [root@img ~]# firewall-cmd –reload</p><h4 id="自動續期憑證"><a href="#自動續期憑證" class="headerlink" title="自動續期憑證"></a>自動續期憑證</h4><p>Let’s Encrypt 免費 SSL/TLS 憑證有效期僅有三個月，因此設定排程來自動續期：</p><pre><code>[root@img ~]# vi /etc/crontab</code></pre><figure class="highlight bash"><div class="figcode"><div class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></div><div class="code"><pre><div class="line"><span class="comment"># 每月 1 日 03:00 續期憑證，並重啟 Nginx</span></div><div class="line">00 03  1  *  * root /usr/bin/certbot renew --quiet &amp;&amp; /bin/systemctl restart nginx</div></pre></div></div></figure><hr><h3 id="Proxifier"><a href="#Proxifier" class="headerlink" title="Proxifier"></a>Proxifier</h3><p>全局代理</p><hr><h2 id="KCP介紹"><a href="#KCP介紹" class="headerlink" title="KCP介紹"></a>KCP介紹</h2><p>轉自<a href="https://github.com/skywind3000/kcp" rel="external nofollow noopener noreferrer" target="_blank">官方</a>，參考<sup id="fnref:11"><a href="#fn:11" rel="footnote">11</a></sup></p><p>KCP 是一個快速可靠協定，能以比 TCP 浪費 10%-20% 的帶寬的代價，換取平均延遲降低 30%-40%，且最大延遲降低三倍的傳輸效果。純演算法實現，並不負責底層協定（如 UDP）的收發。</p><p>技術特性<br>TCP 是為流量設計的（每秒內可以傳輸多少 KB 的資料），講究的是充分利用帶寬。而 KCP 是為流速設計的（單個資料包從一端發送到一端需要多少時間），以 10%-20% 帶寬浪費的代價換取了比 TCP 快 30%-40% 的傳輸速度。TCP 通道是一條流速很慢，但每秒流量很大的大運河，而 KCP 是水流湍急的小激流。KCP 有正常模式和快速模式兩種，通過以下策略達到提高流速的結果：</p><p>RTO 翻倍 vs 不翻倍：<br>TCP 超時計算是 RTOx2，這樣連續丟三次包就變成 RTOx8 了，十分恐怖，而 KCP 啟動快速模式後不 x2，只是 x1.5（實驗證明 1.5 這個值相對比較好），提高了傳輸速度。</p><p>選擇性重傳 vs 全部重傳：<br>TCP 丟包時會全部重傳從丟的那個包開始以後的資料，KCP 是選擇性重傳，只重傳真正丟失的資料包。</p><p>快速重傳：<br>發送端發送了 1,2,3,4,5 幾個包，然後收到遠端的 ACK: 1, 3, 4, 5，當收到 ACK3 時，KCP 知道 2 被跳過 1 次，收到 ACK4 時，知道 2 被跳過了 2 次，此時可以認為 2 號丟失，不用等超時，直接重傳 2 號包，大大改善了丟包時的傳輸速度。</p><p>延遲 ACK vs 非延遲 ACK：<br>TCP 為了充分利用帶寬，延遲發送 ACK（NODELAY 都沒用），這樣超時計算會算出較大 RTT 時間，延長了丟包時的判斷過程。KCP 的 ACK 是否延遲發送可以調節。</p><p>UNA vs ACK+UNA：<br>ARQ 模型回應有兩種，UNA（此編號前所有包已收到，如 TCP）和 ACK（該編號包已收到），光用 UNA 將導致全部重傳，光用 ACK 則丟失成本太高，以往協定都是二選其一，而 KCP 協定中，除去單獨的 ACK 包外，所有包都有 UNA 資訊。</p><p>非退讓流控：<br>KCP 正常模式同 TCP 一樣使用公平退讓法則，即發送視窗大小由：發送緩存大小、接收端剩餘接收緩存大小、丟包退讓及慢啟動這四要素決定。但傳送及時性要求很高的小資料時，可選擇通過配置跳過後兩步，僅用前兩項來控制發送頻率。以犧牲部分公平性及帶寬利用率之代價，換取了開著 BT 都能流暢傳輸的效果。</p><h2 id="DNS-CAA"><a href="#DNS-CAA" class="headerlink" title="DNS CAA"></a>DNS CAA</h2><p>以後有機會再使用<br><a href="https://segmentfault.com/a/1190000011097942" rel="external nofollow noopener noreferrer" target="_blank">給你的站點添加 DNS CAA 保護</a></p><p>記錄：<br>OpenConnet Server (ocserv) 通過實現 Cisco 的 AnyConnect 協議，用 DTLS 作為主無協議，UPD DTLS 失敗時會轉用 TCP TLS。<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup><br><a href="https://wangwanjie.github.io/2017/07/28/购买BanwagonHOST" rel="external nofollow noopener noreferrer" target="_blank">購買 BanwagonHOST VPS 自建 Shadowsocks 記錄</a></p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://bitinn.net/11084/" rel="external nofollow noopener noreferrer" target="_blank">加設 OpenConnect Server 給 iPhone 提供更順暢的網路生活</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.v2ray.com/chapter_00/install.html" rel="external nofollow noopener noreferrer" target="_blank">Project V 安裝</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://toutyrater.github.io/prep/json.html" rel="external nofollow noopener noreferrer" target="_blank">V2ray 白話教程</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">4.</span><span style="display: inline-block; vertical-align: top;"><a href="https://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E5%94%AF%E4%B8%80%E8%AF%86%E5%88%AB%E7%A0%81" rel="external nofollow noopener noreferrer" target="_blank">通用唯一識別碼</a></span><a href="#fnref:4" rev="footnote"> ↩</a></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">5.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.aihoom.com/1194.html" rel="external nofollow noopener noreferrer" target="_blank">openVZ 框架安裝 LKL+v2ray 讓你閒置的小記憶體 VPS 翻牆</a></span><a href="#fnref:5" rev="footnote"> ↩</a></li><li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">6.</span><span style="display: inline-block; vertical-align: top;"><a href="https://zh.wikipedia.org/zh-tw/%E4%BC%A0%E8%BE%93%E5%B1%82" rel="external nofollow noopener noreferrer" target="_blank">傳輸層</a></span><a href="#fnref:6" rev="footnote"> ↩</a></li><li id="fn:7"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">7.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.godaddy.com/garage/how-to-install-and-configure-nginx-on-centos-7/" rel="external nofollow noopener noreferrer" target="_blank">How to install and configure NGINX on CentOS 7</a></span><a href="#fnref:7" rev="footnote"> ↩</a></li><li id="fn:8"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">8.</span><span style="display: inline-block; vertical-align: top;"><a href="https://smalljacky.com/linux/centos/centos7-nginx-mariadb-php-phpmyadmin/" rel="external nofollow noopener noreferrer" target="_blank">CentOS 7 安裝與設定 Nginx + MariaDB + PHP + phpMyAdmin（LEMP）</a></span><a href="#fnref:8" rev="footnote"> ↩</a></li><li id="fn:9"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">9.</span><span style="display: inline-block; vertical-align: top;"><a href="https://smalljacky.com/linux/centos/centos7-lets-encrypt-https-nginx/" rel="external nofollow noopener noreferrer" target="_blank">CentOS 7 Let’s Encrypt 免費 SSL/TLS 憑證 HTTPS 設置 for NGINX</a></span><a href="#fnref:9" rev="footnote"> ↩</a></li><li id="fn:10"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">10.</span><span style="display: inline-block; vertical-align: top;"><a href="https://certbot.eff.org/lets-encrypt/centosrhel7-nginx" rel="external nofollow noopener noreferrer" target="_blank">Cerbot</a></span><a href="#fnref:10" rev="footnote"> ↩</a></li><li id="fn:11"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">11.</span><span style="display: inline-block; vertical-align: top;"><a href="https://oing9179.github.io/blog/2016/11/v2ray-More-Complex-and-Better-than-Shadowsocks/" rel="external nofollow noopener noreferrer" target="_blank">v2ray - 比 Shadowsocks 更強大更複雜的替代品</a></span><a href="#fnref:11" rev="footnote"> ↩</a></li><li id="fn:12"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">12.</span><span style="display: inline-block; vertical-align: top;"><a href="https://oing9179.github.io/blog/2017/03/v2ray-as-WebSocket-Proxy-behind-Nginx/" rel="external nofollow noopener noreferrer" target="_blank">用 Nginx 轉發 V2Ray 的 WebSocket 連接</a></span><a href="#fnref:12" rev="footnote"> ↩</a></li><li id="fn:13"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">13.</span><span style="display: inline-block; vertical-align: top;"><a href="https://github.com/getlantern/forum/issues/7887" rel="external nofollow noopener noreferrer" target="_blank">翻牆和匿名與網路安全類科普文大集合</a></span><a href="#fnref:13" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;本文記錄自&lt;a href=&quot;https://toutyrater.github.io/&quot; rel=&quot;external nofollow noopener noreferrer&quot; target=&quot;_blank&quot;&gt;V2Ray配置指南&lt;/a&gt;，加上一些些個人註解，非常感謝此文的作者。&lt;br&gt;
    
    </summary>
    
    
      <category term="GFW" scheme="https://ppundsh.github.io/tags/GFW/"/>
    
      <category term="VPN" scheme="https://ppundsh.github.io/tags/VPN/"/>
    
      <category term="V2Ray" scheme="https://ppundsh.github.io/tags/V2Ray/"/>
    
  </entry>
  
  <entry>
    <title>SDN 筆記</title>
    <link href="https://ppundsh.github.io/posts/2a39/"/>
    <id>https://ppundsh.github.io/posts/2a39/</id>
    <published>2018-04-15T09:12:24.000Z</published>
    <updated>2018-04-17T13:29:55.294Z</updated>
    
    <content type="html"><![CDATA[<p>SDN (Software-defined networking) 是利用 Data link Layer 層中的 OpenFlow 協定<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>，將 Forwording 的硬體和控制行為分離，而得設置 Programmable network (程式化的網路行為), 比起用 ACL 和路由協定，能作更複雜的管理<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>。<br><a id="more"></a><br>資料來源<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup><br>SDN 將網路架構簡化為封包轉送硬體與網路決策控制器 (decision-making network controller) 二個單元，其中封包轉送硬體由<br>(1) 包含了條目 (entry) 以及對於活躍的流程 (active flows) 所必須採取的行動的流程表 (flow table)；<br>(2) 以及能夠與控制器經由安全的通道溝通對於尚未在流程表上的新條目所必須採取行動的階層 (layer) 所構成。</p><p>1. 現存的 SDN 架構 ForCES 與 OpenFlow 為前最具影響力的主流 SDN 介面，二者皆遵守 SDN 的基本精神，也就是將資料傳輸與控制單元分離以及使得兩者經由安全通道交換訊息；但二者在架構、封包轉送模式與通訊協定介面上有顯著的不同。</p><p>2. ForCES 由 IETF ForCES(Forwarding and Control Element Separation) Working Group 所提出，將網路元件內部重新定義為控制單元以及封包轉送單元分離的架構，但網路元件依然被視為一個個體；如此一來不但網路元件巨觀上與傳統網路元件極為類似，控制單元的決策亦可由第三方軟體來控制。<br>ForCES 定義了一個稱為稱為 Forwarding Element(FE)，實施 ForCES 通訊協定的邏輯個體 (logic entity)，負責利用其下層的硬體處理封包；一個負責執行控制訊號函數的邏輯個體稱為 Control Element(CE)，告訴 FE 如何處理封包；另外一個在 FE 上、被 CE 根據 ForCES 通訊協定所控制的函數區塊稱為 Logical Function Block(LFB)，允許 CE 控制 FE 的組態。</p><p>3. OpenFlow<br>在 OpenFlow 的架構中，封包轉送裝置稱為 OpenFlow Switch，包含了一個或多個流程表，流程表由流程條目 (flow entry) 所組成，由它們決定屬於一個流程的封包應該如何處理與轉送。流程條目由<br>(1)    配對區域 (match fields)：配對流入封包位於標頭區 (header) 的資訊。<br>(2)    計數器 (counters)：蒐集特定流程的資料，例如接收封包數、封包大小、流程持續時間等。<br>(3)    採取的動作：封包符合配對的話應該採取處理封包的動作所組成。</p><p>當 OpenFlow Switch 接收到一個封包時，它會解開封包的標頭區並根據流程表進行配對，若配對未通過則進行至下一個流程表，直到通過配對並決定應該採取的動作為止；如果該封包沒有通過任何一個流程表的配對，所採取的動作將由表上無名流程條目 (table-miss flow entry) 決定，這個條目尚包含的動作可能是丟棄封包、將封包經由 OpenFlow 的頻道 (channel) 傳給控制元件等。</p><p>其它</p><hr><p>SDN 是由 SUN 在1995年首次提出。<br>OpenFlow 是由 2008 年在史丹褔大學開使。<br>IBM 的控制器為 PNC (Programmable Network Controller)<br>Cisco 的 OF 控制器為 Cisco XNC<br>Cisco ONE (Cisco Open Network Environment) 提供開放 API 讓開發人員可使用自已熟悉的語言開發符合企業網路管理的應用<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup><br>Microsoft 的網路虛擬化協定 NVGRE (Network Virtualization using Generic Routing Encapsulation)<br>IBM 的網路虛擬化協定 DOVE (Distributed Overlay Virtual Ethernet)<br>VMware 的網路虛擬化協定VXLAN (Virtual eXtensible Local Area Network)</p><p>Nicira 被 VMware 收購，而其創辨人參與了 OF 的制定和發展，SDN 解決方案為 NVP (Network Virtualization Platform) ，NTT、AT&amp;T、ebay 皆是其客戶<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></p><p>資料來源：</p><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style:none; padding-left: 0;"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">1.</span><span style="display: inline-block; vertical-align: top;"><a href="https://zh.wikipedia.org/wiki/%E8%BB%9F%E9%AB%94%E5%AE%9A%E7%BE%A9%E7%B6%B2%E8%B7%AF" rel="external nofollow noopener noreferrer" target="_blank">SDN Wiki</a></span><a href="#fnref:1" rev="footnote"> ↩</a></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">2.</span><span style="display: inline-block; vertical-align: top;"><a href="http://www.cc.ntu.edu.tw/chinese/epaper/0029/20140620_2908.html" rel="external nofollow noopener noreferrer" target="_blank">軟體定義網路架構簡介</a></span><a href="#fnref:2" rev="footnote"> ↩</a></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px;">3.</span><span style="display: inline-block; vertical-align: top;"><a href="https://www.ithome.com.tw/node/77354" rel="external nofollow noopener noreferrer" target="_blank">3種SDN架構的産品策略</a></span><a href="#fnref:3" rev="footnote"> ↩</a></li></ol></div></div>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;SDN (Software-defined networking) 是利用 Data link Layer 層中的 OpenFlow 協定&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;，將 Forwording 的硬體和控制行為分離，而得設置 Programmable network (程式化的網路行為), 比起用 ACL 和路由協定，能作更複雜的管理&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; rel=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;。&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
      <category term="SDN" scheme="https://ppundsh.github.io/tags/SDN/"/>
    
      <category term="OVSDB" scheme="https://ppundsh.github.io/tags/OVSDB/"/>
    
  </entry>
  
  <entry>
    <title>學習單</title>
    <link href="https://ppundsh.github.io/posts/21d4/"/>
    <id>https://ppundsh.github.io/posts/21d4/</id>
    <published>2018-04-13T16:33:15.000Z</published>
    <updated>2018-04-18T12:03:33.661Z</updated>
    
    <content type="html"><![CDATA[<p>以後學習用的記錄<br><a id="more"></a></p><h2 id="Trace"><a href="#Trace" class="headerlink" title="Trace"></a>Trace</h2><ul><li>Grafana</li><li>Rancher</li><li>Spunk</li><li>ELK</li><li><a href="https://joshhu.gitbooks.io/docker_theory_install/content/index.html" rel="external nofollow noopener noreferrer" target="_blank">Docker</a></li><li>Probe</li></ul><h2 id="系統"><a href="#系統" class="headerlink" title="系統"></a>系統</h2><ul><li>SIEM</li><li>DLP</li></ul><h3 id="1-作業系統基礎"><a href="#1-作業系統基礎" class="headerlink" title="1.作業系統基礎"></a>1.作業系統基礎</h3><ul><li>CentOS7 mionimal</li><li>修改 hostname，查看hostname ，分暫時與永久</li><li>ip 修改為固定 ip/dhcp ，查看 gateway, 暫時DNS</li><li>停用防火牆，查看開機是否執行</li><li>查看系統時間/怎麼看對時，如何強制對時，手動修改時間</li><li>查看 SELINUX 狀態，暫時/永久停用</li><li>查看現在的 DNS 為何，暫時/水久停用</li><li>安裝 telnet，nslookup、man、wget</li></ul><h3 id="2-Log"><a href="#2-Log" class="headerlink" title="2.Log"></a>2.Log</h3><ul><li>查看系統訊息log</li><li>查看目前登入人員，查看目前登入人員正在下什麼指令，查看曾經登入使用者</li><li>查看硬體 log</li><li>查看 crontab log</li><li>查看曾經輸入過的指令</li><li>查看誰成功登入，誰失敗登入</li><li>cat 最後十筆記錄，最前十筆紀錄，一修改就跳 log</li><li>資料夾欄位的意思 root,root 意思</li></ul><p>tail<br>grep<br>OpenResty</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;以後學習用的記錄&lt;br&gt;
    
    </summary>
    
    
      <category term="MIS" scheme="https://ppundsh.github.io/tags/MIS/"/>
    
  </entry>
  
</feed>
